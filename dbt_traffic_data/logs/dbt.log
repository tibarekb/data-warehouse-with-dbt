

============================== 2022-12-18 19:09:48.497522 | 29ef7030-42e1-4deb-92b8-dca254c17c15 ==============================
[0m19:09:48.497540 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:09:48.498118 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:09:48.498361 [debug] [MainThread]: Tracking: tracking
[0m19:09:48.500352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b85f8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b85f9c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b85f8cd0>]}
[0m19:09:48.599356 [debug] [MainThread]: Executing "git --help"
[0m19:09:48.611422 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:09:48.611805 [debug] [MainThread]: STDERR: "b''"
[0m19:09:48.612214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b84d7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b84e9a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b84eba60>]}
[0m19:09:48.612617 [debug] [MainThread]: Flushing usage events


============================== 2022-12-18 19:16:44.517364 | dc3d1e34-005e-4303-a033-89c5a9dacb00 ==============================
[0m19:16:44.517384 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:16:44.517977 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:16:44.518236 [debug] [MainThread]: Tracking: tracking
[0m19:16:44.520233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a17dfb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a17dfbd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a17dfbbb0>]}
[0m19:16:44.526414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a17dfbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a17dfbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a17df9660>]}
[0m19:16:44.526842 [debug] [MainThread]: Flushing usage events
[0m19:16:46.534750 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 59
    ------------------------------
    56 |         dbname: dw
    57 |         schema: dev
    58 | 
    59 |       prod:
    60 |         type: postgres
    61 |         threads: 1
    62 |         host: localhost
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 49, column 5
    did not find expected key
      in "<unicode string>", line 59, column 7
  


============================== 2022-12-18 19:19:19.100579 | dcc5cca9-0414-42ba-af96-26f6a35266c1 ==============================
[0m19:19:19.100597 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:19:19.101183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:19:19.101493 [debug] [MainThread]: Tracking: tracking
[0m19:19:19.103496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb900910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb901480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb900ac0>]}
[0m19:19:19.207397 [debug] [MainThread]: Executing "git --help"
[0m19:19:19.209871 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:19:19.210233 [debug] [MainThread]: STDERR: "b''"
[0m19:19:19.213493 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m19:19:19.213844 [debug] [MainThread]: Using postgres connection "debug"
[0m19:19:19.214095 [debug] [MainThread]: On debug: select 1 as id
[0m19:19:19.214317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:19.215135 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m19:19:19.215841 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m19:19:19.216090 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m19:19:19.216350 [debug] [MainThread]: On debug: No close available on handle
[0m19:19:19.216788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb9e8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb9e9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb9e9360>]}
[0m19:19:19.217223 [debug] [MainThread]: Flushing usage events
[0m19:19:25.497254 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-18 19:22:04.905777 | f66600fe-bdfa-4692-9412-7d3ccad43703 ==============================
[0m19:22:04.905800 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:22:04.906477 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:22:04.906793 [debug] [MainThread]: Tracking: tracking
[0m19:22:04.909201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcafb11750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcafb11e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcafb11060>]}
[0m19:22:05.042543 [debug] [MainThread]: Executing "git --help"
[0m19:22:05.045265 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:22:05.045670 [debug] [MainThread]: STDERR: "b''"
[0m19:22:05.047514 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m19:22:05.047825 [debug] [MainThread]: Using postgres connection "debug"
[0m19:22:05.048068 [debug] [MainThread]: On debug: select 1 as id
[0m19:22:05.048274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:05.060813 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "dw_user"

[0m19:22:05.072213 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m19:22:05.072846 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m19:22:05.073344 [debug] [MainThread]: On debug: No close available on handle
[0m19:22:05.074102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcafbf91b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcafbf9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcafbf9360>]}
[0m19:22:05.074838 [debug] [MainThread]: Flushing usage events
[0m19:22:11.816263 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-18 19:23:02.955361 | 904ab183-6d5a-4d03-bf3d-db4fd01d3af8 ==============================
[0m19:23:02.955380 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:23:02.956001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:23:02.956247 [debug] [MainThread]: Tracking: tracking
[0m19:23:02.958288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc8008c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc8009c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc8008cd0>]}
[0m19:23:03.058622 [debug] [MainThread]: Executing "git --help"
[0m19:23:03.061112 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:23:03.061443 [debug] [MainThread]: STDERR: "b''"
[0m19:23:03.063177 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m19:23:03.063507 [debug] [MainThread]: Using postgres connection "debug"
[0m19:23:03.063735 [debug] [MainThread]: On debug: select 1 as id
[0m19:23:03.063938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:03.098594 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
[0m19:23:03.100328 [debug] [MainThread]: On debug: Close
[0m19:23:03.100924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc80f14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc80f1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc80f25f0>]}
[0m19:23:03.101424 [debug] [MainThread]: Flushing usage events
[0m19:23:04.459096 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-20 02:30:22.854928 | 92107b91-5383-4c0d-a04b-3652c13d1cbd ==============================
[0m02:30:22.854955 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:30:22.855801 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:30:22.856157 [debug] [MainThread]: Tracking: tracking
[0m02:30:22.858898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35859ccc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35859cf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35859cf7f0>]}
[0m02:30:22.883401 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m02:30:22.884112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35850296f0>]}
[0m02:30:22.934175 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:30:22.940207 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:30:22.943263 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:30:22.947590 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:30:22.996490 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:30:22.999582 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:30:23.001499 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:30:23.002475 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:30:23.004136 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:30:23.006318 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:30:23.009938 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:30:23.022582 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:30:23.025456 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:30:23.032546 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:30:23.037392 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:30:23.041750 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:30:23.044231 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:30:23.050498 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:30:23.061159 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:30:23.087680 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:30:23.132223 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:30:23.135505 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:30:23.154511 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:30:23.168611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:30:23.202806 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:30:23.210237 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:30:23.221604 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:30:23.230832 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:30:23.234413 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:30:23.238309 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:30:23.241670 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:30:23.267153 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:30:23.293950 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:30:23.326703 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:30:23.339641 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:30:23.373392 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:30:23.375746 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:30:23.377556 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:30:23.379790 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:30:23.381860 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:30:23.383687 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:30:23.385726 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:30:23.387858 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:30:23.390320 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:30:23.391900 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:30:23.394116 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:30:23.397819 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:30:23.410195 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:30:23.412099 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:30:23.414322 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:30:23.416407 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:30:23.419178 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:30:23.421348 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:30:23.423110 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:30:23.426496 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:30:23.428369 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:30:23.430400 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:30:23.432743 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:30:23.434937 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:30:23.439502 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:30:23.442369 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:30:23.446812 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:30:23.449657 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:30:23.451194 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:30:23.452568 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:30:23.455412 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:30:23.457096 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:30:23.464169 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:30:23.535145 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:30:23.541859 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:30:23.548270 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:30:23.554644 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:30:23.575693 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:30:23.602727 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:30:23.615313 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:30:23.647789 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:30:23.658440 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:30:23.675428 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:30:23.688158 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:30:24.263922 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m02:30:24.292790 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m02:30:24.433198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35850e58a0>]}
[0m02:30:24.445711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35859cfe50>]}
[0m02:30:24.446383 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:30:24.446949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3585029810>]}
[0m02:30:24.449115 [info ] [MainThread]: 
[0m02:30:24.450431 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:30:24.452241 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m02:30:24.476359 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m02:30:24.477050 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m02:30:24.477496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:24.526405 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m02:30:24.528868 [debug] [ThreadPool]: On list_test: Close
[0m02:30:24.530827 [debug] [ThreadPool]: Acquiring new postgres connection "create_test_dev"
[0m02:30:24.531725 [debug] [ThreadPool]: Acquiring new postgres connection "create_test_dev"
[0m02:30:24.532210 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='test', schema='dev', identifier=None)"
[0m02:30:24.544085 [debug] [ThreadPool]: Using postgres connection "create_test_dev"
[0m02:30:24.544515 [debug] [ThreadPool]: On create_test_dev: BEGIN
[0m02:30:24.544821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:24.604367 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m02:30:24.604925 [debug] [ThreadPool]: Using postgres connection "create_test_dev"
[0m02:30:24.605407 [debug] [ThreadPool]: On create_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "create_test_dev"} */
create schema if not exists "dev"
[0m02:30:24.611378 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.01 seconds
[0m02:30:24.613096 [debug] [ThreadPool]: On create_test_dev: COMMIT
[0m02:30:24.613467 [debug] [ThreadPool]: Using postgres connection "create_test_dev"
[0m02:30:24.613742 [debug] [ThreadPool]: On create_test_dev: COMMIT
[0m02:30:24.618319 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m02:30:24.618728 [debug] [ThreadPool]: On create_test_dev: Close
[0m02:30:24.622159 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m02:30:24.635717 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m02:30:24.636192 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m02:30:24.636518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:24.650303 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:30:24.650784 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m02:30:24.651084 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m02:30:24.666412 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.02 seconds
[0m02:30:24.668594 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m02:30:24.670649 [debug] [ThreadPool]: On list_test_dev: Close
[0m02:30:24.680078 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:24.680521 [debug] [MainThread]: On master: BEGIN
[0m02:30:24.680828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:24.695850 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:30:24.696365 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:24.696658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:30:24.718482 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m02:30:24.720781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3584344730>]}
[0m02:30:24.721646 [debug] [MainThread]: On master: ROLLBACK
[0m02:30:24.724362 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:24.724761 [debug] [MainThread]: On master: BEGIN
[0m02:30:24.728107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:30:24.728512 [debug] [MainThread]: On master: COMMIT
[0m02:30:24.728782 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:24.729042 [debug] [MainThread]: On master: COMMIT
[0m02:30:24.730535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:30:24.730900 [debug] [MainThread]: On master: Close
[0m02:30:24.731858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:24.732539 [info ] [MainThread]: 
[0m02:30:24.739147 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m02:30:24.739995 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m02:30:24.741548 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.742079 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m02:30:24.742483 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m02:30:24.748355 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.749564 [debug] [Thread-1 (]: finished collecting timing info
[0m02:30:24.750109 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m02:30:24.840391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.841416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.841764 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m02:30:24.842030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:24.900396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:30:24.900863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.901126 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:30:24.913927 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m02:30:24.926920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.927351 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:30:24.930381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:30:24.976761 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m02:30:24.977441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.977935 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m02:30:24.983651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m02:30:24.995656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m02:30:24.996318 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m02:30:24.999797 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:30:25.002419 [debug] [Thread-1 (]: finished collecting timing info
[0m02:30:25.003006 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m02:30:25.004731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358427f1c0>]}
[0m02:30:25.005904 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.26s]
[0m02:30:25.007565 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m02:30:25.009825 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m02:30:25.010609 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m02:30:25.012370 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.012938 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m02:30:25.013394 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m02:30:25.019676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.020515 [debug] [Thread-1 (]: finished collecting timing info
[0m02:30:25.021153 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m02:30:25.068540 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.069329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.069759 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m02:30:25.070201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:25.088463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m02:30:25.089096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.089469 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m02:30:25.098025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:30:25.103387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.103810 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:30:25.107053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:30:25.110965 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m02:30:25.111347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.111639 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m02:30:25.117311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m02:30:25.121912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m02:30:25.122317 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m02:30:25.168380 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m02:30:25.170653 [debug] [Thread-1 (]: finished collecting timing info
[0m02:30:25.171098 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m02:30:25.172477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92107b91-5383-4c0d-a04b-3652c13d1cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358430a7a0>]}
[0m02:30:25.173321 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m02:30:25.174319 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m02:30:25.176505 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:30:25.176997 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:25.177333 [debug] [MainThread]: On master: BEGIN
[0m02:30:25.177659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:25.199689 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:30:25.200224 [debug] [MainThread]: On master: COMMIT
[0m02:30:25.200520 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:25.200792 [debug] [MainThread]: On master: COMMIT
[0m02:30:25.202526 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:30:25.202942 [debug] [MainThread]: On master: Close
[0m02:30:25.204189 [info ] [MainThread]: 
[0m02:30:25.204922 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m02:30:25.205602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:25.206518 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m02:30:25.221936 [info ] [MainThread]: 
[0m02:30:25.222935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:25.223974 [info ] [MainThread]: 
[0m02:30:25.224855 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:30:25.226059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3584343ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3584341e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35843418d0>]}
[0m02:30:25.226827 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 03:29:43.187011 | 2d68ac85-11bf-4a4e-89a0-05a7f8b82250 ==============================
[0m03:29:43.187032 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:29:43.187757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:29:43.188088 [debug] [MainThread]: Tracking: tracking
[0m03:29:43.190624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82075cf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82075cf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82075ccc40>]}
[0m03:29:43.289399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:29:43.289864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:29:43.300982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d68ac85-11bf-4a4e-89a0-05a7f8b82250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206b72560>]}
[0m03:29:43.313363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d68ac85-11bf-4a4e-89a0-05a7f8b82250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206b47be0>]}
[0m03:29:43.313973 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:29:43.314517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d68ac85-11bf-4a4e-89a0-05a7f8b82250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206b47c10>]}
[0m03:29:43.316733 [info ] [MainThread]: 
[0m03:29:43.318096 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:29:43.320059 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m03:29:43.397517 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m03:29:43.398017 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m03:29:43.398369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:43.467632 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.07 seconds
[0m03:29:43.471447 [debug] [ThreadPool]: On list_test: Close
[0m03:29:43.474516 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m03:29:43.486128 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:29:43.486529 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m03:29:43.486791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:43.552419 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m03:29:43.552894 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:29:43.553194 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m03:29:43.559580 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m03:29:43.561740 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m03:29:43.565758 [debug] [ThreadPool]: On list_test_dev: Close
[0m03:29:43.580717 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:43.581185 [debug] [MainThread]: On master: BEGIN
[0m03:29:43.581614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:29:43.597858 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m03:29:43.598454 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:43.598796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:29:43.615838 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m03:29:43.618127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d68ac85-11bf-4a4e-89a0-05a7f8b82250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206b5fdc0>]}
[0m03:29:43.618759 [debug] [MainThread]: On master: ROLLBACK
[0m03:29:43.620891 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:43.621304 [debug] [MainThread]: On master: BEGIN
[0m03:29:43.624447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:43.624838 [debug] [MainThread]: On master: COMMIT
[0m03:29:43.625115 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:43.625370 [debug] [MainThread]: On master: COMMIT
[0m03:29:43.627629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:43.628044 [debug] [MainThread]: On master: Close
[0m03:29:43.629047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:43.629614 [info ] [MainThread]: 
[0m03:29:43.637802 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m03:29:43.638768 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m03:29:43.640924 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.641519 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m03:29:43.642010 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m03:29:43.650173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.651455 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:43.652196 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m03:29:43.747485 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.748296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.748638 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m03:29:43.748902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:43.762867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:29:43.763330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.763603 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:29:43.767678 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m03:29:43.781115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.781522 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:29:43.784254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:43.788938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.789273 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:29:43.791452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:43.834909 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:29:43.835335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.835626 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:29:43.841515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:29:43.850897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:29:43.851293 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m03:29:43.900380 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m03:29:43.902574 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:43.902983 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m03:29:43.904047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d68ac85-11bf-4a4e-89a0-05a7f8b82250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206bb8160>]}
[0m03:29:43.904737 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.26s]
[0m03:29:43.905530 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m03:29:43.906894 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m03:29:43.907374 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m03:29:43.908564 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:43.908908 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m03:29:43.909210 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m03:29:43.914809 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:43.915567 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:43.915949 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m03:29:43.958210 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:43.959048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:43.959403 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m03:29:43.959682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:44.020453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:29:44.020937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:44.021262 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m03:29:44.027313 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:29:44.035489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:44.036086 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:29:44.038963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:44.043984 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:29:44.044505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:44.044965 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:29:44.049796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:44.055564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:29:44.056100 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m03:29:44.058544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:29:44.061525 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:44.062113 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m03:29:44.063613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d68ac85-11bf-4a4e-89a0-05a7f8b82250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206a5b7f0>]}
[0m03:29:44.064608 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m03:29:44.065865 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m03:29:44.068270 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:29:44.068866 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:44.069234 [debug] [MainThread]: On master: BEGIN
[0m03:29:44.069521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:29:44.088304 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m03:29:44.089096 [debug] [MainThread]: On master: COMMIT
[0m03:29:44.089605 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:44.090037 [debug] [MainThread]: On master: COMMIT
[0m03:29:44.094018 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:44.095016 [debug] [MainThread]: On master: Close
[0m03:29:44.096936 [info ] [MainThread]: 
[0m03:29:44.097958 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m03:29:44.098865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:44.099343 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m03:29:44.121908 [info ] [MainThread]: 
[0m03:29:44.122957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:29:44.123955 [info ] [MainThread]: 
[0m03:29:44.124780 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:29:44.125789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206a60a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206a60ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206a62d70>]}
[0m03:29:44.126535 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 03:32:30.816247 | 68febac0-b70c-4958-8dd9-ac913ea4ef75 ==============================
[0m03:32:30.816267 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:32:30.816919 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:32:30.817187 [debug] [MainThread]: Tracking: tracking
[0m03:32:30.819699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347b6c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347b6cb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347b6cb820>]}
[0m03:32:30.945752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:32:30.946249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:32:30.959136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68febac0-b70c-4958-8dd9-ac913ea4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ac3a5f0>]}
[0m03:32:30.973098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68febac0-b70c-4958-8dd9-ac913ea4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ac0fc70>]}
[0m03:32:30.973789 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:32:30.974399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68febac0-b70c-4958-8dd9-ac913ea4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ac0fca0>]}
[0m03:32:30.976886 [info ] [MainThread]: 
[0m03:32:30.978468 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:32:30.980558 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m03:32:31.067921 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m03:32:31.068457 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m03:32:31.068834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:32:31.087181 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m03:32:31.090175 [debug] [ThreadPool]: On list_test: Close
[0m03:32:31.093312 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m03:32:31.107323 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:32:31.107841 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m03:32:31.108207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:31.124627 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m03:32:31.125209 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:32:31.125550 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m03:32:31.132534 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m03:32:31.135129 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m03:32:31.138070 [debug] [ThreadPool]: On list_test_dev: Close
[0m03:32:31.148351 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:31.148866 [debug] [MainThread]: On master: BEGIN
[0m03:32:31.149184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:32:31.170616 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m03:32:31.171152 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:31.171484 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:32:31.191131 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m03:32:31.193612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68febac0-b70c-4958-8dd9-ac913ea4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ac27be0>]}
[0m03:32:31.194279 [debug] [MainThread]: On master: ROLLBACK
[0m03:32:31.197248 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:31.197896 [debug] [MainThread]: On master: BEGIN
[0m03:32:31.284419 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
[0m03:32:31.285045 [debug] [MainThread]: On master: COMMIT
[0m03:32:31.285398 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:31.285705 [debug] [MainThread]: On master: COMMIT
[0m03:32:31.289785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:32:31.290536 [debug] [MainThread]: On master: Close
[0m03:32:31.292159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:32:31.293209 [info ] [MainThread]: 
[0m03:32:31.300636 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m03:32:31.301632 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m03:32:31.304007 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.304672 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m03:32:31.305244 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m03:32:31.314318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.316208 [debug] [Thread-1 (]: finished collecting timing info
[0m03:32:31.317069 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m03:32:31.413831 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.414591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.414920 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m03:32:31.415188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:31.428958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:32:31.429374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.429670 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:32:31.433440 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m03:32:31.446253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.446628 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:32:31.449490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:32:31.454161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.454523 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:32:31.496488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m03:32:31.541556 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:32:31.541980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.542252 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:32:31.546890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:32:31.555906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:32:31.556266 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m03:32:31.600490 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m03:32:31.603354 [debug] [Thread-1 (]: finished collecting timing info
[0m03:32:31.603826 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m03:32:31.605230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68febac0-b70c-4958-8dd9-ac913ea4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ac801f0>]}
[0m03:32:31.605984 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.30s]
[0m03:32:31.607017 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m03:32:31.608268 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m03:32:31.609011 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m03:32:31.610710 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.611290 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m03:32:31.611760 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m03:32:31.619820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.620824 [debug] [Thread-1 (]: finished collecting timing info
[0m03:32:31.621380 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m03:32:31.665209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.665994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.666324 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m03:32:31.666583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:31.724521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:32:31.725180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.725506 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m03:32:31.730529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:32:31.735464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.735834 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:32:31.738514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:32:31.741729 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:32:31.742073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.742339 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:32:31.747260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:32:31.750975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:32:31.751344 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m03:32:31.753986 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:32:31.755953 [debug] [Thread-1 (]: finished collecting timing info
[0m03:32:31.756316 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m03:32:31.757460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68febac0-b70c-4958-8dd9-ac913ea4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ab03610>]}
[0m03:32:31.758254 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m03:32:31.759075 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m03:32:31.761120 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:32:31.761555 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:31.761851 [debug] [MainThread]: On master: BEGIN
[0m03:32:31.762173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:32:31.784109 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m03:32:31.784623 [debug] [MainThread]: On master: COMMIT
[0m03:32:31.784971 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:31.785253 [debug] [MainThread]: On master: COMMIT
[0m03:32:31.787198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:32:31.787702 [debug] [MainThread]: On master: Close
[0m03:32:31.788931 [info ] [MainThread]: 
[0m03:32:31.789687 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m03:32:31.790514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:32:31.790962 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m03:32:31.806073 [info ] [MainThread]: 
[0m03:32:31.806868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:32:31.807613 [info ] [MainThread]: 
[0m03:32:31.808504 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:32:31.809352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ab28970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ab28b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ab29300>]}
[0m03:32:31.810018 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 03:35:41.874416 | 65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af ==============================
[0m03:35:41.874438 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:35:41.875164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:35:41.875462 [debug] [MainThread]: Tracking: tracking
[0m03:35:41.877763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e39e0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e39e36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e39e3820>]}
[0m03:35:41.965124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:35:41.965550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:35:41.976466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2f025f0>]}
[0m03:35:41.987928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2ed7c70>]}
[0m03:35:41.988516 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:35:41.989048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2ed7ca0>]}
[0m03:35:41.990963 [info ] [MainThread]: 
[0m03:35:41.992174 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:35:41.994047 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m03:35:42.066200 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m03:35:42.066878 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m03:35:42.067355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:35:42.084984 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m03:35:42.088617 [debug] [ThreadPool]: On list_test: Close
[0m03:35:42.092102 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m03:35:42.104921 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:35:42.105356 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m03:35:42.105642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:35:42.164391 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:35:42.164980 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:35:42.165321 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m03:35:42.173480 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m03:35:42.177294 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m03:35:42.224985 [debug] [ThreadPool]: On list_test_dev: Close
[0m03:35:42.238911 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:42.239435 [debug] [MainThread]: On master: BEGIN
[0m03:35:42.239758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:35:42.300630 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:35:42.301205 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:42.301540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:35:42.337579 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
[0m03:35:42.339991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2eefbe0>]}
[0m03:35:42.340636 [debug] [MainThread]: On master: ROLLBACK
[0m03:35:42.343355 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:42.343780 [debug] [MainThread]: On master: BEGIN
[0m03:35:42.350523 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:35:42.351282 [debug] [MainThread]: On master: COMMIT
[0m03:35:42.351875 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:42.352463 [debug] [MainThread]: On master: COMMIT
[0m03:35:42.354929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:35:42.355426 [debug] [MainThread]: On master: Close
[0m03:35:42.356616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:35:42.357268 [info ] [MainThread]: 
[0m03:35:42.364201 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m03:35:42.365373 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m03:35:42.367860 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.368603 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m03:35:42.369212 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m03:35:42.378305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.379688 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:42.380438 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m03:35:42.519806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.520649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.520997 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m03:35:42.521264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:42.580527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:35:42.581369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.581941 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:35:42.587643 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m03:35:42.603339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.603845 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:35:42.607147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:35:42.612942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.613425 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:35:42.616481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:35:42.663833 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:35:42.664298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.664597 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:35:42.669211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:35:42.684578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:35:42.685168 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m03:35:42.736579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m03:35:42.740162 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:42.740821 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m03:35:42.742421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2f481f0>]}
[0m03:35:42.743483 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.38s]
[0m03:35:42.744862 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m03:35:42.746394 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m03:35:42.747185 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m03:35:42.749134 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.749708 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m03:35:42.750244 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m03:35:42.758770 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.759933 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:42.760562 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m03:35:42.822308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.823520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.824105 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m03:35:42.824613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:42.880386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:35:42.881096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.881605 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m03:35:42.886611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:35:42.891524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.891878 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:35:42.894307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:35:42.899096 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:35:42.899614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.900094 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:35:42.912648 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:35:42.918950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:35:42.919496 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m03:35:42.964421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m03:35:42.966569 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:42.967019 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m03:35:42.968193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65f444a9-bebd-4ea1-8ecf-a9b8bc49b1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2deb880>]}
[0m03:35:42.969094 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.22s]
[0m03:35:42.970237 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m03:35:42.972487 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:35:42.972936 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:42.973351 [debug] [MainThread]: On master: BEGIN
[0m03:35:42.973788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:35:43.036767 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:35:43.037450 [debug] [MainThread]: On master: COMMIT
[0m03:35:43.037771 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:43.038044 [debug] [MainThread]: On master: COMMIT
[0m03:35:43.040464 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:35:43.040927 [debug] [MainThread]: On master: Close
[0m03:35:43.042178 [info ] [MainThread]: 
[0m03:35:43.043124 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m03:35:43.044715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:35:43.045255 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m03:35:43.059436 [info ] [MainThread]: 
[0m03:35:43.060083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:35:43.060821 [info ] [MainThread]: 
[0m03:35:43.061553 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:35:43.062265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2df0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2df0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2df1ba0>]}
[0m03:35:43.062789 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 03:40:29.819722 | 76786a77-4540-450b-ad2a-952027b9bd82 ==============================
[0m03:40:29.819742 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:40:29.820412 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:40:29.820688 [debug] [MainThread]: Tracking: tracking
[0m03:40:29.822771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47aede3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47aede37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47aede0c40>]}
[0m03:40:29.903352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:40:29.903757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:40:29.914484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76786a77-4540-450b-ad2a-952027b9bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae3d2560>]}
[0m03:40:29.926210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76786a77-4540-450b-ad2a-952027b9bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae3a7be0>]}
[0m03:40:29.926790 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:40:29.927338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76786a77-4540-450b-ad2a-952027b9bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae3a7c10>]}
[0m03:40:29.929539 [info ] [MainThread]: 
[0m03:40:29.930859 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:40:29.932731 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m03:40:30.008292 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m03:40:30.008874 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m03:40:30.009232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:40:30.024636 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m03:40:30.027076 [debug] [ThreadPool]: On list_test: Close
[0m03:40:30.030066 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m03:40:30.042040 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:40:30.042461 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m03:40:30.042740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:30.055589 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:40:30.056058 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m03:40:30.056362 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m03:40:30.064112 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m03:40:30.066296 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m03:40:30.068137 [debug] [ThreadPool]: On list_test_dev: Close
[0m03:40:30.076937 [debug] [MainThread]: Using postgres connection "master"
[0m03:40:30.077335 [debug] [MainThread]: On master: BEGIN
[0m03:40:30.077623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:40:30.091701 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:40:30.092222 [debug] [MainThread]: Using postgres connection "master"
[0m03:40:30.092530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:40:30.110349 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m03:40:30.112583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76786a77-4540-450b-ad2a-952027b9bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae3bfdc0>]}
[0m03:40:30.113211 [debug] [MainThread]: On master: ROLLBACK
[0m03:40:30.115498 [debug] [MainThread]: Using postgres connection "master"
[0m03:40:30.115905 [debug] [MainThread]: On master: BEGIN
[0m03:40:30.119112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:40:30.119482 [debug] [MainThread]: On master: COMMIT
[0m03:40:30.119768 [debug] [MainThread]: Using postgres connection "master"
[0m03:40:30.120065 [debug] [MainThread]: On master: COMMIT
[0m03:40:30.121693 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:40:30.122127 [debug] [MainThread]: On master: Close
[0m03:40:30.123096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:40:30.123692 [info ] [MainThread]: 
[0m03:40:30.128464 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m03:40:30.129174 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m03:40:30.130901 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.131334 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m03:40:30.131658 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m03:40:30.136979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.137886 [debug] [Thread-1 (]: finished collecting timing info
[0m03:40:30.138325 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m03:40:30.217133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.217878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.218190 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m03:40:30.218434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:40:30.231525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:40:30.231982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.232276 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:40:30.235941 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m03:40:30.249062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.249450 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:40:30.251627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:40:30.256077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.256401 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:40:30.258776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:40:30.299001 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:40:30.299354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.299601 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m03:40:30.305393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:40:30.314179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m03:40:30.314529 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m03:40:30.364589 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m03:40:30.366941 [debug] [Thread-1 (]: finished collecting timing info
[0m03:40:30.367349 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m03:40:30.368490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76786a77-4540-450b-ad2a-952027b9bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae418160>]}
[0m03:40:30.369346 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.24s]
[0m03:40:30.370195 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m03:40:30.371463 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m03:40:30.372003 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m03:40:30.373408 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.373846 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m03:40:30.374278 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m03:40:30.379972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.380745 [debug] [Thread-1 (]: finished collecting timing info
[0m03:40:30.381187 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m03:40:30.423670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.424495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.424913 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m03:40:30.425191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:40:30.442549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m03:40:30.443054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.443402 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m03:40:30.448770 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:40:30.454231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.454644 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:40:30.457073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:40:30.460265 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:40:30.460627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.460935 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m03:40:30.465204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:40:30.468841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m03:40:30.469175 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m03:40:30.471300 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:40:30.473349 [debug] [Thread-1 (]: finished collecting timing info
[0m03:40:30.473734 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m03:40:30.474937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76786a77-4540-450b-ad2a-952027b9bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae2bf7f0>]}
[0m03:40:30.475655 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m03:40:30.476497 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m03:40:30.478707 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:40:30.479209 [debug] [MainThread]: Using postgres connection "master"
[0m03:40:30.479649 [debug] [MainThread]: On master: BEGIN
[0m03:40:30.480070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:40:30.493710 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:40:30.494239 [debug] [MainThread]: On master: COMMIT
[0m03:40:30.494531 [debug] [MainThread]: Using postgres connection "master"
[0m03:40:30.494795 [debug] [MainThread]: On master: COMMIT
[0m03:40:30.496413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:40:30.496890 [debug] [MainThread]: On master: Close
[0m03:40:30.498168 [info ] [MainThread]: 
[0m03:40:30.499116 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m03:40:30.499968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:40:30.500405 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m03:40:30.516199 [info ] [MainThread]: 
[0m03:40:30.516832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:40:30.517474 [info ] [MainThread]: 
[0m03:40:30.518306 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:40:30.519355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae2c48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae2c4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ae2c59f0>]}
[0m03:40:30.520283 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 12:59:29.310155 | 19bbcfe0-db97-44ad-96d6-ea27cd7571db ==============================
[0m12:59:29.310174 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:59:29.311198 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:59:29.311495 [debug] [MainThread]: Tracking: tracking
[0m12:59:29.313929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e61f3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e61f36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e61f37c0>]}
[0m12:59:29.384317 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:59:29.385065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19bbcfe0-db97-44ad-96d6-ea27cd7571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e6112680>]}
[0m12:59:29.424736 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m12:59:29.430551 [debug] [MainThread]: Parsing macros/relations.sql
[0m12:59:29.433659 [debug] [MainThread]: Parsing macros/catalog.sql
[0m12:59:29.438663 [debug] [MainThread]: Parsing macros/adapters.sql
[0m12:59:29.483393 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m12:59:29.486595 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m12:59:29.488482 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m12:59:29.489399 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m12:59:29.490572 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m12:59:29.492663 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m12:59:29.494890 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m12:59:29.505637 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m12:59:29.508200 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:59:29.514707 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:59:29.518506 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:59:29.522254 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m12:59:29.524532 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:59:29.530371 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:59:29.539555 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:59:29.556931 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:59:29.582629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m12:59:29.585273 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m12:59:29.598671 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m12:59:29.610408 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m12:59:29.683749 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:59:29.691301 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:59:29.701954 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m12:59:29.710618 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m12:59:29.714053 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m12:59:29.717570 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:59:29.720497 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m12:59:29.751567 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:59:29.777501 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:59:29.806710 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:59:29.818975 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:59:29.851780 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m12:59:29.854110 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m12:59:29.856167 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m12:59:29.859400 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m12:59:29.862546 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:59:29.865236 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m12:59:29.867552 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:59:29.869647 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m12:59:29.872032 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m12:59:29.873579 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m12:59:29.875808 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m12:59:29.879447 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m12:59:29.891369 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m12:59:29.893162 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:59:29.895340 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:59:29.897305 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:59:29.900291 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m12:59:29.902256 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m12:59:29.903786 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m12:59:29.907053 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m12:59:29.908892 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m12:59:29.910869 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m12:59:29.913185 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m12:59:29.915300 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m12:59:29.919462 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m12:59:29.922128 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m12:59:29.926548 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m12:59:29.929756 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m12:59:29.931226 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m12:59:29.932495 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m12:59:29.934918 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m12:59:29.936541 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m12:59:29.942732 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m12:59:29.968363 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:59:29.973090 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:59:29.976431 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:59:29.980043 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:59:29.992913 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:59:30.010982 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:59:30.019503 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:59:30.044043 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m12:59:30.053831 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m12:59:30.067841 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m12:59:30.077963 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m12:59:30.510419 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m12:59:30.534334 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m12:59:30.649693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19bbcfe0-db97-44ad-96d6-ea27cd7571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e5705ff0>]}
[0m12:59:30.661137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19bbcfe0-db97-44ad-96d6-ea27cd7571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e61f36a0>]}
[0m12:59:30.661999 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:59:30.662839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19bbcfe0-db97-44ad-96d6-ea27cd7571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e56c3790>]}
[0m12:59:30.665350 [info ] [MainThread]: 
[0m12:59:30.666622 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:59:30.668592 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m12:59:30.693053 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m12:59:30.693553 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m12:59:30.693872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:30.755243 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m12:59:30.755763 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m12:59:30.756068 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m12:59:30.767081 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m12:59:30.769690 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m12:59:30.772055 [debug] [ThreadPool]: On list_test_dev: Close
[0m12:59:30.781157 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:30.781618 [debug] [MainThread]: On master: BEGIN
[0m12:59:30.782097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:30.794557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m12:59:30.795037 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:30.795365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:30.816006 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m12:59:30.818308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19bbcfe0-db97-44ad-96d6-ea27cd7571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e5706d40>]}
[0m12:59:30.818916 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:30.821622 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:30.821999 [debug] [MainThread]: On master: BEGIN
[0m12:59:30.824775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:59:30.825128 [debug] [MainThread]: On master: COMMIT
[0m12:59:30.825402 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:30.825656 [debug] [MainThread]: On master: COMMIT
[0m12:59:30.827236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:30.827603 [debug] [MainThread]: On master: Close
[0m12:59:30.828610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:30.829172 [info ] [MainThread]: 
[0m12:59:30.835448 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:30.836158 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m12:59:30.838077 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:30.838661 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:30.839196 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:30.876377 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:30.878244 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:30.878824 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:30.910398 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:30.911272 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:30.911619 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m12:59:30.911889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:30.929923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m12:59:30.930433 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:30.930735 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test"."dev"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m12:59:30.936126 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m12:59:30.939917 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:30.940407 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:59:30.942325 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:59:30.943784 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.11s]
[0m12:59:30.945019 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:30.945521 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:30.946165 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m12:59:30.947470 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:30.947964 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:30.948288 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:30.957200 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:30.957856 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:30.958200 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:30.962445 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:30.963105 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:30.963414 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m12:59:30.963674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:30.980303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m12:59:30.980813 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:30.981147 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test"."dev"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m12:59:30.984268 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:59:30.986724 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:30.987153 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m12:59:30.989138 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m12:59:30.991007 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.04s]
[0m12:59:30.992205 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:30.992712 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:30.993336 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m12:59:30.995123 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:30.995589 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:30.995908 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:31.010304 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:31.010974 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:31.011332 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:31.015605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:31.016276 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:31.016607 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m12:59:31.016877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:31.033207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m12:59:31.033699 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:31.034024 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test"."dev"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:31.037407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:59:31.040637 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:31.041222 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:59:31.043196 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:59:31.044424 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
[0m12:59:31.045717 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:31.046342 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:31.047088 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m12:59:31.048575 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:31.048983 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:31.049409 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:31.059407 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:31.060083 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:31.060432 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:31.064618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:31.065290 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:31.065683 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m12:59:31.066021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:31.087715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m12:59:31.088326 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:31.088680 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test"."dev"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:31.093405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:59:31.096488 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:31.096972 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m12:59:31.099387 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m12:59:31.100730 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.05s]
[0m12:59:31.101729 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:31.104321 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:59:31.104874 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:31.105368 [debug] [MainThread]: On master: BEGIN
[0m12:59:31.105791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:31.126310 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m12:59:31.127162 [debug] [MainThread]: On master: COMMIT
[0m12:59:31.127497 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:31.127790 [debug] [MainThread]: On master: COMMIT
[0m12:59:31.132017 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:31.132568 [debug] [MainThread]: On master: Close
[0m12:59:31.133830 [info ] [MainThread]: 
[0m12:59:31.134463 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m12:59:31.135021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:31.135299 [debug] [MainThread]: Connection 'test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:59:31.148625 [info ] [MainThread]: 
[0m12:59:31.149666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:31.150428 [info ] [MainThread]: 
[0m12:59:31.151035 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m12:59:31.151629 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:59:31.152189 [info ] [MainThread]: 
[0m12:59:31.152731 [info ] [MainThread]:   compiled Code at target/compiled/dbt_traffic_data/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m12:59:31.153284 [info ] [MainThread]: 
[0m12:59:31.153811 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:59:31.154510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e57353f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e4631450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e572a3b0>]}
[0m12:59:31.155085 [debug] [MainThread]: Flushing usage events
[0m12:59:31.161155 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-12-21 12:59:39.051397 | 7446b198-d680-4015-8949-74d114aa027d ==============================
[0m12:59:39.051428 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:59:39.052552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:59:39.053058 [debug] [MainThread]: Tracking: tracking
[0m12:59:39.056231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a1e3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a1e36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a1e37c0>]}
[0m12:59:39.166511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:39.166942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:39.177652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7446b198-d680-4015-8949-74d114aa027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9897a25c0>]}
[0m12:59:39.190540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7446b198-d680-4015-8949-74d114aa027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989777c40>]}
[0m12:59:39.191229 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:59:39.191825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7446b198-d680-4015-8949-74d114aa027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989777c70>]}
[0m12:59:39.194200 [info ] [MainThread]: 
[0m12:59:39.195927 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:59:39.198691 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m12:59:39.309092 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m12:59:39.309787 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m12:59:39.310282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:39.371260 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
[0m12:59:39.373525 [debug] [ThreadPool]: On list_test: Close
[0m12:59:39.376546 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m12:59:39.388492 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m12:59:39.388919 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m12:59:39.389196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:39.403663 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m12:59:39.404147 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m12:59:39.404437 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m12:59:39.410456 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m12:59:39.412701 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m12:59:39.414482 [debug] [ThreadPool]: On list_test_dev: Close
[0m12:59:39.427677 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:39.428296 [debug] [MainThread]: On master: BEGIN
[0m12:59:39.428773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:39.449491 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m12:59:39.449979 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:39.450275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:39.480781 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
[0m12:59:39.483079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7446b198-d680-4015-8949-74d114aa027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98978fdc0>]}
[0m12:59:39.483681 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:39.485739 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:39.486105 [debug] [MainThread]: On master: BEGIN
[0m12:59:39.489721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:59:39.490154 [debug] [MainThread]: On master: COMMIT
[0m12:59:39.490464 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:39.490896 [debug] [MainThread]: On master: COMMIT
[0m12:59:39.494700 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:39.495144 [debug] [MainThread]: On master: Close
[0m12:59:39.496361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:39.497277 [info ] [MainThread]: 
[0m12:59:39.503791 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m12:59:39.504717 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m12:59:39.506901 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.507493 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m12:59:39.508015 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m12:59:39.516870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.518702 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:39.519834 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m12:59:39.613391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.614209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.614552 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m12:59:39.614841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:39.675375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m12:59:39.675838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.676146 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:59:39.691588 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.02 seconds
[0m12:59:39.706638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.707137 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:59:39.710155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:59:39.715228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.715615 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:59:39.718219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:59:39.768263 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m12:59:39.768709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.769006 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m12:59:39.775870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m12:59:39.785248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m12:59:39.785631 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m12:59:39.831314 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m12:59:39.833524 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:39.833946 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m12:59:39.835124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7446b198-d680-4015-8949-74d114aa027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9897e81c0>]}
[0m12:59:39.835788 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.33s]
[0m12:59:39.836589 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m12:59:39.837908 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m12:59:39.838698 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m12:59:39.840534 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:39.841122 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m12:59:39.841631 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m12:59:39.849889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:39.850903 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:39.851487 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m12:59:39.915354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:39.916273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:39.916638 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m12:59:39.916923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:40.027297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.11 seconds
[0m12:59:40.027851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:40.028176 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m12:59:40.035524 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m12:59:40.040973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:40.041387 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:59:40.044214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:59:40.047617 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m12:59:40.048003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:40.048303 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m12:59:40.053058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:59:40.057876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m12:59:40.058397 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m12:59:40.107370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m12:59:40.109635 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:40.110047 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m12:59:40.111175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7446b198-d680-4015-8949-74d114aa027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98968f850>]}
[0m12:59:40.111859 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.27s]
[0m12:59:40.112694 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m12:59:40.114747 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:59:40.115326 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:40.115771 [debug] [MainThread]: On master: BEGIN
[0m12:59:40.116189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:40.133308 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m12:59:40.133878 [debug] [MainThread]: On master: COMMIT
[0m12:59:40.134230 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:40.134517 [debug] [MainThread]: On master: COMMIT
[0m12:59:40.136768 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:40.137277 [debug] [MainThread]: On master: Close
[0m12:59:40.138749 [info ] [MainThread]: 
[0m12:59:40.139673 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m12:59:40.140325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:40.140670 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m12:59:40.158237 [info ] [MainThread]: 
[0m12:59:40.159334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:40.160369 [info ] [MainThread]: 
[0m12:59:40.161286 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:59:40.162383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989694b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989694a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989694460>]}
[0m12:59:40.163170 [debug] [MainThread]: Flushing usage events
[0m12:59:40.170988 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-12-21 12:59:46.259253 | a0aa2b92-fb3c-4dfc-9637-857e78d1ba5a ==============================
[0m12:59:46.259287 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:59:46.260586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:59:46.261184 [debug] [MainThread]: Tracking: tracking
[0m12:59:46.265137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44f2ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44f2ef7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44f2ecc40>]}
[0m12:59:46.389067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:46.389530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:46.404194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0aa2b92-fb3c-4dfc-9637-857e78d1ba5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44e8b6560>]}
[0m12:59:46.418196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0aa2b92-fb3c-4dfc-9637-857e78d1ba5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44e88bbe0>]}
[0m12:59:46.418889 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:59:46.419505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0aa2b92-fb3c-4dfc-9637-857e78d1ba5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44e88bc10>]}
[0m12:59:46.421852 [info ] [MainThread]: 
[0m12:59:46.423340 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:59:46.425841 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m12:59:46.519378 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m12:59:46.520077 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m12:59:46.520553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:46.547816 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m12:59:46.548548 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m12:59:46.549017 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m12:59:46.558332 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m12:59:46.560935 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m12:59:46.563150 [debug] [ThreadPool]: On list_test_dev: Close
[0m12:59:46.574443 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:46.574917 [debug] [MainThread]: On master: BEGIN
[0m12:59:46.575272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:46.635555 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m12:59:46.636474 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:46.637033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:46.687362 [debug] [MainThread]: SQL status: SELECT 1 in 0.05 seconds
[0m12:59:46.691300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0aa2b92-fb3c-4dfc-9637-857e78d1ba5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44e888af0>]}
[0m12:59:46.692305 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:46.697319 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:46.697960 [debug] [MainThread]: On master: BEGIN
[0m12:59:46.701912 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:59:46.702581 [debug] [MainThread]: On master: COMMIT
[0m12:59:46.703162 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:46.703683 [debug] [MainThread]: On master: COMMIT
[0m12:59:46.705771 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:46.706388 [debug] [MainThread]: On master: Close
[0m12:59:46.707930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:46.708902 [info ] [MainThread]: 
[0m12:59:46.716210 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:46.716706 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m12:59:46.717956 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:46.718362 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:46.718745 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:46.750925 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:46.751713 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:46.752106 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:46.788342 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:46.789183 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:46.789530 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m12:59:46.789811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:46.847209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m12:59:46.847687 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:59:46.847986 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test"."dev"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m12:59:46.852152 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:59:46.855796 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:46.856184 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:59:46.860264 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:59:46.861725 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.14s]
[0m12:59:46.862905 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:59:46.863419 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:46.864023 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m12:59:46.865477 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:46.865897 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:46.866213 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:46.875311 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:46.876070 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:46.876644 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:46.881880 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:46.883102 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:46.883527 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m12:59:46.883809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:46.906945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m12:59:46.907468 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m12:59:46.907780 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test"."dev"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m12:59:46.911957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:59:46.914665 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:46.915166 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m12:59:46.917909 [debug] [Thread-1 (]: On test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m12:59:46.920504 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m12:59:46.922291 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m12:59:46.923318 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:46.923907 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m12:59:46.925833 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:46.926445 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:46.926969 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:46.947079 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:46.947920 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:46.948348 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:46.954980 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:46.956111 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:46.956502 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m12:59:46.956847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:47.023267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m12:59:47.023811 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m12:59:47.024151 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test"."dev"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:47.030851 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m12:59:47.034266 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:47.034804 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:59:47.037158 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:59:47.038682 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.11s]
[0m12:59:47.040141 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m12:59:47.040871 [debug] [Thread-1 (]: Began running node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:47.041665 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m12:59:47.043835 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:47.044408 [debug] [Thread-1 (]: Began compiling node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:47.044932 [debug] [Thread-1 (]: Compiling test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:47.054890 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:47.055699 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:47.056094 [debug] [Thread-1 (]: Began executing node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:47.060848 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:47.061738 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:47.062084 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m12:59:47.062372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:47.127497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m12:59:47.128252 [debug] [Thread-1 (]: Using postgres connection "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:59:47.128713 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test"."dev"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:47.135730 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m12:59:47.138515 [debug] [Thread-1 (]: finished collecting timing info
[0m12:59:47.138995 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m12:59:47.141446 [debug] [Thread-1 (]: On test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m12:59:47.142865 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
[0m12:59:47.143952 [debug] [Thread-1 (]: Finished running node test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m12:59:47.147104 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:59:47.147903 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:47.148348 [debug] [MainThread]: On master: BEGIN
[0m12:59:47.148698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:47.169951 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m12:59:47.170563 [debug] [MainThread]: On master: COMMIT
[0m12:59:47.170967 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:47.171295 [debug] [MainThread]: On master: COMMIT
[0m12:59:47.174710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:47.175366 [debug] [MainThread]: On master: Close
[0m12:59:47.176960 [info ] [MainThread]: 
[0m12:59:47.178084 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:59:47.179225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:47.179783 [debug] [MainThread]: Connection 'test.dbt_traffic_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:59:47.196758 [info ] [MainThread]: 
[0m12:59:47.198185 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:47.199560 [info ] [MainThread]: 
[0m12:59:47.200657 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m12:59:47.201638 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:59:47.202468 [info ] [MainThread]: 
[0m12:59:47.203376 [info ] [MainThread]:   compiled Code at target/compiled/dbt_traffic_data/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m12:59:47.204308 [info ] [MainThread]: 
[0m12:59:47.205155 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:59:47.206405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44e76d6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44f2ec8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44f2ed5a0>]}
[0m12:59:47.207477 [debug] [MainThread]: Flushing usage events
[0m12:59:47.217653 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-12-21 13:03:43.050801 | e50634b3-b8d3-47c2-8d92-1a3e59ef1f16 ==============================
[0m13:03:43.050826 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:03:43.051577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:03:43.051879 [debug] [MainThread]: Tracking: tracking
[0m13:03:43.054209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2dbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2db6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2db7c0>]}
[0m13:03:43.142580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:43.143085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:43.155710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e50634b3-b8d3-47c2-8d92-1a3e59ef1f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b84a5c0>]}
[0m13:03:43.169131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e50634b3-b8d3-47c2-8d92-1a3e59ef1f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b81fc40>]}
[0m13:03:43.169872 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:03:43.170483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e50634b3-b8d3-47c2-8d92-1a3e59ef1f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b81fc70>]}
[0m13:03:43.172533 [info ] [MainThread]: 
[0m13:03:43.173744 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:03:43.175537 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m13:03:43.259014 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m13:03:43.259515 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m13:03:43.259824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:43.277816 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m13:03:43.280358 [debug] [ThreadPool]: On list_test: Close
[0m13:03:43.283694 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m13:03:43.297344 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m13:03:43.297817 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m13:03:43.298207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:43.319509 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:03:43.320162 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m13:03:43.320446 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m13:03:43.326616 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m13:03:43.328891 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m13:03:43.331359 [debug] [ThreadPool]: On list_test_dev: Close
[0m13:03:43.342020 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:43.342461 [debug] [MainThread]: On master: BEGIN
[0m13:03:43.342738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:43.360474 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:03:43.361013 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:43.361325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:03:43.380800 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m13:03:43.383730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e50634b3-b8d3-47c2-8d92-1a3e59ef1f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656d715a20>]}
[0m13:03:43.384448 [debug] [MainThread]: On master: ROLLBACK
[0m13:03:43.387036 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:43.387453 [debug] [MainThread]: On master: BEGIN
[0m13:03:43.390324 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:03:43.390666 [debug] [MainThread]: On master: COMMIT
[0m13:03:43.390972 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:43.391224 [debug] [MainThread]: On master: COMMIT
[0m13:03:43.393645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:03:43.393996 [debug] [MainThread]: On master: Close
[0m13:03:43.395013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:43.395573 [info ] [MainThread]: 
[0m13:03:43.401781 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m13:03:43.402443 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m13:03:43.404105 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.404503 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m13:03:43.404879 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m13:03:43.410538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.411292 [debug] [Thread-1 (]: finished collecting timing info
[0m13:03:43.411667 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m13:03:43.495934 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.496724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.497065 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m13:03:43.497377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:43.557061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m13:03:43.557871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.558382 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:03:43.562908 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:03:43.579034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.579485 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:03:43.582947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:03:43.591347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.591988 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:03:43.595018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:03:43.645385 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m13:03:43.645841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.646131 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m13:03:43.656689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m13:03:43.666022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m13:03:43.666396 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m13:03:43.711306 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m13:03:43.713741 [debug] [Thread-1 (]: finished collecting timing info
[0m13:03:43.714167 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m13:03:43.715415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50634b3-b8d3-47c2-8d92-1a3e59ef1f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b8901c0>]}
[0m13:03:43.716323 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.31s]
[0m13:03:43.717231 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m13:03:43.718444 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m13:03:43.719179 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m13:03:43.720664 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.721213 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m13:03:43.721613 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m13:03:43.727353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.728056 [debug] [Thread-1 (]: finished collecting timing info
[0m13:03:43.728424 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m13:03:43.769344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.770173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.770516 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m13:03:43.770808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:43.788280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m13:03:43.789044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.789537 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m13:03:43.794361 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:03:43.800216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.800657 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:03:43.803546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:03:43.807003 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m13:03:43.807396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.807664 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m13:03:43.812144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:03:43.816191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m13:03:43.816554 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m13:03:43.818602 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:03:43.820665 [debug] [Thread-1 (]: finished collecting timing info
[0m13:03:43.821057 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m13:03:43.822150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50634b3-b8d3-47c2-8d92-1a3e59ef1f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b8901c0>]}
[0m13:03:43.822864 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m13:03:43.823786 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m13:03:43.825899 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:03:43.826378 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:43.826687 [debug] [MainThread]: On master: BEGIN
[0m13:03:43.826983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:43.841778 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m13:03:43.842444 [debug] [MainThread]: On master: COMMIT
[0m13:03:43.842853 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:43.843237 [debug] [MainThread]: On master: COMMIT
[0m13:03:43.846026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:03:43.846622 [debug] [MainThread]: On master: Close
[0m13:03:43.848061 [info ] [MainThread]: 
[0m13:03:43.848917 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m13:03:43.849702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:43.850131 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m13:03:43.866413 [info ] [MainThread]: 
[0m13:03:43.867472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:43.868424 [info ] [MainThread]: 
[0m13:03:43.869237 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:03:43.870157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b7344c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b734ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656b7342b0>]}
[0m13:03:43.870700 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:11:59.331621 | f17fc716-70e0-4e16-8336-634a62de9459 ==============================
[0m15:11:59.331651 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:11:59.333842 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:11:59.334383 [debug] [MainThread]: Tracking: tracking
[0m15:11:59.337984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7595e3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7595e37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7595e0c40>]}
[0m15:11:59.491634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:59.492061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:59.504218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f17fc716-70e0-4e16-8336-634a62de9459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758b02560>]}
[0m15:11:59.517085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f17fc716-70e0-4e16-8336-634a62de9459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758ad7be0>]}
[0m15:11:59.517724 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:11:59.518290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f17fc716-70e0-4e16-8336-634a62de9459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758ad7c10>]}
[0m15:11:59.520570 [info ] [MainThread]: 
[0m15:11:59.522022 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:11:59.523941 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:11:59.610404 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:11:59.610934 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:11:59.611260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:59.629765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:11:59.632318 [debug] [ThreadPool]: On list_test: Close
[0m15:11:59.635523 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m15:11:59.648176 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:11:59.648606 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m15:11:59.648916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:59.663288 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m15:11:59.663769 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:11:59.664056 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m15:11:59.674698 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:11:59.677036 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m15:11:59.679046 [debug] [ThreadPool]: On list_test_dev: Close
[0m15:11:59.687731 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:59.688190 [debug] [MainThread]: On master: BEGIN
[0m15:11:59.688493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:59.703860 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m15:11:59.704344 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:59.704644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:59.725524 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m15:11:59.727874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f17fc716-70e0-4e16-8336-634a62de9459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758aefdc0>]}
[0m15:11:59.728518 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:59.730549 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:59.730929 [debug] [MainThread]: On master: BEGIN
[0m15:11:59.734005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:59.734418 [debug] [MainThread]: On master: COMMIT
[0m15:11:59.734713 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:59.734974 [debug] [MainThread]: On master: COMMIT
[0m15:11:59.740861 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m15:11:59.741335 [debug] [MainThread]: On master: Close
[0m15:11:59.742303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:59.742918 [info ] [MainThread]: 
[0m15:11:59.748850 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:11:59.749490 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m15:11:59.750943 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.751409 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:11:59.751723 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:11:59.756903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.757949 [debug] [Thread-1 (]: finished collecting timing info
[0m15:11:59.758340 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:11:59.846166 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.846958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.847279 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:11:59.847523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:59.862059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m15:11:59.862568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.862856 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:11:59.874902 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m15:11:59.888177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.888617 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:11:59.891368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:59.896042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.896407 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:11:59.898691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:59.941467 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:11:59.941898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.942166 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:11:59.947619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:11:59.956545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:11:59.956924 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m15:12:00.005347 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m15:12:00.007491 [debug] [Thread-1 (]: finished collecting timing info
[0m15:12:00.007974 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:12:00.009298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f17fc716-70e0-4e16-8336-634a62de9459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758b48160>]}
[0m15:12:00.010206 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.26s]
[0m15:12:00.011352 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:12:00.012761 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:12:00.013704 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m15:12:00.015491 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.016039 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:12:00.016531 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:12:00.024477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.025487 [debug] [Thread-1 (]: finished collecting timing info
[0m15:12:00.026064 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:12:00.093952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.095275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.095825 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:12:00.096286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:00.111408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:12:00.112176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.112746 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m15:12:00.118461 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:12:00.130306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.131151 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:12:00.134976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:12:00.140811 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:12:00.141445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.141949 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:12:00.147827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:12:00.154476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:12:00.154966 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m15:12:00.157458 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:12:00.160691 [debug] [Thread-1 (]: finished collecting timing info
[0m15:12:00.161320 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:12:00.162945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f17fc716-70e0-4e16-8336-634a62de9459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758b48160>]}
[0m15:12:00.163966 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:12:00.165292 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:12:00.167720 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:12:00.168334 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:00.168804 [debug] [MainThread]: On master: BEGIN
[0m15:12:00.169252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:00.193034 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m15:12:00.193731 [debug] [MainThread]: On master: COMMIT
[0m15:12:00.194170 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:00.194508 [debug] [MainThread]: On master: COMMIT
[0m15:12:00.196960 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:12:00.197840 [debug] [MainThread]: On master: Close
[0m15:12:00.199862 [info ] [MainThread]: 
[0m15:12:00.201256 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m15:12:00.202112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:00.202598 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:12:00.220120 [info ] [MainThread]: 
[0m15:12:00.221159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:00.222198 [info ] [MainThread]: 
[0m15:12:00.223079 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:12:00.224216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7589f0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7589f0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7589f1a20>]}
[0m15:12:00.225012 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:13:21.564717 | 9d63267d-32c3-41f6-9c5e-dcba1efe1153 ==============================
[0m15:13:21.564740 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:13:21.565467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:13:21.565760 [debug] [MainThread]: Tracking: tracking
[0m15:13:21.569695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4eef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4eef7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4eecc40>]}
[0m15:13:21.662972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:21.663405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:21.674392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d63267d-32c3-41f6-9c5e-dcba1efe1153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4442560>]}
[0m15:13:21.686355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d63267d-32c3-41f6-9c5e-dcba1efe1153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4413be0>]}
[0m15:13:21.686969 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:13:21.687512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d63267d-32c3-41f6-9c5e-dcba1efe1153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4413c10>]}
[0m15:13:21.689750 [info ] [MainThread]: 
[0m15:13:21.691109 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:13:21.692991 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:13:21.765136 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:13:21.765636 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:13:21.765933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:21.785070 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:13:21.787439 [debug] [ThreadPool]: On list_test: Close
[0m15:13:21.790428 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m15:13:21.802471 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:13:21.802887 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m15:13:21.803150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:21.865448 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m15:13:21.866150 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:13:21.866648 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m15:13:21.873353 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:13:21.875729 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m15:13:21.877910 [debug] [ThreadPool]: On list_test_dev: Close
[0m15:13:21.890638 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:21.891264 [debug] [MainThread]: On master: BEGIN
[0m15:13:21.891739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:21.905395 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m15:13:21.905895 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:21.906187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:13:21.927216 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m15:13:21.930754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d63267d-32c3-41f6-9c5e-dcba1efe1153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb442fdc0>]}
[0m15:13:21.931707 [debug] [MainThread]: On master: ROLLBACK
[0m15:13:21.934082 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:21.934645 [debug] [MainThread]: On master: BEGIN
[0m15:13:21.985518 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:13:21.986284 [debug] [MainThread]: On master: COMMIT
[0m15:13:21.986807 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:21.987287 [debug] [MainThread]: On master: COMMIT
[0m15:13:21.990397 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:13:21.991071 [debug] [MainThread]: On master: Close
[0m15:13:21.992649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:21.993728 [info ] [MainThread]: 
[0m15:13:22.005212 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:13:22.006171 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m15:13:22.008416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.008998 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:13:22.009506 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:13:22.026577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.028024 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:22.028770 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:13:22.166650 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.167877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.168425 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:13:22.168901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:22.197534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:13:22.198303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.198851 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:13:22.203463 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:13:22.224758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.225430 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:13:22.228516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:13:22.236114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.236665 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:13:22.240174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:13:22.283355 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:13:22.283758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.284029 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:13:22.289496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:13:22.298541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:13:22.298911 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m15:13:22.345556 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m15:13:22.348070 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:22.348512 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:13:22.349670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d63267d-32c3-41f6-9c5e-dcba1efe1153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4488160>]}
[0m15:13:22.350384 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.34s]
[0m15:13:22.351237 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:13:22.352533 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:13:22.353040 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m15:13:22.354372 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.354898 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:13:22.355388 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:13:22.363364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.364243 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:22.364666 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:13:22.411212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.412464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.413127 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:13:22.413619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:22.513523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m15:13:22.514049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.514343 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m15:13:22.520040 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:13:22.525214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.525584 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:13:22.528277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:13:22.531663 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:13:22.532038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.532299 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:13:22.541875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:13:22.545821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:13:22.546171 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m15:13:22.589453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m15:13:22.591661 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:22.592088 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:13:22.593185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d63267d-32c3-41f6-9c5e-dcba1efe1153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb432f7f0>]}
[0m15:13:22.593837 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.24s]
[0m15:13:22.594599 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:13:22.596754 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:13:22.597259 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:22.597639 [debug] [MainThread]: On master: BEGIN
[0m15:13:22.598029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:22.701387 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
[0m15:13:22.701880 [debug] [MainThread]: On master: COMMIT
[0m15:13:22.702198 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:22.702458 [debug] [MainThread]: On master: COMMIT
[0m15:13:22.704703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:13:22.705123 [debug] [MainThread]: On master: Close
[0m15:13:22.706119 [info ] [MainThread]: 
[0m15:13:22.706678 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:13:22.707160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:22.707407 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:13:22.724490 [info ] [MainThread]: 
[0m15:13:22.725196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:22.726075 [info ] [MainThread]: 
[0m15:13:22.726793 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:22.727740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4334b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4334ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4336170>]}
[0m15:13:22.728387 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:14:09.200295 | 28287950-d581-4eb7-ad25-f59d4cf83ccf ==============================
[0m15:14:09.200318 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:14:09.201026 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:14:09.201310 [debug] [MainThread]: Tracking: tracking
[0m15:14:09.204205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd461ecf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd461ecfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd461ecffd0>]}
[0m15:14:09.294079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:09.294508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:09.305465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28287950-d581-4eb7-ad25-f59d4cf83ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4614164d0>]}
[0m15:14:09.316915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28287950-d581-4eb7-ad25-f59d4cf83ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4613ebb50>]}
[0m15:14:09.317503 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:14:09.318024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28287950-d581-4eb7-ad25-f59d4cf83ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4613ebb80>]}
[0m15:14:09.320204 [info ] [MainThread]: 
[0m15:14:09.321596 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:14:09.323415 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:14:09.412449 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:14:09.412926 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:14:09.413243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:09.432135 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:14:09.434512 [debug] [ThreadPool]: On list_test: Close
[0m15:14:09.437224 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m15:14:09.449417 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:14:09.449832 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m15:14:09.450163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:09.466084 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m15:14:09.466557 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:14:09.466860 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m15:14:09.472643 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:14:09.474913 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m15:14:09.476997 [debug] [ThreadPool]: On list_test_dev: Close
[0m15:14:09.485623 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:09.485992 [debug] [MainThread]: On master: BEGIN
[0m15:14:09.486275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:09.498126 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m15:14:09.498566 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:09.498840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:09.515563 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m15:14:09.517735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28287950-d581-4eb7-ad25-f59d4cf83ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd461403df0>]}
[0m15:14:09.518280 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:09.520032 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:09.520365 [debug] [MainThread]: On master: BEGIN
[0m15:14:09.523660 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:09.524049 [debug] [MainThread]: On master: COMMIT
[0m15:14:09.524312 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:09.524558 [debug] [MainThread]: On master: COMMIT
[0m15:14:09.525890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:09.526225 [debug] [MainThread]: On master: Close
[0m15:14:09.527222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:09.527767 [info ] [MainThread]: 
[0m15:14:09.532822 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:14:09.533500 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m15:14:09.535236 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.535835 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:14:09.536156 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:14:09.541490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.542252 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:09.542714 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:14:09.628559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.629351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.629692 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:14:09.629962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:09.645107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:14:09.645603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.645894 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:14:09.651251 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m15:14:09.664780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.665187 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:14:09.668516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:09.673321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.673660 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:14:09.676370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:09.718023 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:14:09.718555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.718964 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:14:09.723408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:09.731812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:14:09.732176 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m15:14:09.777494 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m15:14:09.779793 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:09.780211 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:14:09.781312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28287950-d581-4eb7-ad25-f59d4cf83ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46145c0d0>]}
[0m15:14:09.781976 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.25s]
[0m15:14:09.782748 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:14:09.783903 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:14:09.784389 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m15:14:09.785601 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.785991 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:14:09.786304 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:14:09.792123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.792879 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:09.793287 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:14:09.837267 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.838148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.838517 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:14:09.838798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:09.905650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m15:14:09.906454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.907006 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m15:14:09.912657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:14:09.920759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.921341 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:14:09.923912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:09.926963 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:14:09.927290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.927567 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:14:09.933406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:14:09.936893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:14:09.937241 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m15:14:09.939806 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:14:09.941716 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:09.942083 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:14:09.943114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28287950-d581-4eb7-ad25-f59d4cf83ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4612fb760>]}
[0m15:14:09.943768 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:14:09.944619 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:14:09.947015 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:14:09.947611 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:09.948100 [debug] [MainThread]: On master: BEGIN
[0m15:14:09.948564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:09.971155 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m15:14:09.971695 [debug] [MainThread]: On master: COMMIT
[0m15:14:09.972007 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:09.972290 [debug] [MainThread]: On master: COMMIT
[0m15:14:09.974276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:09.974868 [debug] [MainThread]: On master: Close
[0m15:14:09.976046 [info ] [MainThread]: 
[0m15:14:09.976775 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m15:14:09.977580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:09.978051 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:14:09.994948 [info ] [MainThread]: 
[0m15:14:09.995981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:09.997092 [info ] [MainThread]: 
[0m15:14:09.997821 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:14:09.998816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4612fc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4612fcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4612ff130>]}
[0m15:14:09.999602 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:15:56.125073 | 0d8c5e25-16e3-4520-b04e-8587d051ee8c ==============================
[0m15:15:56.125095 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:15:56.125789 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:15:56.126069 [debug] [MainThread]: Tracking: tracking
[0m15:15:56.128372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a664ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a664ef7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a664efdf0>]}
[0m15:15:56.220483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:56.220978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:56.233213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d8c5e25-16e3-4520-b04e-8587d051ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65a5e530>]}
[0m15:15:56.245757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d8c5e25-16e3-4520-b04e-8587d051ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65a2fbb0>]}
[0m15:15:56.246364 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:15:56.246926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8c5e25-16e3-4520-b04e-8587d051ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65a2fbe0>]}
[0m15:15:56.249153 [info ] [MainThread]: 
[0m15:15:56.250358 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:15:56.252264 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:15:56.332629 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:15:56.333171 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:15:56.333485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:56.354066 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:15:56.356583 [debug] [ThreadPool]: On list_test: Close
[0m15:15:56.359317 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m15:15:56.371673 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:15:56.372122 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m15:15:56.372407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:56.429532 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m15:15:56.430009 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:15:56.430279 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m15:15:56.439238 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:15:56.441414 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m15:15:56.443760 [debug] [ThreadPool]: On list_test_dev: Close
[0m15:15:56.452721 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:56.453137 [debug] [MainThread]: On master: BEGIN
[0m15:15:56.453405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:56.509373 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m15:15:56.509826 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:56.510129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:56.527647 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m15:15:56.529752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8c5e25-16e3-4520-b04e-8587d051ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65a4bca0>]}
[0m15:15:56.530309 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:56.532371 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:56.532752 [debug] [MainThread]: On master: BEGIN
[0m15:15:56.577528 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m15:15:56.578000 [debug] [MainThread]: On master: COMMIT
[0m15:15:56.578304 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:56.578566 [debug] [MainThread]: On master: COMMIT
[0m15:15:56.581088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:56.581449 [debug] [MainThread]: On master: Close
[0m15:15:56.582373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:56.582912 [info ] [MainThread]: 
[0m15:15:56.587530 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:15:56.588373 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m15:15:56.590128 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.590494 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:15:56.590888 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:15:56.596258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.597067 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:56.597447 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:15:56.685143 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.685901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.686236 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:15:56.686516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.704818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:15:56.705273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.705550 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:15:56.709861 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:15:56.722716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.723097 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:15:56.726542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:56.731024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.731348 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:15:56.733118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:56.772783 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:15:56.773206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.773472 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:15:56.779066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:15:56.787861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:15:56.788252 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m15:15:56.833425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m15:15:56.835637 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:56.836052 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:15:56.837179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8c5e25-16e3-4520-b04e-8587d051ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65aa4130>]}
[0m15:15:56.837849 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.25s]
[0m15:15:56.838634 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:15:56.839880 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:15:56.840357 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m15:15:56.841637 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.842114 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:15:56.842445 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:15:56.849195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.849953 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:56.850346 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:15:56.894100 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.895218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.895810 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:15:56.896150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.961459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m15:15:56.961965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.962237 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m15:15:56.968489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:15:56.973235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.973573 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:15:56.976599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:56.979599 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:15:56.979934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:56.980182 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:15:56.995926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m15:15:56.999660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:15:57.000101 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m15:15:57.045697 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m15:15:57.049018 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:57.049601 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:15:57.051034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8c5e25-16e3-4520-b04e-8587d051ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a659437c0>]}
[0m15:15:57.051872 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m15:15:57.053233 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:15:57.055652 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:15:57.056277 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:57.056774 [debug] [MainThread]: On master: BEGIN
[0m15:15:57.057308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:57.084244 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:15:57.084790 [debug] [MainThread]: On master: COMMIT
[0m15:15:57.085160 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:57.085453 [debug] [MainThread]: On master: COMMIT
[0m15:15:57.087705 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:57.088359 [debug] [MainThread]: On master: Close
[0m15:15:57.089887 [info ] [MainThread]: 
[0m15:15:57.090715 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m15:15:57.091519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:57.091999 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:15:57.109536 [info ] [MainThread]: 
[0m15:15:57.110223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:57.111056 [info ] [MainThread]: 
[0m15:15:57.111579 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:15:57.112367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65948b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65948a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a65948550>]}
[0m15:15:57.113143 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:19:26.185154 | 08bf965a-93ff-4c16-8711-318ed63cbb8b ==============================
[0m15:19:26.185176 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:19:26.185859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:19:26.186130 [debug] [MainThread]: Tracking: tracking
[0m15:19:26.188336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81dbccf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81dbccf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81dbcccc40>]}
[0m15:19:26.278374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:26.278821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:26.289706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08bf965a-93ff-4c16-8711-318ed63cbb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db252560>]}
[0m15:19:26.301886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08bf965a-93ff-4c16-8711-318ed63cbb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db227be0>]}
[0m15:19:26.302494 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:19:26.303013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08bf965a-93ff-4c16-8711-318ed63cbb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db227c10>]}
[0m15:19:26.305143 [info ] [MainThread]: 
[0m15:19:26.306442 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:19:26.308258 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:19:26.392877 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:19:26.393796 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:19:26.394136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:26.412202 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:19:26.414766 [debug] [ThreadPool]: On list_test: Close
[0m15:19:26.417369 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m15:19:26.430024 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:19:26.430679 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m15:19:26.431126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:26.446843 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m15:19:26.447393 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:19:26.447707 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m15:19:26.455957 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:19:26.458276 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m15:19:26.460268 [debug] [ThreadPool]: On list_test_dev: Close
[0m15:19:26.473247 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:26.473868 [debug] [MainThread]: On master: BEGIN
[0m15:19:26.474317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:26.541496 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m15:19:26.542188 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:26.542643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:26.566566 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m15:19:26.570130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08bf965a-93ff-4c16-8711-318ed63cbb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db23fdc0>]}
[0m15:19:26.570985 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:26.573520 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:26.574068 [debug] [MainThread]: On master: BEGIN
[0m15:19:26.577746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:19:26.578298 [debug] [MainThread]: On master: COMMIT
[0m15:19:26.578736 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:26.579145 [debug] [MainThread]: On master: COMMIT
[0m15:19:26.581021 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:19:26.581604 [debug] [MainThread]: On master: Close
[0m15:19:26.582982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:26.583863 [info ] [MainThread]: 
[0m15:19:26.590508 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:19:26.591448 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m15:19:26.593680 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.594289 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:19:26.594786 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:19:26.603370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.604419 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:26.605272 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:19:26.715390 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.716227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.716570 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:19:26.716846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:26.729689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m15:19:26.730380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.730893 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:19:26.735227 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:19:26.756047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.756697 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:19:26.760066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:19:26.764791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.765169 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:19:26.767919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:19:26.821957 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:19:26.822512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.822975 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:19:26.828294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:19:26.840655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:19:26.841109 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m15:19:26.885601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m15:19:26.887802 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:26.888206 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:19:26.889325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08bf965a-93ff-4c16-8711-318ed63cbb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db298160>]}
[0m15:19:26.890259 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.30s]
[0m15:19:26.891421 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:19:26.892708 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:19:26.893472 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m15:19:26.895008 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:26.895525 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:19:26.895953 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:19:26.901396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:26.902063 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:26.902420 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:19:26.950893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:26.951736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:26.952081 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:19:26.952357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:27.013452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m15:19:27.013959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:27.014272 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m15:19:27.022815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:19:27.027969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:27.028368 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:19:27.031627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:19:27.035084 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:19:27.035452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:27.035725 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:19:27.041506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:19:27.045932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:19:27.046361 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m15:19:27.093508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m15:19:27.095867 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:27.096301 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:19:27.097488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08bf965a-93ff-4c16-8711-318ed63cbb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db298160>]}
[0m15:19:27.098169 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:19:27.098958 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:19:27.101496 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:19:27.102160 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:27.102676 [debug] [MainThread]: On master: BEGIN
[0m15:19:27.103156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:27.123006 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m15:19:27.123548 [debug] [MainThread]: On master: COMMIT
[0m15:19:27.123883 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:27.124255 [debug] [MainThread]: On master: COMMIT
[0m15:19:27.131934 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m15:19:27.132762 [debug] [MainThread]: On master: Close
[0m15:19:27.133984 [info ] [MainThread]: 
[0m15:19:27.134617 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:19:27.135180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:27.135631 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:19:27.154923 [info ] [MainThread]: 
[0m15:19:27.155951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:27.156885 [info ] [MainThread]: 
[0m15:19:27.157523 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:19:27.158555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db140ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db140b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81db1402b0>]}
[0m15:19:27.159271 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:51:15.420616 | 48acbabb-5d18-4fd1-bd09-d96234878cb2 ==============================
[0m15:51:15.420636 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:51:15.421321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:15.421599 [debug] [MainThread]: Tracking: tracking
[0m15:51:15.423695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f23d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f23d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f23d7fd0>]}
[0m15:51:15.507782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:15.508221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:15.519323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48acbabb-5d18-4fd1-bd09-d96234878cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f18e24d0>]}
[0m15:51:15.530943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48acbabb-5d18-4fd1-bd09-d96234878cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f18b7b50>]}
[0m15:51:15.531577 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:51:15.532141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48acbabb-5d18-4fd1-bd09-d96234878cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f18b7b80>]}
[0m15:51:15.534362 [info ] [MainThread]: 
[0m15:51:15.535638 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:51:15.537509 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:51:15.618023 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:51:15.618805 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:51:15.619155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:15.637306 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:51:15.639770 [debug] [ThreadPool]: On list_test: Close
[0m15:51:15.642834 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_dev"
[0m15:51:15.654756 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:51:15.655181 [debug] [ThreadPool]: On list_test_dev: BEGIN
[0m15:51:15.655493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:15.671219 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m15:51:15.671684 [debug] [ThreadPool]: Using postgres connection "list_test_dev"
[0m15:51:15.671966 [debug] [ThreadPool]: On list_test_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "list_test_dev"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m15:51:15.677944 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:51:15.680184 [debug] [ThreadPool]: On list_test_dev: ROLLBACK
[0m15:51:15.682914 [debug] [ThreadPool]: On list_test_dev: Close
[0m15:51:15.694235 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:15.694894 [debug] [MainThread]: On master: BEGIN
[0m15:51:15.695371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:15.829556 [debug] [MainThread]: SQL status: BEGIN in 0.13 seconds
[0m15:51:15.830282 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:15.830722 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:15.877523 [debug] [MainThread]: SQL status: SELECT 1 in 0.05 seconds
[0m15:51:15.879811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48acbabb-5d18-4fd1-bd09-d96234878cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f18cfdf0>]}
[0m15:51:15.880409 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:15.883551 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:15.883930 [debug] [MainThread]: On master: BEGIN
[0m15:51:15.887270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:51:15.887646 [debug] [MainThread]: On master: COMMIT
[0m15:51:15.887910 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:15.888149 [debug] [MainThread]: On master: COMMIT
[0m15:51:15.889691 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:51:15.890091 [debug] [MainThread]: On master: Close
[0m15:51:15.891114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:15.891696 [info ] [MainThread]: 
[0m15:51:15.896789 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:51:15.897551 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m15:51:15.899391 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:15.899771 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:51:15.900145 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:51:15.905979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:15.906755 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:15.907282 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:51:15.999917 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.000784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.001149 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:51:16.001415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:16.019319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:51:16.019801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.020068 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:51:16.023894 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:51:16.037337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.037736 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:51:16.040723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:16.045318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.045646 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:51:16.047784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:16.098768 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:51:16.099394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.099805 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:51:16.106195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:51:16.116821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:51:16.117253 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m15:51:16.161510 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m15:51:16.165202 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:16.165808 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:51:16.167364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48acbabb-5d18-4fd1-bd09-d96234878cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f19280d0>]}
[0m15:51:16.168433 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.27s]
[0m15:51:16.169838 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:51:16.171449 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:51:16.172234 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m15:51:16.174156 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.174741 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:51:16.175256 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:51:16.183709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.184809 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:16.185529 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:51:16.250993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.252210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.252775 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:51:16.253269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:16.353550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m15:51:16.354283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.354777 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."dev"."my_first_dbt_model"
where id = 1
  );
[0m15:51:16.359526 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:51:16.367763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.368322 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:51:16.371884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:16.377168 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:51:16.377705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.378155 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:51:16.384109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:51:16.390192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:51:16.390772 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "dev", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m15:51:16.437500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m15:51:16.439708 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:16.440153 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:51:16.441302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48acbabb-5d18-4fd1-bd09-d96234878cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f17cf760>]}
[0m15:51:16.442524 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.27s]
[0m15:51:16.443771 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:51:16.446231 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:51:16.446729 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:16.447141 [debug] [MainThread]: On master: BEGIN
[0m15:51:16.447525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:16.509632 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m15:51:16.510346 [debug] [MainThread]: On master: COMMIT
[0m15:51:16.510745 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:16.511141 [debug] [MainThread]: On master: COMMIT
[0m15:51:16.513632 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:51:16.514048 [debug] [MainThread]: On master: Close
[0m15:51:16.515192 [info ] [MainThread]: 
[0m15:51:16.515782 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m15:51:16.516345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:16.516761 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:51:16.531250 [info ] [MainThread]: 
[0m15:51:16.531910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:16.532624 [info ] [MainThread]: 
[0m15:51:16.533366 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:51:16.534257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f17d49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f17d4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f17d7d60>]}
[0m15:51:16.534816 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:52:05.094056 | 5417fb55-621c-4293-84d5-12de95d15fd7 ==============================
[0m15:52:05.094088 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:52:05.096154 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:52:05.096820 [debug] [MainThread]: Tracking: tracking
[0m15:52:05.100549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71029cf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71029ccbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71029ccbb0>]}
[0m15:52:05.198994 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:52:05.199857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7102dc2950>]}
[0m15:52:05.229518 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m15:52:05.237228 [debug] [MainThread]: Parsing macros/relations.sql
[0m15:52:05.241948 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:52:05.249356 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:52:05.322122 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m15:52:05.327197 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m15:52:05.330242 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:52:05.331693 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:52:05.333604 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:52:05.337389 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:52:05.341327 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:52:05.360080 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:52:05.364660 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:52:05.376138 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:52:05.382946 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:52:05.389535 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:52:05.397534 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:52:05.407737 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:52:05.423399 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:52:05.452798 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:52:05.490828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:52:05.495305 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:52:05.518010 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:52:05.538947 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:52:05.646524 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:52:05.658181 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:52:05.674481 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:52:05.688353 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:52:05.694176 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:52:05.699671 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:52:05.704610 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:52:05.744479 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:52:05.783375 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:52:05.836453 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:52:05.858735 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:52:05.916251 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:52:05.920052 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:52:05.923334 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:52:05.927512 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:52:05.931346 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:52:05.934688 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:52:05.937998 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:52:05.940919 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:52:05.944737 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:52:05.947765 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:52:05.952071 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:52:05.958539 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:52:05.975972 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:52:05.978596 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:52:05.981171 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:52:05.983929 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:52:05.987814 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:52:05.990237 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:52:05.991986 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:52:05.995823 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:52:05.997786 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:52:06.000205 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:52:06.002944 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:52:06.005737 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:52:06.010975 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:52:06.014575 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:52:06.019862 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:52:06.023404 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:52:06.025376 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:52:06.026944 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:52:06.030468 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:52:06.032411 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:52:06.040623 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:52:06.068374 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:52:06.073858 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:52:06.077735 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:52:06.081981 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:52:06.095857 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:52:06.117204 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:52:06.126510 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:52:06.156312 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:52:06.167392 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:52:06.183419 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:52:06.195284 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:52:06.666579 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:52:06.691911 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:52:06.825553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7101fba1a0>]}
[0m15:52:06.836932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71020797b0>]}
[0m15:52:06.837529 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:52:06.838060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71029cf6a0>]}
[0m15:52:06.840236 [info ] [MainThread]: 
[0m15:52:06.841936 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:52:06.844359 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:52:06.879496 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:52:06.880150 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:52:06.880596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:06.900523 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m15:52:06.904748 [debug] [ThreadPool]: On list_test: Close
[0m15:52:06.907404 [debug] [ThreadPool]: Acquiring new postgres connection "create_test_prod"
[0m15:52:06.908708 [debug] [ThreadPool]: Acquiring new postgres connection "create_test_prod"
[0m15:52:06.909379 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='test', schema='prod', identifier=None)"
[0m15:52:06.925545 [debug] [ThreadPool]: Using postgres connection "create_test_prod"
[0m15:52:06.926129 [debug] [ThreadPool]: On create_test_prod: BEGIN
[0m15:52:06.926544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:06.942157 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m15:52:06.942637 [debug] [ThreadPool]: Using postgres connection "create_test_prod"
[0m15:52:06.942966 [debug] [ThreadPool]: On create_test_prod: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "create_test_prod"} */
create schema if not exists "prod"
[0m15:52:06.949036 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.01 seconds
[0m15:52:06.950552 [debug] [ThreadPool]: On create_test_prod: COMMIT
[0m15:52:06.950871 [debug] [ThreadPool]: Using postgres connection "create_test_prod"
[0m15:52:06.951117 [debug] [ThreadPool]: On create_test_prod: COMMIT
[0m15:52:06.955593 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m15:52:06.955959 [debug] [ThreadPool]: On create_test_prod: Close
[0m15:52:06.958976 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_prod"
[0m15:52:06.970310 [debug] [ThreadPool]: Using postgres connection "list_test_prod"
[0m15:52:06.970710 [debug] [ThreadPool]: On list_test_prod: BEGIN
[0m15:52:06.970973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:07.025508 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:52:07.026036 [debug] [ThreadPool]: Using postgres connection "list_test_prod"
[0m15:52:07.026397 [debug] [ThreadPool]: On list_test_prod: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_prod"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod'
  
[0m15:52:07.033900 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m15:52:07.036647 [debug] [ThreadPool]: On list_test_prod: ROLLBACK
[0m15:52:07.039547 [debug] [ThreadPool]: On list_test_prod: Close
[0m15:52:07.049679 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:07.050116 [debug] [MainThread]: On master: BEGIN
[0m15:52:07.050392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:07.065108 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m15:52:07.065588 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:07.065889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:07.084333 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m15:52:07.086656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7101fcc100>]}
[0m15:52:07.087274 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:07.089229 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:07.089645 [debug] [MainThread]: On master: BEGIN
[0m15:52:07.137459 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:52:07.137958 [debug] [MainThread]: On master: COMMIT
[0m15:52:07.138322 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:07.138592 [debug] [MainThread]: On master: COMMIT
[0m15:52:07.141092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:52:07.141518 [debug] [MainThread]: On master: Close
[0m15:52:07.142418 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m15:52:07.142984 [info ] [MainThread]: 
[0m15:52:07.148396 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:52:07.149127 [info ] [Thread-1 (]: 1 of 2 START sql table model prod.my_first_dbt_model ........................... [RUN]
[0m15:52:07.150685 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.151144 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:52:07.151473 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:52:07.159640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.161506 [debug] [Thread-1 (]: finished collecting timing info
[0m15:52:07.162127 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:52:07.251494 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.252277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.252616 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:52:07.252903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:07.270640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:52:07.271086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.271349 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."prod"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:52:07.275220 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:52:07.286689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.287054 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."prod"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:52:07.289599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:52:07.326962 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:52:07.327340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.327587 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:52:07.333843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:52:07.342898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:52:07.343278 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."prod"."my_first_dbt_model__dbt_backup" cascade
[0m15:52:07.345855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:52:07.347812 [debug] [Thread-1 (]: finished collecting timing info
[0m15:52:07.348176 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:52:07.349345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7102042890>]}
[0m15:52:07.350021 [info ] [Thread-1 (]: 1 of 2 OK created sql table model prod.my_first_dbt_model ...................... [[32mSELECT 2[0m in 0.20s]
[0m15:52:07.350903 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:52:07.352089 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:52:07.352557 [info ] [Thread-1 (]: 2 of 2 START sql view model prod.my_second_dbt_model ........................... [RUN]
[0m15:52:07.353975 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.354493 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:52:07.354995 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:52:07.363168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.364135 [debug] [Thread-1 (]: finished collecting timing info
[0m15:52:07.364672 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:52:07.412779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.413893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.414357 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:52:07.414708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:07.428620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m15:52:07.429129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.429497 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."prod"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."prod"."my_first_dbt_model"
where id = 1
  );
[0m15:52:07.434233 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:52:07.442232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.442632 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."prod"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:52:07.445232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:52:07.448348 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:52:07.448696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.448984 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:52:07.453693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:52:07.457594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:52:07.457949 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."prod"."my_second_dbt_model__dbt_backup" cascade
[0m15:52:07.460146 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:52:07.462186 [debug] [Thread-1 (]: finished collecting timing info
[0m15:52:07.462583 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:52:07.463628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5417fb55-621c-4293-84d5-12de95d15fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7100ef8e80>]}
[0m15:52:07.464316 [info ] [Thread-1 (]: 2 of 2 OK created sql view model prod.my_second_dbt_model ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m15:52:07.465164 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:52:07.467553 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:52:07.468215 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:07.468746 [debug] [MainThread]: On master: BEGIN
[0m15:52:07.469268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:07.485756 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m15:52:07.486326 [debug] [MainThread]: On master: COMMIT
[0m15:52:07.486646 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:07.487049 [debug] [MainThread]: On master: COMMIT
[0m15:52:07.489360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:52:07.489944 [debug] [MainThread]: On master: Close
[0m15:52:07.491372 [info ] [MainThread]: 
[0m15:52:07.492070 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m15:52:07.492616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:07.492903 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:52:07.506696 [info ] [MainThread]: 
[0m15:52:07.507771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:07.508721 [info ] [MainThread]: 
[0m15:52:07.509788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:52:07.510775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710054f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710054f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7100ef8e80>]}
[0m15:52:07.511388 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:53:02.622981 | b8268cd2-417d-4202-9feb-e5a808934271 ==============================
[0m15:53:02.623003 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:53:02.623718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:53:02.624013 [debug] [MainThread]: Tracking: tracking
[0m15:53:02.626380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed15d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed15d77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed15d4c40>]}
[0m15:53:02.718164 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:53:02.718915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed19c9f60>]}
[0m15:53:02.743880 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m15:53:02.748624 [debug] [MainThread]: Parsing macros/relations.sql
[0m15:53:02.751440 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:53:02.757008 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:53:02.806258 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m15:53:02.809608 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m15:53:02.811469 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:53:02.812416 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:53:02.813592 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:53:02.815771 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:53:02.818092 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:53:02.829712 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:53:02.832335 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:53:02.839085 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:53:02.843133 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:53:02.848653 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:53:02.851067 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:53:02.857229 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:53:02.866818 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:53:02.884490 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:53:02.910258 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:53:02.912898 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:53:02.927377 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:53:02.939349 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:53:03.014490 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:53:03.021981 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:53:03.033323 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:53:03.041994 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:53:03.045442 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:53:03.048919 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:53:03.052099 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:53:03.077371 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:53:03.099020 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:53:03.127692 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:53:03.139670 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:53:03.171155 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:53:03.173176 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:53:03.174814 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:53:03.176879 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:53:03.178760 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:53:03.180421 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:53:03.182374 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:53:03.184347 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:53:03.186613 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:53:03.188154 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:53:03.190356 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:53:03.193967 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:53:03.204805 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:53:03.206514 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:53:03.208533 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:53:03.210443 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:53:03.213017 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:53:03.214804 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:53:03.216216 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:53:03.219206 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:53:03.220846 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:53:03.222612 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:53:03.224631 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:53:03.226440 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:53:03.230344 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:53:03.233001 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:53:03.236956 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:53:03.239567 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:53:03.240998 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:53:03.242189 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:53:03.244443 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:53:03.245924 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:53:03.252105 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:53:03.280066 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:53:03.285403 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:53:03.288953 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:53:03.292742 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:53:03.304748 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:53:03.320795 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:53:03.328450 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:53:03.352325 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:53:03.363985 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:53:03.386392 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:53:03.399547 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:53:03.960120 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:53:03.989707 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:53:04.178279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0ad5210>]}
[0m15:53:04.192927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed15d77c0>]}
[0m15:53:04.193825 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:53:04.194596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0a93850>]}
[0m15:53:04.197559 [info ] [MainThread]: 
[0m15:53:04.199328 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:53:04.201732 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:53:04.233480 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:53:04.234146 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:53:04.234620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:04.302278 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m15:53:04.306525 [debug] [ThreadPool]: On list_test: Close
[0m15:53:04.312667 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m15:53:04.329251 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m15:53:04.329896 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m15:53:04.330340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:04.352786 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m15:53:04.353588 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m15:53:04.354123 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:53:04.363459 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:53:04.367400 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m15:53:04.371583 [debug] [ThreadPool]: On list_test_public: Close
[0m15:53:04.392492 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:04.393172 [debug] [MainThread]: On master: BEGIN
[0m15:53:04.393592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:04.509539 [debug] [MainThread]: SQL status: BEGIN in 0.12 seconds
[0m15:53:04.510314 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:04.510819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:53:04.553389 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m15:53:04.556325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0b5fb20>]}
[0m15:53:04.557093 [debug] [MainThread]: On master: ROLLBACK
[0m15:53:04.559813 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:04.560179 [debug] [MainThread]: On master: BEGIN
[0m15:53:04.568242 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m15:53:04.568731 [debug] [MainThread]: On master: COMMIT
[0m15:53:04.569066 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:04.569375 [debug] [MainThread]: On master: COMMIT
[0m15:53:04.571519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:53:04.572234 [debug] [MainThread]: On master: Close
[0m15:53:04.573802 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m15:53:04.574857 [info ] [MainThread]: 
[0m15:53:04.582513 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:53:04.583597 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:53:04.584936 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.585452 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:53:04.585819 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:53:04.591867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.592753 [debug] [Thread-1 (]: finished collecting timing info
[0m15:53:04.593328 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:53:04.693113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.694005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.694421 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:53:04.694708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:04.713227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:53:04.713767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.714109 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:53:04.718293 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:53:04.732061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.732504 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:53:04.735861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:53:04.784565 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:53:04.785066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.785370 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:53:04.791019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:53:04.800930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:53:04.801329 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:53:04.803821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:53:04.806131 [debug] [Thread-1 (]: finished collecting timing info
[0m15:53:04.806559 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:53:04.807811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0c583a0>]}
[0m15:53:04.808622 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m15:53:04.809488 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:53:04.810502 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:53:04.811482 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:53:04.812876 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.813388 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:53:04.813771 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:53:04.819686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.820435 [debug] [Thread-1 (]: finished collecting timing info
[0m15:53:04.820819 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:53:04.861119 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.862114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.862672 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:53:04.863119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:04.925400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m15:53:04.925880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.926160 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:53:04.931523 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:53:04.936444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.936828 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:53:04.939571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:53:04.942762 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:53:04.943084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.943331 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:53:04.948494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:53:04.957010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:53:04.957552 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:53:05.001544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m15:53:05.004893 [debug] [Thread-1 (]: finished collecting timing info
[0m15:53:05.005521 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:53:05.007052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8268cd2-417d-4202-9feb-e5a808934271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec39c8df0>]}
[0m15:53:05.008015 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.19s]
[0m15:53:05.009306 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:53:05.011638 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:53:05.012194 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:05.012600 [debug] [MainThread]: On master: BEGIN
[0m15:53:05.013019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:05.073468 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m15:53:05.073960 [debug] [MainThread]: On master: COMMIT
[0m15:53:05.074238 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:05.074490 [debug] [MainThread]: On master: COMMIT
[0m15:53:05.077000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:53:05.077419 [debug] [MainThread]: On master: Close
[0m15:53:05.078522 [info ] [MainThread]: 
[0m15:53:05.079198 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m15:53:05.079881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:05.080177 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:53:05.091883 [info ] [MainThread]: 
[0m15:53:05.092567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:05.093152 [info ] [MainThread]: 
[0m15:53:05.093707 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:53:05.094341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec39c8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec39c82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec39c8fa0>]}
[0m15:53:05.094845 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:55:07.430350 | 016d9bdf-c090-40d2-9411-e7b29a486aa0 ==============================
[0m15:55:07.430382 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:55:07.431519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:55:07.432016 [debug] [MainThread]: Tracking: tracking
[0m15:55:07.435184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3d2cf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3d2cf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3d2ccc40>]}
[0m15:55:07.574633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:07.575380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:07.595906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '016d9bdf-c090-40d2-9411-e7b29a486aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c8e2560>]}
[0m15:55:07.618574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '016d9bdf-c090-40d2-9411-e7b29a486aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c8b3be0>]}
[0m15:55:07.619573 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:55:07.620518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '016d9bdf-c090-40d2-9411-e7b29a486aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c8b3c10>]}
[0m15:55:07.623827 [info ] [MainThread]: 
[0m15:55:07.625805 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:55:07.628223 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:55:07.710405 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:55:07.711110 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:55:07.711597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:07.734530 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m15:55:07.736916 [debug] [ThreadPool]: On list_test: Close
[0m15:55:07.739922 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m15:55:07.754509 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m15:55:07.754946 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m15:55:07.755249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:07.861543 [debug] [ThreadPool]: SQL status: BEGIN in 0.11 seconds
[0m15:55:07.862026 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m15:55:07.862302 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:55:07.871662 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m15:55:07.873963 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m15:55:07.877448 [debug] [ThreadPool]: On list_test_public: Close
[0m15:55:07.886068 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:07.886474 [debug] [MainThread]: On master: BEGIN
[0m15:55:07.886744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:07.901307 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m15:55:07.901777 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:07.902043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:07.924353 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m15:55:07.926694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '016d9bdf-c090-40d2-9411-e7b29a486aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c8cfdc0>]}
[0m15:55:07.927266 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:07.929593 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:07.929962 [debug] [MainThread]: On master: BEGIN
[0m15:55:07.933951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:07.934401 [debug] [MainThread]: On master: COMMIT
[0m15:55:07.934712 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:07.934992 [debug] [MainThread]: On master: COMMIT
[0m15:55:07.936808 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:55:07.937233 [debug] [MainThread]: On master: Close
[0m15:55:07.938271 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m15:55:07.938888 [info ] [MainThread]: 
[0m15:55:07.944058 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:55:07.945139 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:55:07.946789 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:07.947297 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:55:07.947799 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:55:07.954512 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:07.955254 [debug] [Thread-1 (]: finished collecting timing info
[0m15:55:07.955659 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:55:08.058496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.059773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.060340 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:55:08.060814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:08.125597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m15:55:08.126462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.127070 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:55:08.135254 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m15:55:08.160089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.160839 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:55:08.205781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m15:55:08.216655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.217469 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:55:08.221213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:08.311187 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:55:08.311994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.312526 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:55:08.318507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:55:08.330036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:55:08.330496 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:55:08.377566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m15:55:08.380292 [debug] [Thread-1 (]: finished collecting timing info
[0m15:55:08.380779 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:55:08.382082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '016d9bdf-c090-40d2-9411-e7b29a486aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c9280d0>]}
[0m15:55:08.382850 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.44s]
[0m15:55:08.383813 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:55:08.385253 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:55:08.386150 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:55:08.388382 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.389120 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:55:08.389737 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:55:08.399101 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.400497 [debug] [Thread-1 (]: finished collecting timing info
[0m15:55:08.401344 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:55:08.473455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.474723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.475338 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:55:08.475864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:08.532595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m15:55:08.533363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.533892 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:55:08.538489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:55:08.544077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.544484 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:55:08.547803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:08.551154 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:55:08.551512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.551820 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:55:08.557098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:55:08.561189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:55:08.561587 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:55:08.564047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:55:08.566290 [debug] [Thread-1 (]: finished collecting timing info
[0m15:55:08.566792 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:55:08.568120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '016d9bdf-c090-40d2-9411-e7b29a486aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c7cbac0>]}
[0m15:55:08.569187 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.18s]
[0m15:55:08.570334 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:55:08.572809 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:55:08.573583 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:08.574095 [debug] [MainThread]: On master: BEGIN
[0m15:55:08.574457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:08.637616 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m15:55:08.638395 [debug] [MainThread]: On master: COMMIT
[0m15:55:08.638866 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:08.639320 [debug] [MainThread]: On master: COMMIT
[0m15:55:08.642946 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:55:08.643642 [debug] [MainThread]: On master: Close
[0m15:55:08.645202 [info ] [MainThread]: 
[0m15:55:08.646160 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:55:08.646980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:08.647439 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:55:08.667892 [info ] [MainThread]: 
[0m15:55:08.668673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:08.669757 [info ] [MainThread]: 
[0m15:55:08.670610 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:55:08.671741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c7d0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c7d0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c7d09d0>]}
[0m15:55:08.672567 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 15:56:07.472167 | cebc5977-fee1-45f9-9f31-0a9c33686276 ==============================
[0m15:56:07.472188 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:56:07.472874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:56:07.473176 [debug] [MainThread]: Tracking: tracking
[0m15:56:07.475316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d74cb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d74cb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d74c8c40>]}
[0m15:56:07.558424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:07.558847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:07.570279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cebc5977-fee1-45f9-9f31-0a9c33686276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d6a1e560>]}
[0m15:56:07.582111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cebc5977-fee1-45f9-9f31-0a9c33686276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d69f3be0>]}
[0m15:56:07.582681 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:56:07.583208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cebc5977-fee1-45f9-9f31-0a9c33686276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d69f3c10>]}
[0m15:56:07.585187 [info ] [MainThread]: 
[0m15:56:07.586360 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:56:07.588143 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m15:56:07.663731 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m15:56:07.664462 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m15:56:07.664817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:07.693605 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
[0m15:56:07.696016 [debug] [ThreadPool]: On list_test: Close
[0m15:56:07.698778 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m15:56:07.710770 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m15:56:07.711191 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m15:56:07.711475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:07.724893 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m15:56:07.725418 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m15:56:07.725740 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:56:07.733175 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m15:56:07.736768 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m15:56:07.781458 [debug] [ThreadPool]: On list_test_public: Close
[0m15:56:07.790114 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.790515 [debug] [MainThread]: On master: BEGIN
[0m15:56:07.790788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:07.804317 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m15:56:07.804770 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.805067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:07.827710 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m15:56:07.829859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cebc5977-fee1-45f9-9f31-0a9c33686276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d6a07dc0>]}
[0m15:56:07.830406 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:07.832270 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.832622 [debug] [MainThread]: On master: BEGIN
[0m15:56:07.835467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:56:07.835802 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.836052 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.836289 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.837974 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:56:07.838364 [debug] [MainThread]: On master: Close
[0m15:56:07.839262 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m15:56:07.839809 [info ] [MainThread]: 
[0m15:56:07.844178 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m15:56:07.845108 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:56:07.846996 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:07.847584 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m15:56:07.848095 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m15:56:07.855664 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:07.857026 [debug] [Thread-1 (]: finished collecting timing info
[0m15:56:07.857879 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m15:56:07.949180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:07.949984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:07.950327 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m15:56:07.950587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:08.052151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m15:56:08.052654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:08.052990 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:56:08.058145 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:56:08.073860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:08.074331 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:56:08.078305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:56:08.083787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:08.084217 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:56:08.088156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:56:08.140072 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:56:08.140579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:08.140931 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m15:56:08.147771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:56:08.158961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m15:56:08.159435 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:56:08.205861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m15:56:08.209153 [debug] [Thread-1 (]: finished collecting timing info
[0m15:56:08.209767 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m15:56:08.211431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cebc5977-fee1-45f9-9f31-0a9c33686276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d6a640d0>]}
[0m15:56:08.212439 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.37s]
[0m15:56:08.213685 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m15:56:08.215580 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m15:56:08.216719 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:56:08.219152 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.219888 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m15:56:08.220551 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m15:56:08.231109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.232637 [debug] [Thread-1 (]: finished collecting timing info
[0m15:56:08.233659 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m15:56:08.309530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.310796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.311396 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m15:56:08.311884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:08.328222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:56:08.328787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.329156 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:56:08.339404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:56:08.345133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.345559 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:56:08.349067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:56:08.353010 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:56:08.353466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.353816 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m15:56:08.360067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m15:56:08.364779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m15:56:08.365262 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:56:08.409655 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m15:56:08.412346 [debug] [Thread-1 (]: finished collecting timing info
[0m15:56:08.412843 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m15:56:08.414266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cebc5977-fee1-45f9-9f31-0a9c33686276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d690bac0>]}
[0m15:56:08.415432 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:56:08.416846 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m15:56:08.419265 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:56:08.419809 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:08.420180 [debug] [MainThread]: On master: BEGIN
[0m15:56:08.420570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:08.481426 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m15:56:08.482035 [debug] [MainThread]: On master: COMMIT
[0m15:56:08.482376 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:08.482687 [debug] [MainThread]: On master: COMMIT
[0m15:56:08.485186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:56:08.485682 [debug] [MainThread]: On master: Close
[0m15:56:08.486980 [info ] [MainThread]: 
[0m15:56:08.487711 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m15:56:08.488282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:08.488572 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m15:56:08.504219 [info ] [MainThread]: 
[0m15:56:08.505320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:08.506104 [info ] [MainThread]: 
[0m15:56:08.506640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:56:08.507332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d6910f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d6910460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d69137f0>]}
[0m15:56:08.507891 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 16:27:57.577411 | fb86cb89-690a-4ebe-9e63-f7864105797e ==============================
[0m16:27:57.577432 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:27:57.578129 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:27:57.578478 [debug] [MainThread]: Tracking: tracking
[0m16:27:57.580647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8dedb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8dedb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8ded8c40>]}
[0m16:27:57.666329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:57.666832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:57.678635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb86cb89-690a-4ebe-9e63-f7864105797e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d436560>]}
[0m16:27:57.690466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb86cb89-690a-4ebe-9e63-f7864105797e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d407be0>]}
[0m16:27:57.691014 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:27:57.691536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb86cb89-690a-4ebe-9e63-f7864105797e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d407c10>]}
[0m16:27:57.693574 [info ] [MainThread]: 
[0m16:27:57.694739 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:27:57.696616 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:27:57.774287 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:27:57.774767 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:27:57.775100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:57.791300 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:27:57.793698 [debug] [ThreadPool]: On list_test: Close
[0m16:27:57.796657 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:27:57.808694 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:27:57.809139 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:27:57.809423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:57.823041 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:27:57.823493 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:27:57.823773 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:27:57.829661 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:27:57.831861 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:27:57.833571 [debug] [ThreadPool]: On list_test_public: Close
[0m16:27:57.842901 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:57.843296 [debug] [MainThread]: On master: BEGIN
[0m16:27:57.843566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:57.862165 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:27:57.862699 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:57.862991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:57.885441 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:27:57.887535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb86cb89-690a-4ebe-9e63-f7864105797e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d423dc0>]}
[0m16:27:57.888089 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:57.889980 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:57.890371 [debug] [MainThread]: On master: BEGIN
[0m16:27:57.894126 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:27:57.894546 [debug] [MainThread]: On master: COMMIT
[0m16:27:57.894848 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:57.895126 [debug] [MainThread]: On master: COMMIT
[0m16:27:57.896811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:57.897176 [debug] [MainThread]: On master: Close
[0m16:27:57.898120 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:27:57.898659 [info ] [MainThread]: 
[0m16:27:57.903436 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:27:57.904309 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:27:57.905685 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:57.906092 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:27:57.906417 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:27:57.911696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:57.912482 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:57.912870 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:27:58.003396 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.004381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.004973 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:27:58.005460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:58.020934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:27:58.021457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.021748 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:27:58.025864 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:27:58.040184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.040571 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:27:58.044488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:27:58.049266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.049619 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:27:58.052002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:27:58.094039 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:27:58.094419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.094685 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:27:58.101556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:27:58.110479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:27:58.110858 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:27:58.157689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:27:58.160150 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:58.160577 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:27:58.161792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb86cb89-690a-4ebe-9e63-f7864105797e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d47c0d0>]}
[0m16:27:58.162724 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m16:27:58.164006 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:27:58.165302 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:27:58.166214 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:27:58.167964 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.168516 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:27:58.168969 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:27:58.175502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.176249 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:58.176634 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:27:58.223030 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.224897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.225433 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:27:58.225798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:58.285700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:27:58.286449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.286895 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:27:58.329658 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.04 seconds
[0m16:27:58.335175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.335572 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:27:58.338210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:27:58.341410 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:27:58.341761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.342025 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:27:58.351932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:27:58.355634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:27:58.355969 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:27:58.401623 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:27:58.403900 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:58.404320 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:27:58.405414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb86cb89-690a-4ebe-9e63-f7864105797e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d47c0d0>]}
[0m16:27:58.406111 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.24s]
[0m16:27:58.406938 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:27:58.409478 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:27:58.410130 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:58.410647 [debug] [MainThread]: On master: BEGIN
[0m16:27:58.411122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:58.469785 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:27:58.470539 [debug] [MainThread]: On master: COMMIT
[0m16:27:58.470849 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:58.471118 [debug] [MainThread]: On master: COMMIT
[0m16:27:58.473671 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:58.474332 [debug] [MainThread]: On master: Close
[0m16:27:58.475879 [info ] [MainThread]: 
[0m16:27:58.476882 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m16:27:58.477814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:58.478275 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:27:58.500076 [info ] [MainThread]: 
[0m16:27:58.501386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:58.502394 [info ] [MainThread]: 
[0m16:27:58.503174 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:27:58.504265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d3250c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d324460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8d324910>]}
[0m16:27:58.505018 [debug] [MainThread]: Flushing usage events
[0m16:28:16.271842 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-12-21 16:29:30.995803 | 2d2fe331-55db-4b77-a533-0ce595ec99d1 ==============================
[0m16:29:30.995838 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:29:30.997015 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:29:30.997533 [debug] [MainThread]: Tracking: tracking
[0m16:29:31.001585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5fcf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5fcf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5fccc40>]}
[0m16:29:31.145567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:31.146322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:31.164513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d2fe331-55db-4b77-a533-0ce595ec99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff553e560>]}
[0m16:29:31.186115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d2fe331-55db-4b77-a533-0ce595ec99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5513be0>]}
[0m16:29:31.187082 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:29:31.188004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d2fe331-55db-4b77-a533-0ce595ec99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5513c10>]}
[0m16:29:31.191226 [info ] [MainThread]: 
[0m16:29:31.193176 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:29:31.195626 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:29:31.276859 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:29:31.277390 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:29:31.277710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:31.302480 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:29:31.306364 [debug] [ThreadPool]: On list_test: Close
[0m16:29:31.309859 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:29:31.322150 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:29:31.322592 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:29:31.322897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:31.381558 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:29:31.382023 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:29:31.382300 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:29:31.391745 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:29:31.394021 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:29:31.396278 [debug] [ThreadPool]: On list_test_public: Close
[0m16:29:31.409306 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:31.409939 [debug] [MainThread]: On master: BEGIN
[0m16:29:31.410367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:31.465478 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:29:31.466256 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:31.466763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:31.492293 [debug] [MainThread]: SQL status: SELECT 3 in 0.03 seconds
[0m16:29:31.496150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d2fe331-55db-4b77-a533-0ce595ec99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff552bdc0>]}
[0m16:29:31.497128 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:31.501658 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:31.502329 [debug] [MainThread]: On master: BEGIN
[0m16:29:31.549510 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:29:31.550086 [debug] [MainThread]: On master: COMMIT
[0m16:29:31.550423 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:31.550718 [debug] [MainThread]: On master: COMMIT
[0m16:29:31.553599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:31.554119 [debug] [MainThread]: On master: Close
[0m16:29:31.555262 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:29:31.555935 [info ] [MainThread]: 
[0m16:29:31.561389 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:31.562254 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:29:31.563832 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.564355 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:31.564701 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:29:31.570561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.571367 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:31.571775 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:31.666781 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.667626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.667970 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:29:31.668311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:31.729500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:29:31.729988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.730280 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:29:31.735341 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:29:31.749314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.749757 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:29:31.752628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:29:31.757706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.758076 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:29:31.762237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:29:31.829677 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:29:31.830394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.830902 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:29:31.836385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:29:31.849707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:31.850332 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:29:31.897570 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:29:31.901581 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:31.902332 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:29:31.904148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2fe331-55db-4b77-a533-0ce595ec99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff55840d0>]}
[0m16:29:31.905327 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.34s]
[0m16:29:31.906794 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:31.908570 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:31.909440 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:29:31.911421 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:31.912027 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:31.912559 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:29:31.921794 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:31.923027 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:31.923794 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:32.005068 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:32.006953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:32.007857 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:29:32.008475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:32.069583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:29:32.070411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:32.071079 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:29:32.078669 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:29:32.084565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:32.085073 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:29:32.089007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:29:32.092845 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:29:32.093285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:32.093621 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:29:32.099444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:29:32.103959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:32.104381 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:29:32.149497 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m16:29:32.153438 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:32.154231 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:29:32.156037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2fe331-55db-4b77-a533-0ce595ec99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff542bac0>]}
[0m16:29:32.157183 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:29:32.158565 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:32.161319 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:29:32.162010 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:32.162563 [debug] [MainThread]: On master: BEGIN
[0m16:29:32.163048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:32.225529 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:29:32.226121 [debug] [MainThread]: On master: COMMIT
[0m16:29:32.226460 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:32.226763 [debug] [MainThread]: On master: COMMIT
[0m16:29:32.229449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:32.229999 [debug] [MainThread]: On master: Close
[0m16:29:32.231424 [info ] [MainThread]: 
[0m16:29:32.232429 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m16:29:32.233365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:32.233832 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:29:32.252864 [info ] [MainThread]: 
[0m16:29:32.253762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:32.254640 [info ] [MainThread]: 
[0m16:29:32.255502 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:29:32.256521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5430490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5430dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff5430370>]}
[0m16:29:32.257167 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:05:09.542195 | bd7459c4-eb65-4d17-a38f-41a5c130ac9c ==============================
[0m16:05:09.542218 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:05:09.543390 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:05:09.543733 [debug] [MainThread]: Tracking: tracking
[0m16:05:09.546854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1eced7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1eced4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1eced4bb0>]}
[0m16:05:09.671578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:09.671984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:09.682814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd7459c4-eb65-4d17-a38f-41a5c130ac9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec4ce500>]}
[0m16:05:09.694558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd7459c4-eb65-4d17-a38f-41a5c130ac9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec4a3b80>]}
[0m16:05:09.695142 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:05:09.695683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7459c4-eb65-4d17-a38f-41a5c130ac9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec4a3bb0>]}
[0m16:05:09.697666 [info ] [MainThread]: 
[0m16:05:09.699074 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:05:09.700822 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:05:09.783873 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:05:09.784429 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:05:09.784781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:09.805105 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:05:09.808986 [debug] [ThreadPool]: On list_test: Close
[0m16:05:09.812142 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:05:09.824458 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:05:09.824890 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:05:09.825189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:09.839398 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:05:09.839946 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:05:09.840403 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:05:09.848081 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:05:09.850510 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:05:09.852747 [debug] [ThreadPool]: On list_test_public: Close
[0m16:05:09.862204 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:09.862662 [debug] [MainThread]: On master: BEGIN
[0m16:05:09.862964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:09.880675 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:05:09.881418 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:09.881927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:09.911196 [debug] [MainThread]: SQL status: SELECT 3 in 0.03 seconds
[0m16:05:09.915015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7459c4-eb65-4d17-a38f-41a5c130ac9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec4bbc70>]}
[0m16:05:09.915985 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:09.918582 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:09.919014 [debug] [MainThread]: On master: BEGIN
[0m16:05:09.967804 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:05:09.968268 [debug] [MainThread]: On master: COMMIT
[0m16:05:09.968533 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:09.968790 [debug] [MainThread]: On master: COMMIT
[0m16:05:09.971267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:09.971740 [debug] [MainThread]: On master: Close
[0m16:05:09.972735 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:05:09.973305 [info ] [MainThread]: 
[0m16:05:09.980156 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:05:09.981279 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:05:09.983204 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:09.983795 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:05:09.984291 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:05:09.992539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:09.993417 [debug] [Thread-1 (]: finished collecting timing info
[0m16:05:09.993964 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:05:10.084400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.085284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.085660 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:05:10.085927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.101391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:05:10.101867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.102151 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:05:10.112229 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:05:10.125482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.125878 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:05:10.128935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:10.133486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.133808 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:05:10.136157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:10.178409 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:05:10.178838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.179102 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:05:10.184635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:05:10.193867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:05:10.194245 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:05:10.239879 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:05:10.242085 [debug] [Thread-1 (]: finished collecting timing info
[0m16:05:10.242521 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:05:10.243811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7459c4-eb65-4d17-a38f-41a5c130ac9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec5140d0>]}
[0m16:05:10.244770 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m16:05:10.246020 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:05:10.247407 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:05:10.248336 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:05:10.249987 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.250505 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:05:10.250880 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:05:10.256840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.257606 [debug] [Thread-1 (]: finished collecting timing info
[0m16:05:10.258155 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:05:10.299653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.300439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.300828 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:05:10.301110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.363849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:05:10.364317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.364579 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:05:10.370699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:05:10.375830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.376201 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:05:10.379129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:10.382495 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:05:10.382857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.383125 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:05:10.388755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:05:10.392662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:05:10.393018 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:05:10.439948 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:05:10.442249 [debug] [Thread-1 (]: finished collecting timing info
[0m16:05:10.442721 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:05:10.443959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7459c4-eb65-4d17-a38f-41a5c130ac9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec5140d0>]}
[0m16:05:10.444649 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.19s]
[0m16:05:10.445452 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:05:10.448185 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:05:10.448873 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:10.449401 [debug] [MainThread]: On master: BEGIN
[0m16:05:10.449882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:10.511900 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:05:10.512435 [debug] [MainThread]: On master: COMMIT
[0m16:05:10.512754 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:10.513025 [debug] [MainThread]: On master: COMMIT
[0m16:05:10.515437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:10.515845 [debug] [MainThread]: On master: Close
[0m16:05:10.517013 [info ] [MainThread]: 
[0m16:05:10.517684 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m16:05:10.518412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:10.518693 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:05:10.532785 [info ] [MainThread]: 
[0m16:05:10.533607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:10.534522 [info ] [MainThread]: 
[0m16:05:10.535276 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:05:10.536131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec3b9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec3b8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ec3babc0>]}
[0m16:05:10.536693 [debug] [MainThread]: Flushing usage events
[0m16:05:30.562711 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:08:31.665496 | 93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71 ==============================
[0m16:08:31.665517 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:08:31.666234 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:08:31.666542 [debug] [MainThread]: Tracking: tracking
[0m16:08:31.668534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8008e7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8008e77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8008e7df0>]}
[0m16:08:31.760841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:31.761299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:31.772512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffee6530>]}
[0m16:08:31.785577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffebbbb0>]}
[0m16:08:31.786369 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:08:31.787042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffebbbe0>]}
[0m16:08:31.789310 [info ] [MainThread]: 
[0m16:08:31.790691 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:08:31.792531 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:08:31.865078 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:08:31.865588 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:08:31.865877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:31.883817 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:08:31.887744 [debug] [ThreadPool]: On list_test: Close
[0m16:08:31.891278 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:08:31.903736 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:08:31.904162 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:08:31.904467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:31.960245 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:08:31.960700 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:08:31.960958 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:08:31.967856 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:08:31.970257 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:08:31.973369 [debug] [ThreadPool]: On list_test_public: Close
[0m16:08:31.983638 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:31.984055 [debug] [MainThread]: On master: BEGIN
[0m16:08:31.984340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:32.040130 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:08:32.040616 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:32.040928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:08:32.063762 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:08:32.066024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffed3ca0>]}
[0m16:08:32.066581 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:32.068554 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:32.068901 [debug] [MainThread]: On master: BEGIN
[0m16:08:32.074818 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:08:32.075203 [debug] [MainThread]: On master: COMMIT
[0m16:08:32.075460 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:32.075707 [debug] [MainThread]: On master: COMMIT
[0m16:08:32.077729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:08:32.078099 [debug] [MainThread]: On master: Close
[0m16:08:32.079331 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:08:32.079898 [info ] [MainThread]: 
[0m16:08:32.084544 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:08:32.085362 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:08:32.086665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.087088 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:08:32.087404 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:08:32.092637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.093604 [debug] [Thread-1 (]: finished collecting timing info
[0m16:08:32.094157 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:08:32.179861 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.180686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.181027 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:08:32.181290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:32.196122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m16:08:32.196590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.196873 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:08:32.201073 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:08:32.215318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.215784 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:08:32.220243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:08:32.226923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.227434 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:08:32.272352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:08:32.317628 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:08:32.318004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.318266 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:08:32.325120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:08:32.335214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:08:32.335602 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:08:32.380417 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:08:32.382776 [debug] [Thread-1 (]: finished collecting timing info
[0m16:08:32.383171 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:08:32.384556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fff2c0d0>]}
[0m16:08:32.385304 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.30s]
[0m16:08:32.386194 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:08:32.387184 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:08:32.388107 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:08:32.389679 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.390260 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:08:32.390768 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:08:32.398893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.399848 [debug] [Thread-1 (]: finished collecting timing info
[0m16:08:32.400370 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:08:32.455144 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.456106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.456565 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:08:32.456955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:32.472640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:08:32.473400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.473886 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:08:32.483623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:08:32.492084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.492626 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:08:32.496342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:08:32.500510 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:08:32.500902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.501171 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:08:32.506356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:08:32.510333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:08:32.510875 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:08:32.513864 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:08:32.516077 [debug] [Thread-1 (]: finished collecting timing info
[0m16:08:32.516487 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:08:32.517632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93def3b0-5cf9-4bb5-84eb-cb9a94a7ab71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffdcba90>]}
[0m16:08:32.518373 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:08:32.519221 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:08:32.521659 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:08:32.522118 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:32.522552 [debug] [MainThread]: On master: BEGIN
[0m16:08:32.522919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:32.538458 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:08:32.538993 [debug] [MainThread]: On master: COMMIT
[0m16:08:32.539313 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:32.539593 [debug] [MainThread]: On master: COMMIT
[0m16:08:32.541292 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:08:32.541774 [debug] [MainThread]: On master: Close
[0m16:08:32.543018 [info ] [MainThread]: 
[0m16:08:32.543769 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m16:08:32.544602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:32.545044 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:08:32.559605 [info ] [MainThread]: 
[0m16:08:32.560312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:32.561044 [info ] [MainThread]: 
[0m16:08:32.561783 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:08:32.562652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffdd0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffdd0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ffdd1480>]}
[0m16:08:32.563329 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:09:50.265260 | ef3719d3-d2a7-4118-af0a-a0b26ee17964 ==============================
[0m16:09:50.265288 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:09:50.266346 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:09:50.266829 [debug] [MainThread]: Tracking: tracking
[0m16:09:50.269665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586f4d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586f4d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586f4d7fa0>]}
[0m16:09:50.370320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:50.370776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:50.384530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef3719d3-d2a7-4118-af0a-a0b26ee17964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586ea324a0>]}
[0m16:09:50.399988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef3719d3-d2a7-4118-af0a-a0b26ee17964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586ea07b20>]}
[0m16:09:50.400799 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:09:50.401436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3719d3-d2a7-4118-af0a-a0b26ee17964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586ea07b50>]}
[0m16:09:50.403687 [info ] [MainThread]: 
[0m16:09:50.405177 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:09:50.407027 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:09:50.487586 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:09:50.488221 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:09:50.488571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:50.555825 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m16:09:50.559734 [debug] [ThreadPool]: On list_test: Close
[0m16:09:50.562975 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:09:50.575207 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:09:50.575628 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:09:50.575975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:50.632186 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:09:50.632641 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:09:50.632904 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:09:50.644005 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:09:50.646406 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:09:50.648692 [debug] [ThreadPool]: On list_test_public: Close
[0m16:09:50.657881 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.658332 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.658697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:50.673773 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:09:50.674495 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.675013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:50.724946 [debug] [MainThread]: SQL status: SELECT 3 in 0.05 seconds
[0m16:09:50.728093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3719d3-d2a7-4118-af0a-a0b26ee17964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586ea1fe20>]}
[0m16:09:50.728763 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:50.731422 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.731837 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.735853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:50.736688 [debug] [MainThread]: On master: COMMIT
[0m16:09:50.737392 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.738014 [debug] [MainThread]: On master: COMMIT
[0m16:09:50.740262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:50.741069 [debug] [MainThread]: On master: Close
[0m16:09:50.743492 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:09:50.744843 [info ] [MainThread]: 
[0m16:09:50.753216 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:09:50.754485 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:09:50.756558 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.757149 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:09:50.757678 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:09:50.766317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.767395 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:50.768047 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:09:50.901259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.902322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.902850 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:09:50.903309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:50.960306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:09:50.961041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.961545 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:09:50.967714 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:09:50.982150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.982589 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:09:50.985445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:50.990153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:50.990555 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:09:50.993121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:51.059633 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:09:51.060091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:51.060354 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:09:51.067562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:09:51.076768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:09:51.077151 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:09:51.124263 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:09:51.126605 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:51.127031 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:09:51.128256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3719d3-d2a7-4118-af0a-a0b26ee17964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586ea780d0>]}
[0m16:09:51.128962 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.37s]
[0m16:09:51.129795 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:09:51.131081 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:09:51.131584 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:09:51.133001 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.133515 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:09:51.134013 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:09:51.142339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.143401 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:51.144084 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:09:51.200993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.201926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.202318 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:09:51.202616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:51.219049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:09:51.219585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.219957 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:09:51.225510 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:09:51.234737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.235461 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:09:51.238935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:51.244881 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:09:51.245493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.245953 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:09:51.251754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:09:51.258960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:09:51.259650 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:09:51.262878 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:51.265994 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:51.266453 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:09:51.267928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3719d3-d2a7-4118-af0a-a0b26ee17964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586e917a00>]}
[0m16:09:51.269017 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.14s]
[0m16:09:51.270487 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:09:51.273881 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:09:51.274650 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.275185 [debug] [MainThread]: On master: BEGIN
[0m16:09:51.275644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:51.297660 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:09:51.298437 [debug] [MainThread]: On master: COMMIT
[0m16:09:51.298949 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.299422 [debug] [MainThread]: On master: COMMIT
[0m16:09:51.301875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:51.302602 [debug] [MainThread]: On master: Close
[0m16:09:51.304304 [info ] [MainThread]: 
[0m16:09:51.305359 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m16:09:51.306238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:51.306725 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:09:51.325041 [info ] [MainThread]: 
[0m16:09:51.326112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:51.327080 [info ] [MainThread]: 
[0m16:09:51.327873 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:09:51.328858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586e91c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586e91c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586e91d6f0>]}
[0m16:09:51.329481 [debug] [MainThread]: Flushing usage events
[0m16:10:04.920882 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:16:32.536974 | 33b83a99-0b46-43f9-9d06-88c4599aa9aa ==============================
[0m16:16:32.536999 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:16:32.537761 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:16:32.538077 [debug] [MainThread]: Tracking: tracking
[0m16:16:32.540376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080f3db670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080f3dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080f3dbfd0>]}
[0m16:16:32.627745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:32.628186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:32.639566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33b83a99-0b46-43f9-9d06-88c4599aa9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e9b64d0>]}
[0m16:16:32.652081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33b83a99-0b46-43f9-9d06-88c4599aa9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e98bb50>]}
[0m16:16:32.652679 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:16:32.653224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b83a99-0b46-43f9-9d06-88c4599aa9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e98bb80>]}
[0m16:16:32.655425 [info ] [MainThread]: 
[0m16:16:32.656624 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:16:32.658513 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:16:32.730084 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:16:32.730561 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:16:32.730877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:32.746461 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:16:32.748861 [debug] [ThreadPool]: On list_test: Close
[0m16:16:32.751721 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:16:32.763407 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:16:32.763840 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:16:32.764123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:32.819630 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:16:32.820096 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:16:32.820388 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:16:32.826921 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:16:32.829333 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:16:32.831412 [debug] [ThreadPool]: On list_test_public: Close
[0m16:16:32.844024 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:32.844628 [debug] [MainThread]: On master: BEGIN
[0m16:16:32.845048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:32.903683 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:16:32.904164 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:32.904450 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:16:32.947540 [debug] [MainThread]: SQL status: SELECT 3 in 0.04 seconds
[0m16:16:32.949785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b83a99-0b46-43f9-9d06-88c4599aa9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e9a3df0>]}
[0m16:16:32.950377 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:32.952363 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:32.952711 [debug] [MainThread]: On master: BEGIN
[0m16:16:32.955828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:16:32.956248 [debug] [MainThread]: On master: COMMIT
[0m16:16:32.956532 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:32.956792 [debug] [MainThread]: On master: COMMIT
[0m16:16:32.958506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:16:32.958903 [debug] [MainThread]: On master: Close
[0m16:16:32.959994 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:16:32.960687 [info ] [MainThread]: 
[0m16:16:32.966845 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:16:32.967846 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:16:32.969138 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:32.969535 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:16:32.969858 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:16:32.975349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:32.976312 [debug] [Thread-1 (]: finished collecting timing info
[0m16:16:32.976900 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:16:33.074914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.075762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.076104 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:16:33.076371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:33.131701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:16:33.132421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.132923 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:16:33.139132 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:16:33.152140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.152527 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:16:33.155607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:16:33.163190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.163670 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:16:33.166445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:16:33.207968 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:16:33.208413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.208712 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:16:33.215054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:16:33.224370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:16:33.224769 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:16:33.271706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:16:33.274732 [debug] [Thread-1 (]: finished collecting timing info
[0m16:16:33.275304 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:16:33.276662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b83a99-0b46-43f9-9d06-88c4599aa9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e9fc0d0>]}
[0m16:16:33.277531 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.31s]
[0m16:16:33.278593 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:16:33.279968 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:16:33.280534 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:16:33.281916 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.282345 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:16:33.282650 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:16:33.288429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.289420 [debug] [Thread-1 (]: finished collecting timing info
[0m16:16:33.289980 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:16:33.337853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.339086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.339680 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:16:33.340134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:33.403911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:16:33.404647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.405108 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:16:33.411100 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:16:33.416216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.416584 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:16:33.420117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:16:33.423590 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:16:33.423956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.424222 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:16:33.429836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:16:33.433653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:16:33.434016 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:16:33.479692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:16:33.481766 [debug] [Thread-1 (]: finished collecting timing info
[0m16:16:33.482153 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:16:33.483178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b83a99-0b46-43f9-9d06-88c4599aa9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e89ba30>]}
[0m16:16:33.483886 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.20s]
[0m16:16:33.484749 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:16:33.487306 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:16:33.487962 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:33.488466 [debug] [MainThread]: On master: BEGIN
[0m16:16:33.488943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:33.505203 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:16:33.505801 [debug] [MainThread]: On master: COMMIT
[0m16:16:33.506146 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:33.506431 [debug] [MainThread]: On master: COMMIT
[0m16:16:33.508214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:16:33.508687 [debug] [MainThread]: On master: Close
[0m16:16:33.510047 [info ] [MainThread]: 
[0m16:16:33.511015 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m16:16:33.511880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:33.512298 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:16:33.529183 [info ] [MainThread]: 
[0m16:16:33.529895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:33.530511 [info ] [MainThread]: 
[0m16:16:33.530999 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:16:33.531723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e8a0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e8a0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080e8a1b40>]}
[0m16:16:33.532327 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:17:41.610415 | 6a41254d-eb09-4a64-ba57-41b97b2c2c62 ==============================
[0m16:17:41.610435 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:17:41.611086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:17:41.611372 [debug] [MainThread]: Tracking: tracking
[0m16:17:41.613464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef274e7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef274e4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef274e4bb0>]}
[0m16:17:41.694395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:41.694830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:41.706415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a41254d-eb09-4a64-ba57-41b97b2c2c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef26a06500>]}
[0m16:17:41.718956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a41254d-eb09-4a64-ba57-41b97b2c2c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef269dbb80>]}
[0m16:17:41.719643 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:17:41.720155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a41254d-eb09-4a64-ba57-41b97b2c2c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef269dbbb0>]}
[0m16:17:41.722096 [info ] [MainThread]: 
[0m16:17:41.723287 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:17:41.725113 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:17:41.803580 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:17:41.804083 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:17:41.804389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:41.822064 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:17:41.824413 [debug] [ThreadPool]: On list_test: Close
[0m16:17:41.827191 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:17:41.839687 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:17:41.840107 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:17:41.840398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:41.854186 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:17:41.854636 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:17:41.854913 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:17:41.860985 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:17:41.863346 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:17:41.865144 [debug] [ThreadPool]: On list_test_public: Close
[0m16:17:41.874150 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:41.874557 [debug] [MainThread]: On master: BEGIN
[0m16:17:41.874826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:41.887964 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:17:41.888376 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:41.888666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:41.911357 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:17:41.913647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a41254d-eb09-4a64-ba57-41b97b2c2c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef269f3c70>]}
[0m16:17:41.914226 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:41.916137 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:41.916488 [debug] [MainThread]: On master: BEGIN
[0m16:17:41.919497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:17:41.919852 [debug] [MainThread]: On master: COMMIT
[0m16:17:41.920134 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:41.920393 [debug] [MainThread]: On master: COMMIT
[0m16:17:41.921757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:17:41.922107 [debug] [MainThread]: On master: Close
[0m16:17:41.923052 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:17:41.923657 [info ] [MainThread]: 
[0m16:17:41.928232 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:41.929105 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:17:41.930775 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:41.931241 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:41.931604 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:17:41.937565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:41.938349 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:41.938732 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:42.022643 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.023458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.023798 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:17:42.024066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:42.079770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:17:42.080259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.080572 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:17:42.085648 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:17:42.099290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.099661 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:17:42.102817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:17:42.107679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.108087 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:17:42.110515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:17:42.154513 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:17:42.154897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.155186 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:17:42.161378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:17:42.171109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:42.171475 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:17:42.215663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:17:42.218093 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:42.218503 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:17:42.219785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a41254d-eb09-4a64-ba57-41b97b2c2c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef26a4c0d0>]}
[0m16:17:42.220601 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.29s]
[0m16:17:42.221428 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:42.222499 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:42.223057 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:17:42.224226 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.224661 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:42.225101 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:17:42.230486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.231286 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:42.231663 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:42.274421 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.275311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.275667 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:17:42.275942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:42.335648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:17:42.336182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.336502 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:17:42.341768 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:17:42.348350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.348916 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:17:42.352263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:17:42.355818 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:17:42.356190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.356457 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:17:42.361373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:17:42.365614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:42.366042 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:17:42.411664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:17:42.414138 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:42.414603 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:17:42.415789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a41254d-eb09-4a64-ba57-41b97b2c2c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef268eba60>]}
[0m16:17:42.416507 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.19s]
[0m16:17:42.417432 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:42.420043 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:17:42.420694 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:42.421178 [debug] [MainThread]: On master: BEGIN
[0m16:17:42.421621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:42.438868 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:17:42.439438 [debug] [MainThread]: On master: COMMIT
[0m16:17:42.439759 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:42.440073 [debug] [MainThread]: On master: COMMIT
[0m16:17:42.442982 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:17:42.443522 [debug] [MainThread]: On master: Close
[0m16:17:42.444679 [info ] [MainThread]: 
[0m16:17:42.445297 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m16:17:42.445879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:42.446342 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:17:42.461354 [info ] [MainThread]: 
[0m16:17:42.462070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:42.462672 [info ] [MainThread]: 
[0m16:17:42.463178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:17:42.463844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef268f00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef268f0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef268f3d00>]}
[0m16:17:42.464479 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:17:58.665854 | 769725dc-d62c-4370-b1ab-0a1c7360d881 ==============================
[0m16:17:58.665876 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:17:58.666565 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:17:58.666839 [debug] [MainThread]: Tracking: tracking
[0m16:17:58.669053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9bdeb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9bde8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9bde8bb0>]}
[0m16:17:58.755964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:58.756367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:58.766565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '769725dc-d62c-4370-b1ab-0a1c7360d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b38e500>]}
[0m16:17:58.778007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '769725dc-d62c-4370-b1ab-0a1c7360d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b363b80>]}
[0m16:17:58.778544 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:17:58.779042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769725dc-d62c-4370-b1ab-0a1c7360d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b363bb0>]}
[0m16:17:58.781063 [info ] [MainThread]: 
[0m16:17:58.782346 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:17:58.784344 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:17:58.855575 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:17:58.856295 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:17:58.856601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:58.876674 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:17:58.879050 [debug] [ThreadPool]: On list_test: Close
[0m16:17:58.881928 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:17:58.894319 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:17:58.894907 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:17:58.895217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:58.909610 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:17:58.910093 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:17:58.910391 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:17:58.916513 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:17:58.918913 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:17:58.921146 [debug] [ThreadPool]: On list_test_public: Close
[0m16:17:58.930028 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:58.930454 [debug] [MainThread]: On master: BEGIN
[0m16:17:58.930725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:58.943659 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:17:58.944152 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:58.944443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:58.968567 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:17:58.971094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769725dc-d62c-4370-b1ab-0a1c7360d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b37bc70>]}
[0m16:17:58.971662 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:58.974051 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:58.974433 [debug] [MainThread]: On master: BEGIN
[0m16:17:59.019675 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:17:59.020412 [debug] [MainThread]: On master: COMMIT
[0m16:17:59.020938 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:59.021399 [debug] [MainThread]: On master: COMMIT
[0m16:17:59.023844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:17:59.024314 [debug] [MainThread]: On master: Close
[0m16:17:59.025558 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:17:59.026491 [info ] [MainThread]: 
[0m16:17:59.032488 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:59.033582 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:17:59.035501 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.036425 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:59.036920 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:17:59.045363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.046398 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:59.046964 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:59.146612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.147556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.147979 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:17:59.148262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:59.203586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:17:59.204062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.204352 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:17:59.209141 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:17:59.222758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.223258 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:17:59.226160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:17:59.231003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.231359 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:17:59.233865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:17:59.277200 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:17:59.277625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.277916 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:17:59.283364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:17:59.293082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:17:59.293486 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:17:59.339750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:17:59.343357 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:59.343854 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:17:59.345235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '769725dc-d62c-4370-b1ab-0a1c7360d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b3d40d0>]}
[0m16:17:59.346084 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.31s]
[0m16:17:59.347161 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:17:59.348553 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:59.349079 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:17:59.350549 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.351019 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:59.351469 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:17:59.357209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.358310 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:59.358898 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:59.407174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.408320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.408685 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:17:59.408956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:59.427425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:17:59.427928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.428232 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:17:59.433756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:17:59.439431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.439828 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:17:59.442678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:17:59.446049 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:17:59.446468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.446839 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:17:59.453150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:17:59.457270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:17:59.457642 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:17:59.460043 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:17:59.462184 [debug] [Thread-1 (]: finished collecting timing info
[0m16:17:59.462758 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:17:59.464333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '769725dc-d62c-4370-b1ab-0a1c7360d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b277a60>]}
[0m16:17:59.465347 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m16:17:59.466608 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:17:59.469414 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:17:59.470072 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:59.470570 [debug] [MainThread]: On master: BEGIN
[0m16:17:59.471033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:59.490679 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:17:59.491497 [debug] [MainThread]: On master: COMMIT
[0m16:17:59.492029 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:59.492511 [debug] [MainThread]: On master: COMMIT
[0m16:17:59.494551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:17:59.495228 [debug] [MainThread]: On master: Close
[0m16:17:59.496853 [info ] [MainThread]: 
[0m16:17:59.497801 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m16:17:59.498674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:59.499165 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:17:59.521525 [info ] [MainThread]: 
[0m16:17:59.522566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:59.523562 [info ] [MainThread]: 
[0m16:17:59.524349 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:17:59.525314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b27cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b27c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9b27eb30>]}
[0m16:17:59.526047 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:19:09.530197 | cbc33cb9-fe3f-41db-9f63-40667e0b13e6 ==============================
[0m16:19:09.530219 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:19:09.530942 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:19:09.531395 [debug] [MainThread]: Tracking: tracking
[0m16:19:09.533372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c83eb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c83ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c83ebfd0>]}
[0m16:19:09.618963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:09.619465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:09.630742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc33cb9-fe3f-41db-9f63-40667e0b13e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c795a4d0>]}
[0m16:19:09.643036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc33cb9-fe3f-41db-9f63-40667e0b13e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c792fb50>]}
[0m16:19:09.643813 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:19:09.644359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc33cb9-fe3f-41db-9f63-40667e0b13e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c792fb80>]}
[0m16:19:09.646900 [info ] [MainThread]: 
[0m16:19:09.648179 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:09.650106 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:19:09.724298 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:19:09.724944 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:19:09.725362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:09.742351 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:19:09.744754 [debug] [ThreadPool]: On list_test: Close
[0m16:19:09.747803 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:19:09.760470 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:19:09.760955 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:19:09.761263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:09.775792 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:19:09.776556 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:19:09.777079 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:19:09.785419 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:19:09.789042 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:19:09.791125 [debug] [ThreadPool]: On list_test_public: Close
[0m16:19:09.801903 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:09.802299 [debug] [MainThread]: On master: BEGIN
[0m16:19:09.802564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:09.859697 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:19:09.860162 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:09.860461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:09.923848 [debug] [MainThread]: SQL status: SELECT 3 in 0.06 seconds
[0m16:19:09.926535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc33cb9-fe3f-41db-9f63-40667e0b13e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c7947df0>]}
[0m16:19:09.927216 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:09.930517 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:09.930946 [debug] [MainThread]: On master: BEGIN
[0m16:19:09.975832 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:19:09.976374 [debug] [MainThread]: On master: COMMIT
[0m16:19:09.976718 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:09.977023 [debug] [MainThread]: On master: COMMIT
[0m16:19:09.980453 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:09.980973 [debug] [MainThread]: On master: Close
[0m16:19:09.982200 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:19:09.982914 [info ] [MainThread]: 
[0m16:19:09.988859 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:19:09.990226 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:19:09.992568 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:09.993236 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:19:09.993834 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:19:10.002766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.003955 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:10.004613 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:19:10.108906 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.109846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.110279 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:19:10.110571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:10.127555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:19:10.128075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.128417 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:19:10.134821 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:19:10.151238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.151746 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:19:10.155462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:10.160922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.161373 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:19:10.164751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:10.216489 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:19:10.217223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.217754 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:19:10.223145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:19:10.234004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:19:10.234470 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:19:10.279871 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:19:10.283643 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:10.284301 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:19:10.285948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc33cb9-fe3f-41db-9f63-40667e0b13e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c79a00d0>]}
[0m16:19:10.287070 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.29s]
[0m16:19:10.288506 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:19:10.290191 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:19:10.291016 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:19:10.292887 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.293425 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:19:10.293950 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:19:10.302844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.304064 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:10.304723 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:19:10.354648 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.355725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.356140 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:19:10.356474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:10.372033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:19:10.372529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.372846 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:19:10.378732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:19:10.384012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.384405 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:19:10.386876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:10.390156 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:19:10.390523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.390793 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:19:10.396196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:19:10.400281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:19:10.400656 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:19:10.443834 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m16:19:10.446089 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:10.446495 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:19:10.447650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc33cb9-fe3f-41db-9f63-40667e0b13e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c783fa30>]}
[0m16:19:10.448490 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:19:10.449405 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:19:10.451543 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:10.451954 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:10.452233 [debug] [MainThread]: On master: BEGIN
[0m16:19:10.452510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:10.510622 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:19:10.511134 [debug] [MainThread]: On master: COMMIT
[0m16:19:10.511480 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:10.511758 [debug] [MainThread]: On master: COMMIT
[0m16:19:10.513447 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:10.513873 [debug] [MainThread]: On master: Close
[0m16:19:10.515056 [info ] [MainThread]: 
[0m16:19:10.515685 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:19:10.516184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:10.516477 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:19:10.531538 [info ] [MainThread]: 
[0m16:19:10.532388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:10.533197 [info ] [MainThread]: 
[0m16:19:10.533785 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:19:10.534705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c7844520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c78440a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c7846410>]}
[0m16:19:10.535379 [debug] [MainThread]: Flushing usage events
[0m16:19:20.210195 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:20:12.658990 | ddc2f988-a882-43c8-b245-7910fb9d4e3a ==============================
[0m16:20:12.659018 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:20:12.660098 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:20:12.660545 [debug] [MainThread]: Tracking: tracking
[0m16:20:12.663249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68590d3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68590d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68590d3fd0>]}
[0m16:20:12.777377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:12.777822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:12.789219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddc2f988-a882-43c8-b245-7910fb9d4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68586c24d0>]}
[0m16:20:12.807099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddc2f988-a882-43c8-b245-7910fb9d4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6858697b50>]}
[0m16:20:12.808076 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:20:12.808925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddc2f988-a882-43c8-b245-7910fb9d4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6858697b80>]}
[0m16:20:12.811727 [info ] [MainThread]: 
[0m16:20:12.813444 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:20:12.815863 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:20:12.908757 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:20:12.909438 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:20:12.909936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:12.931651 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:20:12.935558 [debug] [ThreadPool]: On list_test: Close
[0m16:20:12.938793 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:20:12.951531 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:20:12.952004 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:20:12.952336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:13.011716 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:20:13.012199 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:20:13.012566 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:20:13.019000 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:20:13.021243 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:20:13.023077 [debug] [ThreadPool]: On list_test_public: Close
[0m16:20:13.031519 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:13.031935 [debug] [MainThread]: On master: BEGIN
[0m16:20:13.032204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:13.048075 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:20:13.048809 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:13.049319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:13.073700 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:20:13.078171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddc2f988-a882-43c8-b245-7910fb9d4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68586afdf0>]}
[0m16:20:13.079178 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:13.081909 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:13.082682 [debug] [MainThread]: On master: BEGIN
[0m16:20:13.090455 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:20:13.091370 [debug] [MainThread]: On master: COMMIT
[0m16:20:13.092089 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:13.092752 [debug] [MainThread]: On master: COMMIT
[0m16:20:13.094860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:13.095360 [debug] [MainThread]: On master: Close
[0m16:20:13.096604 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:20:13.097566 [info ] [MainThread]: 
[0m16:20:13.104945 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:13.105852 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:20:13.107396 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.107798 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:13.108121 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:20:13.113462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.114155 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:13.114536 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:13.207307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.208193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.208542 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:20:13.208815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:13.226117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:20:13.226618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.226898 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:20:13.232499 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:20:13.247048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.247701 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:20:13.251518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:13.259659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.260289 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:20:13.263271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:13.335574 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:20:13.336247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.336704 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:20:13.382009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m16:20:13.398304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:13.398959 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:20:13.443771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:20:13.447423 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:13.448021 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:20:13.449619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc2f988-a882-43c8-b245-7910fb9d4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68587080d0>]}
[0m16:20:13.450627 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.34s]
[0m16:20:13.451977 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:13.453596 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:13.454383 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:20:13.456165 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.456774 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:13.457243 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:20:13.465857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.466986 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:13.467596 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:13.532402 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.533666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.534270 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:20:13.534742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:13.595709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:20:13.596401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.596907 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:20:13.647699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.05 seconds
[0m16:20:13.653222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.653620 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:20:13.656507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:13.659846 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:20:13.660233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.660508 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:20:13.665252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:20:13.669085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:13.669416 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:20:13.715686 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:20:13.718209 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:13.718683 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:20:13.719887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc2f988-a882-43c8-b245-7910fb9d4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68585aba30>]}
[0m16:20:13.720628 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.26s]
[0m16:20:13.721514 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:13.724186 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:20:13.724864 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:13.725394 [debug] [MainThread]: On master: BEGIN
[0m16:20:13.725881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:13.747080 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:20:13.747905 [debug] [MainThread]: On master: COMMIT
[0m16:20:13.748401 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:13.748863 [debug] [MainThread]: On master: COMMIT
[0m16:20:13.751063 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:13.751847 [debug] [MainThread]: On master: Close
[0m16:20:13.753511 [info ] [MainThread]: 
[0m16:20:13.754566 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m16:20:13.755487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:13.755970 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:20:13.778581 [info ] [MainThread]: 
[0m16:20:13.779717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:13.780780 [info ] [MainThread]: 
[0m16:20:13.781677 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:20:13.782779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68585b0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68585b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68585b1900>]}
[0m16:20:13.783622 [debug] [MainThread]: Flushing usage events
[0m16:20:25.908461 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:20:43.626986 | de218af2-7a66-4ec4-823a-6c77ce1b0dc2 ==============================
[0m16:20:43.627007 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:20:43.627715 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:20:43.627990 [debug] [MainThread]: Tracking: tracking
[0m16:20:43.629930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bddeb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bdde8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bddebfa0>]}
[0m16:20:43.715314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:43.715843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:43.727553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de218af2-7a66-4ec4-823a-6c77ce1b0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd36e4a0>]}
[0m16:20:43.740607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de218af2-7a66-4ec4-823a-6c77ce1b0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd343b20>]}
[0m16:20:43.741310 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:20:43.741922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de218af2-7a66-4ec4-823a-6c77ce1b0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd343b50>]}
[0m16:20:43.744149 [info ] [MainThread]: 
[0m16:20:43.745506 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:20:43.747504 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:20:43.829659 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:20:43.830172 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:20:43.830493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:43.847815 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:20:43.850275 [debug] [ThreadPool]: On list_test: Close
[0m16:20:43.853143 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:20:43.864912 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:20:43.865323 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:20:43.865598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.881955 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:20:43.882462 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:20:43.882765 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:20:43.889914 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:20:43.892293 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:20:43.894139 [debug] [ThreadPool]: On list_test_public: Close
[0m16:20:43.903199 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.903642 [debug] [MainThread]: On master: BEGIN
[0m16:20:43.903923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:43.919447 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:20:43.919944 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.920269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:43.942209 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:20:43.944398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de218af2-7a66-4ec4-823a-6c77ce1b0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd35be20>]}
[0m16:20:43.944953 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:43.946806 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.947128 [debug] [MainThread]: On master: BEGIN
[0m16:20:43.996071 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:20:43.996796 [debug] [MainThread]: On master: COMMIT
[0m16:20:43.997293 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.997744 [debug] [MainThread]: On master: COMMIT
[0m16:20:44.000164 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:44.000731 [debug] [MainThread]: On master: Close
[0m16:20:44.002134 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:20:44.003052 [info ] [MainThread]: 
[0m16:20:44.009789 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:44.010940 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:20:44.012891 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.013476 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:44.013998 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:20:44.022647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.023714 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:44.024291 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:44.111782 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.112653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.113023 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:20:44.113365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:44.167780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:20:44.168357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.168695 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:20:44.174980 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:20:44.190772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.191282 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:20:44.195568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:44.201402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.201834 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:20:44.204853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:44.258169 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:20:44.258739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.259085 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:20:44.266296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:20:44.277829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:20:44.278346 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:20:44.323837 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:20:44.326995 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:44.327671 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:20:44.329278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de218af2-7a66-4ec4-823a-6c77ce1b0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd3b40d0>]}
[0m16:20:44.330268 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.32s]
[0m16:20:44.331701 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:20:44.333296 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:44.334278 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:20:44.336493 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.337188 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:44.337872 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:20:44.348632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.349965 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:44.350702 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:44.412748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.414006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.414439 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:20:44.414763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:44.434199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:20:44.434726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.435050 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:20:44.441528 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:20:44.447126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.447599 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:20:44.450862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:44.454500 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:20:44.454926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.455253 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:20:44.461098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:20:44.465542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:20:44.465961 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:20:44.469710 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:44.472158 [debug] [Thread-1 (]: finished collecting timing info
[0m16:20:44.472592 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:20:44.473910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de218af2-7a66-4ec4-823a-6c77ce1b0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd3b45b0>]}
[0m16:20:44.474791 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.14s]
[0m16:20:44.475836 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:20:44.478141 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:20:44.478750 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:44.479261 [debug] [MainThread]: On master: BEGIN
[0m16:20:44.479700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:44.497927 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:20:44.498522 [debug] [MainThread]: On master: COMMIT
[0m16:20:44.499094 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:44.499473 [debug] [MainThread]: On master: COMMIT
[0m16:20:44.502083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:44.502672 [debug] [MainThread]: On master: Close
[0m16:20:44.504137 [info ] [MainThread]: 
[0m16:20:44.505189 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m16:20:44.506385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:44.506865 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:20:44.523687 [info ] [MainThread]: 
[0m16:20:44.524789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:44.525909 [info ] [MainThread]: 
[0m16:20:44.526893 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:20:44.527990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd258070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd2583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd258a60>]}
[0m16:20:44.528588 [debug] [MainThread]: Flushing usage events
[0m16:20:55.131354 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:21:38.508290 | 71c32cb7-f14f-43cd-995f-c5bec6958aee ==============================
[0m16:21:38.508308 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:21:38.508922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:21:38.509171 [debug] [MainThread]: Tracking: tracking
[0m16:21:38.511029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095e4d3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095e4d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095e4d3fd0>]}
[0m16:21:38.600487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:38.600907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:38.611640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71c32cb7-f14f-43cd-995f-c5bec6958aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095da9a4d0>]}
[0m16:21:38.623205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71c32cb7-f14f-43cd-995f-c5bec6958aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095da6fb50>]}
[0m16:21:38.623732 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:21:38.624227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c32cb7-f14f-43cd-995f-c5bec6958aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095da6fb80>]}
[0m16:21:38.626263 [info ] [MainThread]: 
[0m16:21:38.627555 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:21:38.629671 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:21:38.701245 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:21:38.701698 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:21:38.702008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:38.717270 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:21:38.719607 [debug] [ThreadPool]: On list_test: Close
[0m16:21:38.722328 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:21:38.734150 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:21:38.734561 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:21:38.734875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:38.791868 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:21:38.792393 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:21:38.792699 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:21:38.800564 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:21:38.802851 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:21:38.805007 [debug] [ThreadPool]: On list_test_public: Close
[0m16:21:38.813616 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:38.814030 [debug] [MainThread]: On master: BEGIN
[0m16:21:38.814313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:38.830701 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:21:38.831178 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:38.831473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:38.853991 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:21:38.856225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c32cb7-f14f-43cd-995f-c5bec6958aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095da87df0>]}
[0m16:21:38.856838 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:38.858821 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:38.859178 [debug] [MainThread]: On master: BEGIN
[0m16:21:38.863020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:21:38.863398 [debug] [MainThread]: On master: COMMIT
[0m16:21:38.863666 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:38.863899 [debug] [MainThread]: On master: COMMIT
[0m16:21:38.865438 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:21:38.865756 [debug] [MainThread]: On master: Close
[0m16:21:38.866644 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:21:38.867210 [info ] [MainThread]: 
[0m16:21:38.872083 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:21:38.872897 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:21:38.874168 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:38.874564 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:21:38.874886 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:21:38.880104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:38.880810 [debug] [Thread-1 (]: finished collecting timing info
[0m16:21:38.881233 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:21:38.972789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:38.973633 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:38.974005 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:21:38.974291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:39.031784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:21:39.032516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:39.033019 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:21:39.038280 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:21:39.051518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:39.051929 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:21:39.054838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:39.059553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:39.059911 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:21:39.062544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:39.105048 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:21:39.105473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:39.105742 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:21:39.111225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:21:39.121065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:21:39.121496 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:21:39.163750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:21:39.167445 [debug] [Thread-1 (]: finished collecting timing info
[0m16:21:39.168125 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:21:39.169756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c32cb7-f14f-43cd-995f-c5bec6958aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095dae00d0>]}
[0m16:21:39.170808 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.30s]
[0m16:21:39.172211 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:21:39.173652 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:21:39.174243 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:21:39.175980 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.176446 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:21:39.176782 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:21:39.182113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.182828 [debug] [Thread-1 (]: finished collecting timing info
[0m16:21:39.183213 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:21:39.227658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.228726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.229272 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:21:39.229662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:39.295829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:21:39.296498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.296831 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:21:39.301854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:21:39.306907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.307298 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:21:39.310970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:39.314299 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:21:39.314652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.314918 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:21:39.318946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:21:39.322774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:21:39.323132 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:21:39.325766 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:21:39.327849 [debug] [Thread-1 (]: finished collecting timing info
[0m16:21:39.328242 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:21:39.329402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c32cb7-f14f-43cd-995f-c5bec6958aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095d983a30>]}
[0m16:21:39.330090 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:21:39.331040 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:21:39.333833 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:21:39.334493 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:39.334989 [debug] [MainThread]: On master: BEGIN
[0m16:21:39.335450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:39.359858 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:21:39.360769 [debug] [MainThread]: On master: COMMIT
[0m16:21:39.361303 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:39.361759 [debug] [MainThread]: On master: COMMIT
[0m16:21:39.364989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:21:39.365785 [debug] [MainThread]: On master: Close
[0m16:21:39.367404 [info ] [MainThread]: 
[0m16:21:39.368418 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m16:21:39.369318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:39.369907 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:21:39.391887 [info ] [MainThread]: 
[0m16:21:39.392945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:39.393879 [info ] [MainThread]: 
[0m16:21:39.394678 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:21:39.395806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095d988d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095d9885e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095d98afb0>]}
[0m16:21:39.396584 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:22:24.730813 | cdd41ebd-975f-48d6-a5ae-7279060fb7fa ==============================
[0m16:22:24.730847 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:22:24.732039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:22:24.732569 [debug] [MainThread]: Tracking: tracking
[0m16:22:24.735451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec98e3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec98e0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec98e0bb0>]}
[0m16:22:24.842963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:24.843411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:24.853834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd41ebd-975f-48d6-a5ae-7279060fb7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8e52500>]}
[0m16:22:24.865260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd41ebd-975f-48d6-a5ae-7279060fb7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8e27b80>]}
[0m16:22:24.865807 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:22:24.866307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd41ebd-975f-48d6-a5ae-7279060fb7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8e27bb0>]}
[0m16:22:24.868551 [info ] [MainThread]: 
[0m16:22:24.870042 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:22:24.871773 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:22:24.945696 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:22:24.946397 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:22:24.946885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:24.965857 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:22:24.968353 [debug] [ThreadPool]: On list_test: Close
[0m16:22:24.971542 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:22:24.983648 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:22:24.984068 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:22:24.984365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:24.998194 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:22:24.998657 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:22:24.998959 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:22:25.005224 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:22:25.009047 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:22:25.010973 [debug] [ThreadPool]: On list_test_public: Close
[0m16:22:25.020129 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:25.020505 [debug] [MainThread]: On master: BEGIN
[0m16:22:25.020753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:25.035509 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:22:25.035956 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:25.036233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:25.059763 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:22:25.063664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd41ebd-975f-48d6-a5ae-7279060fb7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8e3fc70>]}
[0m16:22:25.064493 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:25.069707 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:25.070271 [debug] [MainThread]: On master: BEGIN
[0m16:22:25.119778 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:22:25.120256 [debug] [MainThread]: On master: COMMIT
[0m16:22:25.120529 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:25.120766 [debug] [MainThread]: On master: COMMIT
[0m16:22:25.123044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:22:25.123670 [debug] [MainThread]: On master: Close
[0m16:22:25.125125 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:22:25.126081 [info ] [MainThread]: 
[0m16:22:25.133474 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:22:25.134511 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:22:25.136450 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.136951 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:22:25.137303 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:22:25.143400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.144413 [debug] [Thread-1 (]: finished collecting timing info
[0m16:22:25.144824 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:22:25.227529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.228295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.228619 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:22:25.228872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:25.283622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:22:25.284102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.284404 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:22:25.289293 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:22:25.302256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.302643 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:22:25.305452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:22:25.309931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.310261 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:22:25.312656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:22:25.357975 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:22:25.358447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.358719 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:22:25.365573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:22:25.374775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:22:25.375147 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:22:25.419909 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:22:25.422878 [debug] [Thread-1 (]: finished collecting timing info
[0m16:22:25.423424 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:22:25.424913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd41ebd-975f-48d6-a5ae-7279060fb7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8e980d0>]}
[0m16:22:25.425985 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.29s]
[0m16:22:25.427106 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:22:25.428642 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:22:25.429281 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:22:25.430987 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.431585 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:22:25.432098 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:22:25.438551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.439368 [debug] [Thread-1 (]: finished collecting timing info
[0m16:22:25.439784 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:22:25.484125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.485184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.485653 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:22:25.485951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:25.502156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:22:25.502657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.502957 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:22:25.507111 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:22:25.512282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.512715 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:22:25.519953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:22:25.523443 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:22:25.523827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.524094 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:22:25.528931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:22:25.532787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:22:25.533136 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:22:25.579656 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:22:25.581728 [debug] [Thread-1 (]: finished collecting timing info
[0m16:22:25.582102 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:22:25.583105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd41ebd-975f-48d6-a5ae-7279060fb7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8d3ba60>]}
[0m16:22:25.583964 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:22:25.584875 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:22:25.586992 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:22:25.587507 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:25.587886 [debug] [MainThread]: On master: BEGIN
[0m16:22:25.588221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:25.602390 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:22:25.602921 [debug] [MainThread]: On master: COMMIT
[0m16:22:25.603279 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:25.603642 [debug] [MainThread]: On master: COMMIT
[0m16:22:25.605843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:22:25.606347 [debug] [MainThread]: On master: Close
[0m16:22:25.607659 [info ] [MainThread]: 
[0m16:22:25.608556 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m16:22:25.609307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:25.609703 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:22:25.625054 [info ] [MainThread]: 
[0m16:22:25.625705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:25.626258 [info ] [MainThread]: 
[0m16:22:25.626778 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:22:25.627494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8d41d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8d40e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec8d406d0>]}
[0m16:22:25.628166 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:25:29.980184 | 4db82f43-6240-42bb-8d40-9146544dcff2 ==============================
[0m16:25:29.980204 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:25:29.980858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:25:29.981116 [debug] [MainThread]: Tracking: tracking
[0m16:25:29.983143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaadeb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaadeb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaadebdf0>]}
[0m16:25:30.069322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:30.069740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:30.080791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db82f43-6240-42bb-8d40-9146544dcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa30a530>]}
[0m16:25:30.092650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db82f43-6240-42bb-8d40-9146544dcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa2dfbb0>]}
[0m16:25:30.093175 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:25:30.093673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db82f43-6240-42bb-8d40-9146544dcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa2dfbe0>]}
[0m16:25:30.095898 [info ] [MainThread]: 
[0m16:25:30.097247 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:25:30.099405 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:25:30.175811 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:25:30.176336 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:25:30.176647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:30.193260 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:25:30.195702 [debug] [ThreadPool]: On list_test: Close
[0m16:25:30.198724 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:25:30.210410 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:25:30.210873 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:25:30.211183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:30.224855 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:25:30.225307 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:25:30.225585 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:25:30.231592 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:25:30.233832 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:25:30.235559 [debug] [ThreadPool]: On list_test_public: Close
[0m16:25:30.246336 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:30.246720 [debug] [MainThread]: On master: BEGIN
[0m16:25:30.246990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:30.260270 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:25:30.260708 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:30.260991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:30.284823 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:25:30.287164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db82f43-6240-42bb-8d40-9146544dcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa2f7ca0>]}
[0m16:25:30.287710 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:30.292643 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:30.293003 [debug] [MainThread]: On master: BEGIN
[0m16:25:30.295698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:25:30.296037 [debug] [MainThread]: On master: COMMIT
[0m16:25:30.296301 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:30.296555 [debug] [MainThread]: On master: COMMIT
[0m16:25:30.297942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:25:30.298267 [debug] [MainThread]: On master: Close
[0m16:25:30.299303 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:25:30.300071 [info ] [MainThread]: 
[0m16:25:30.306402 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:25:30.307217 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:25:30.308443 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.308792 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:25:30.309171 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:25:30.314702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.315483 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:30.315858 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:25:30.397986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.398725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.399100 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:25:30.399363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:30.492232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.09 seconds
[0m16:25:30.492731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.493021 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:25:30.497565 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:25:30.511714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.512121 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:25:30.514628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:25:30.520038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.520421 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:25:30.522990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:25:30.566974 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:25:30.567408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.567682 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:25:30.573271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:25:30.582260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:25:30.582610 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:25:30.627890 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:25:30.630328 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:30.630768 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:25:30.631926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4db82f43-6240-42bb-8d40-9146544dcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa3500d0>]}
[0m16:25:30.632610 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.32s]
[0m16:25:30.633442 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:25:30.634706 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:25:30.635377 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:25:30.636900 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.637312 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:25:30.637663 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:25:30.643720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.644453 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:30.644844 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:25:30.688271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.689263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.689761 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:25:30.690063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:30.747859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:25:30.748531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.748871 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:25:30.753854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:25:30.759033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.759453 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:25:30.761782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:25:30.765259 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:25:30.765626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.765940 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:25:30.774263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:25:30.778165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:25:30.778520 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:25:30.823780 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m16:25:30.826002 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:30.826398 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:25:30.827485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4db82f43-6240-42bb-8d40-9146544dcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa3500d0>]}
[0m16:25:30.828187 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.19s]
[0m16:25:30.829006 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:25:30.831181 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:25:30.831630 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:30.831957 [debug] [MainThread]: On master: BEGIN
[0m16:25:30.832338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:30.931579 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
[0m16:25:30.932040 [debug] [MainThread]: On master: COMMIT
[0m16:25:30.932326 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:30.932578 [debug] [MainThread]: On master: COMMIT
[0m16:25:30.934929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:25:30.935357 [debug] [MainThread]: On master: Close
[0m16:25:30.936480 [info ] [MainThread]: 
[0m16:25:30.937011 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m16:25:30.937468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:30.937721 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:25:30.951335 [info ] [MainThread]: 
[0m16:25:30.952028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:30.952669 [info ] [MainThread]: 
[0m16:25:30.953147 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:25:30.953814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa1f0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa1f0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaa1f3430>]}
[0m16:25:30.954274 [debug] [MainThread]: Flushing usage events
[0m16:25:50.976590 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:26:23.520923 | b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1 ==============================
[0m16:26:23.520945 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:26:23.521645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:26:23.521933 [debug] [MainThread]: Tracking: tracking
[0m16:26:23.524191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a86d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a86d4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a86d4bb0>]}
[0m16:26:23.614525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:23.614944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:23.625609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7cb2500>]}
[0m16:26:23.637612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7c87b80>]}
[0m16:26:23.638223 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:26:23.638750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7c87bb0>]}
[0m16:26:23.640953 [info ] [MainThread]: 
[0m16:26:23.642428 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:26:23.644289 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:26:23.721259 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:26:23.721817 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:26:23.722232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:23.742016 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:26:23.744575 [debug] [ThreadPool]: On list_test: Close
[0m16:26:23.747510 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:26:23.760776 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:26:23.761248 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:26:23.761558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:23.819767 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:26:23.820308 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:26:23.820608 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:26:23.828738 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:26:23.831355 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:26:23.835184 [debug] [ThreadPool]: On list_test_public: Close
[0m16:26:23.845615 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:23.846120 [debug] [MainThread]: On master: BEGIN
[0m16:26:23.846426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:23.863836 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:26:23.864359 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:23.864666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:26:23.900453 [debug] [MainThread]: SQL status: SELECT 3 in 0.04 seconds
[0m16:26:23.902974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7c9fc70>]}
[0m16:26:23.903649 [debug] [MainThread]: On master: ROLLBACK
[0m16:26:23.906239 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:23.906671 [debug] [MainThread]: On master: BEGIN
[0m16:26:23.910785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:26:23.911297 [debug] [MainThread]: On master: COMMIT
[0m16:26:23.911611 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:23.911885 [debug] [MainThread]: On master: COMMIT
[0m16:26:23.919053 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m16:26:23.919893 [debug] [MainThread]: On master: Close
[0m16:26:23.921605 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:26:23.922696 [info ] [MainThread]: 
[0m16:26:23.929951 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:26:23.930875 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:26:23.932669 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:23.933144 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:26:23.933501 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:26:23.940353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:23.941339 [debug] [Thread-1 (]: finished collecting timing info
[0m16:26:23.941782 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:26:24.051016 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.052484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.052971 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:26:24.053505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:24.111673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:26:24.112215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.112519 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:26:24.118266 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:26:24.138607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.139360 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:26:24.183744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:26:24.189210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.189595 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:26:24.192382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:26:24.239699 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:26:24.240143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.240409 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:26:24.245617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:26:24.254874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:26:24.255283 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:26:24.299895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:26:24.302209 [debug] [Thread-1 (]: finished collecting timing info
[0m16:26:24.302602 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:26:24.303797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7cf80d0>]}
[0m16:26:24.304626 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.37s]
[0m16:26:24.305506 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:26:24.306908 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:26:24.307426 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:26:24.308645 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.309143 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:26:24.309530 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:26:24.315174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.315863 [debug] [Thread-1 (]: finished collecting timing info
[0m16:26:24.316227 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:26:24.368324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.369603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.370184 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:26:24.370719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:24.389027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:26:24.389600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.389969 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:26:24.396642 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:26:24.401745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.402156 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:26:24.407439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:26:24.413248 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:26:24.413868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.414350 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:26:24.428273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:26:24.435287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:26:24.435995 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:26:24.483802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:26:24.486332 [debug] [Thread-1 (]: finished collecting timing info
[0m16:26:24.486788 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:26:24.488047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b587cb5c-e109-4e5d-b0c5-f9d5d58d35d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7b9ba60>]}
[0m16:26:24.488937 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.18s]
[0m16:26:24.489815 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:26:24.492419 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:26:24.493114 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:24.493628 [debug] [MainThread]: On master: BEGIN
[0m16:26:24.494094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:24.551717 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:26:24.552586 [debug] [MainThread]: On master: COMMIT
[0m16:26:24.553144 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:24.553648 [debug] [MainThread]: On master: COMMIT
[0m16:26:24.556669 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:26:24.557385 [debug] [MainThread]: On master: Close
[0m16:26:24.559090 [info ] [MainThread]: 
[0m16:26:24.560100 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m16:26:24.560969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:24.561435 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:26:24.583177 [info ] [MainThread]: 
[0m16:26:24.584244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:24.585241 [info ] [MainThread]: 
[0m16:26:24.586177 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:26:24.587300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7ba0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7ba0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a7ba2950>]}
[0m16:26:24.588096 [debug] [MainThread]: Flushing usage events
[0m16:26:35.244264 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:28:59.754787 | 55989995-b246-4e99-b6f3-aa1a3cc30464 ==============================
[0m16:28:59.754813 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:28:59.755577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:28:59.756028 [debug] [MainThread]: Tracking: tracking
[0m16:28:59.757976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1e2d3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1e2d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1e2d3fd0>]}
[0m16:28:59.844779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:59.845187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:59.856021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55989995-b246-4e99-b6f3-aa1a3cc30464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d7f24d0>]}
[0m16:28:59.867137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55989995-b246-4e99-b6f3-aa1a3cc30464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d7c7b50>]}
[0m16:28:59.867705 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:28:59.868208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55989995-b246-4e99-b6f3-aa1a3cc30464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d7c7b80>]}
[0m16:28:59.870186 [info ] [MainThread]: 
[0m16:28:59.871679 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:28:59.873528 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:28:59.950839 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:28:59.951678 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:28:59.952046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:59.969617 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:28:59.972256 [debug] [ThreadPool]: On list_test: Close
[0m16:28:59.974979 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:28:59.986919 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:28:59.987353 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:28:59.987637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:00.000607 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:29:00.001072 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:29:00.001378 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:29:00.007646 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:29:00.009987 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:29:00.014944 [debug] [ThreadPool]: On list_test_public: Close
[0m16:29:00.025846 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.026255 [debug] [MainThread]: On master: BEGIN
[0m16:29:00.026539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:00.039679 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:29:00.040121 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.040405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:00.062496 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:29:00.064651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55989995-b246-4e99-b6f3-aa1a3cc30464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d7dfdf0>]}
[0m16:29:00.065211 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:00.067042 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.067418 [debug] [MainThread]: On master: BEGIN
[0m16:29:00.070046 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:00.070442 [debug] [MainThread]: On master: COMMIT
[0m16:29:00.070737 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.071005 [debug] [MainThread]: On master: COMMIT
[0m16:29:00.072454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:00.072868 [debug] [MainThread]: On master: Close
[0m16:29:00.073950 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:29:00.074498 [info ] [MainThread]: 
[0m16:29:00.079922 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:00.080780 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:29:00.082104 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.082476 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:00.082773 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:29:00.088063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.088787 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:00.089213 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:00.174696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.175471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.175822 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:29:00.176077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:00.191417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:29:00.191903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.192199 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:29:00.196285 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:29:00.210292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.210695 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:29:00.213644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:29:00.218166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.218483 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:29:00.224020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:29:00.266735 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:29:00.267159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.267459 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:29:00.273412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:29:00.282409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:29:00.282947 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:29:00.327896 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:29:00.330355 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:00.330780 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:29:00.332002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55989995-b246-4e99-b6f3-aa1a3cc30464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d8380d0>]}
[0m16:29:00.332778 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.25s]
[0m16:29:00.333852 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:29:00.335031 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:00.335699 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:29:00.336990 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.337478 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:00.337894 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:29:00.343873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.344604 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:00.344989 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:00.389531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.390717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.391260 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:29:00.391694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:00.411249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:29:00.411738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.412078 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:29:00.419057 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:29:00.424442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.424828 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:29:00.427372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:29:00.430693 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:29:00.431064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.431381 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:29:00.436698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:29:00.440563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:29:00.440902 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:29:00.443549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:29:00.445613 [debug] [Thread-1 (]: finished collecting timing info
[0m16:29:00.446011 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:29:00.447233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55989995-b246-4e99-b6f3-aa1a3cc30464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d8380d0>]}
[0m16:29:00.448057 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m16:29:00.448895 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:29:00.450764 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:29:00.451228 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.451641 [debug] [MainThread]: On master: BEGIN
[0m16:29:00.452012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:00.464512 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:29:00.465112 [debug] [MainThread]: On master: COMMIT
[0m16:29:00.465595 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.466077 [debug] [MainThread]: On master: COMMIT
[0m16:29:00.467982 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:00.468597 [debug] [MainThread]: On master: Close
[0m16:29:00.470130 [info ] [MainThread]: 
[0m16:29:00.471072 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m16:29:00.471896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:00.472354 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:29:00.490643 [info ] [MainThread]: 
[0m16:29:00.491288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:00.491836 [info ] [MainThread]: 
[0m16:29:00.492277 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:29:00.493012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d6d8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d6d80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1d6d8760>]}
[0m16:29:00.493609 [debug] [MainThread]: Flushing usage events
[0m16:29:01.035642 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:31:05.546650 | 736ca5c8-8e36-4474-b901-0655b4d38502 ==============================
[0m16:31:05.546671 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:31:05.547632 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:31:05.548119 [debug] [MainThread]: Tracking: tracking
[0m16:31:05.552461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef89ddb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef89dd8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef89dd8bb0>]}
[0m16:31:05.683047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:05.683699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:05.701145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736ca5c8-8e36-4474-b901-0655b4d38502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef892e6500>]}
[0m16:31:05.720402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736ca5c8-8e36-4474-b901-0655b4d38502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef892bbb80>]}
[0m16:31:05.721311 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:31:05.722132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736ca5c8-8e36-4474-b901-0655b4d38502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef892bbbb0>]}
[0m16:31:05.724946 [info ] [MainThread]: 
[0m16:31:05.726666 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:31:05.729113 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:31:05.811470 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:31:05.811959 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:31:05.812293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:05.832645 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:31:05.835040 [debug] [ThreadPool]: On list_test: Close
[0m16:31:05.838204 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:31:05.850223 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:31:05.850692 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:31:05.850984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:05.868875 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:31:05.869343 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:31:05.869647 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:31:05.877534 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:31:05.880262 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:31:05.883299 [debug] [ThreadPool]: On list_test_public: Close
[0m16:31:05.892582 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.893004 [debug] [MainThread]: On master: BEGIN
[0m16:31:05.893274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:05.947698 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:31:05.948296 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.948683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:05.976785 [debug] [MainThread]: SQL status: SELECT 3 in 0.03 seconds
[0m16:31:05.980591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736ca5c8-8e36-4474-b901-0655b4d38502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef892cfc70>]}
[0m16:31:05.981526 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:05.984301 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.984742 [debug] [MainThread]: On master: BEGIN
[0m16:31:05.988841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:31:05.989504 [debug] [MainThread]: On master: COMMIT
[0m16:31:05.990018 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.990489 [debug] [MainThread]: On master: COMMIT
[0m16:31:05.992570 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:31:05.993196 [debug] [MainThread]: On master: Close
[0m16:31:05.994678 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:31:05.995570 [info ] [MainThread]: 
[0m16:31:06.002392 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:31:06.003631 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:31:06.005575 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.006157 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:31:06.006685 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:31:06.013731 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.014757 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:06.015304 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:31:06.107975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.108863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.109278 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:31:06.109576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:06.131207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:31:06.131736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.132050 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:31:06.138320 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:31:06.154748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.155250 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:31:06.158398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:31:06.163743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.164233 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:31:06.167140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:31:06.213587 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:31:06.214130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.214458 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:31:06.220138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:31:06.236559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:31:06.237208 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:31:06.283692 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:31:06.286349 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:06.286986 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:31:06.288415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736ca5c8-8e36-4474-b901-0655b4d38502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8932c0d0>]}
[0m16:31:06.289263 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.28s]
[0m16:31:06.290408 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:31:06.291925 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:31:06.292616 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:31:06.294488 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.295065 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:31:06.295585 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:31:06.304610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.305672 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:06.306279 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:31:06.359742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.360593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.361081 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:31:06.361365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:06.423792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:31:06.424550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.425065 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:31:06.432710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:31:06.441338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.441954 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:31:06.445009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:31:06.450513 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:31:06.451128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.451666 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:31:06.458225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:31:06.462167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:31:06.462554 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:31:06.465224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:31:06.469059 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:06.470011 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:31:06.471697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736ca5c8-8e36-4474-b901-0655b4d38502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef891cfa60>]}
[0m16:31:06.472779 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.18s]
[0m16:31:06.474126 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:31:06.477028 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:31:06.477717 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:06.478240 [debug] [MainThread]: On master: BEGIN
[0m16:31:06.478719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:06.543623 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:31:06.544126 [debug] [MainThread]: On master: COMMIT
[0m16:31:06.544413 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:06.544669 [debug] [MainThread]: On master: COMMIT
[0m16:31:06.546783 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:31:06.547226 [debug] [MainThread]: On master: Close
[0m16:31:06.548367 [info ] [MainThread]: 
[0m16:31:06.549199 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m16:31:06.549833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:06.550331 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:31:06.566991 [info ] [MainThread]: 
[0m16:31:06.567734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:06.568408 [info ] [MainThread]: 
[0m16:31:06.569057 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:31:06.569832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef891d5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef891d4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef891d5630>]}
[0m16:31:06.570604 [debug] [MainThread]: Flushing usage events
[0m16:31:24.571023 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-01-01 16:38:11.974795 | 7006d641-95f3-401e-b1da-281331f67f4a ==============================
[0m16:38:11.974818 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:38:11.975551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:38:11.975836 [debug] [MainThread]: Tracking: tracking
[0m16:38:11.977747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67425db670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67425d8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67425d8bb0>]}
[0m16:38:12.064886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:38:12.065784 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:38:12.066232 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/vehicle_data.sql
[0m16:38:12.066762 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/schema.yml
[0m16:38:12.094245 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:38:12.163311 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_data.sql
[0m16:38:12.198260 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'traffic_data' in the 'models' section of file 'models/traffic_data/schema.yml'
[0m16:38:12.199661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6741ca8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67425d47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67425d7730>]}
[0m16:38:12.200169 [debug] [MainThread]: Flushing usage events
[0m16:38:13.476524 [error] [MainThread]: Encountered an error:
Compilation Error in model vehicle_data (models/traffic_data/vehicle_data.sql)
  Model 'model.dbt_traffic_data.vehicle_data' (models/traffic_data/vehicle_data.sql) depends on a source named 'traffic_data.test' which was not found


============================== 2023-01-01 16:39:18.837931 | 5ffdd83f-0852-4538-964e-bc78955ea562 ==============================
[0m16:39:18.837954 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:39:18.838702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:39:18.839179 [debug] [MainThread]: Tracking: tracking
[0m16:39:18.841523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595ef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595eff70>]}
[0m16:39:18.933641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:39:18.934505 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/schema.yml
[0m16:39:18.934989 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/vehicle_data.sql
[0m16:39:18.935373 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:39:18.960874 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_data.sql
[0m16:39:19.032538 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:39:19.069224 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'traffic_data' in the 'models' section of file 'models/traffic_data/schema.yml'
[0m16:39:19.070653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f58a95120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595f2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595f1990>]}
[0m16:39:19.071231 [debug] [MainThread]: Flushing usage events
[0m16:39:23.234528 [error] [MainThread]: Encountered an error:
Compilation Error in model vehicle_data (models/traffic_data/vehicle_data.sql)
  Model 'model.dbt_traffic_data.vehicle_data' (models/traffic_data/vehicle_data.sql) depends on a source named 'traffic_data.test' which was not found


============================== 2023-01-01 16:40:24.722248 | 21bf7929-49bb-4352-a6cf-0c8b425aa96b ==============================
[0m16:40:24.722272 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:40:24.723035 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:40:24.723337 [debug] [MainThread]: Tracking: tracking
[0m16:40:24.725920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93031ef0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93031ef190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93031ef130>]}
[0m16:40:24.796849 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:40:24.797585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21bf7929-49bb-4352-a6cf-0c8b425aa96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303113e20>]}
[0m16:40:24.833511 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:40:24.840332 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:40:24.843212 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:40:24.847794 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:40:24.902048 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:40:24.906597 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:40:24.908833 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:40:24.909861 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:40:24.911137 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:40:24.914117 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:40:24.918045 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:40:24.939226 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:40:24.944283 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:40:24.955884 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:40:24.962333 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:40:24.969259 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:40:24.973390 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:40:24.984478 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:40:25.002265 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:40:25.035126 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:40:25.076404 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:40:25.081167 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:40:25.096664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:40:25.109706 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:40:25.184716 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:40:25.192486 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:40:25.203380 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:40:25.212142 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:40:25.215603 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:40:25.219234 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:40:25.222773 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:40:25.248068 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:40:25.270781 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:40:25.300503 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:40:25.313491 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:40:25.347353 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:40:25.349892 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:40:25.351888 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:40:25.354345 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:40:25.356833 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:40:25.358783 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:40:25.360856 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:40:25.362997 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:40:25.365392 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:40:25.367041 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:40:25.369574 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:40:25.373820 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:40:25.386866 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:40:25.389298 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:40:25.392232 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:40:25.394621 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:40:25.397913 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:40:25.400197 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:40:25.402002 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:40:25.405924 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:40:25.407998 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:40:25.410188 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:40:25.412781 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:40:25.415110 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:40:25.420010 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:40:25.423430 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:40:25.428682 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:40:25.432124 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:40:25.433977 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:40:25.435540 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:40:25.439211 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:40:25.441586 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:40:25.449668 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:40:25.479633 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:40:25.485013 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:40:25.488986 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:40:25.493226 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:40:25.507243 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:40:25.524679 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:40:25.532990 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:40:25.566744 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:40:25.578091 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:40:25.594330 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:40:25.607914 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:40:26.150576 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:40:26.193566 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:40:26.204088 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:40:26.214004 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_data.sql
[0m16:40:26.333303 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'traffic_data' in the 'models' section of file 'models/traffic_data/schema.yml'
[0m16:40:26.334802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9302739870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930272df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930272f400>]}
[0m16:40:26.335316 [debug] [MainThread]: Flushing usage events
[0m16:40:27.961690 [error] [MainThread]: Encountered an error:
Compilation Error in model vehicle_data (models/traffic_data/vehicle_data.sql)
  Model 'model.dbt_traffic_data.vehicle_data' (models/traffic_data/vehicle_data.sql) depends on a source named 'traffic_data.test' which was not found


============================== 2023-01-01 16:41:08.016565 | 1d7e53db-dea1-4521-9a72-f4771a5d7580 ==============================
[0m16:41:08.016589 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:41:08.017306 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:41:08.017581 [debug] [MainThread]: Tracking: tracking
[0m16:41:08.019649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a67ddb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a67ddb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a67ddb130>]}
[0m16:41:08.085236 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:41:08.086013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d7e53db-dea1-4521-9a72-f4771a5d7580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a681d3eb0>]}
[0m16:41:08.111175 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:41:08.116675 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:41:08.119524 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:41:08.124817 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:41:08.174147 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:41:08.177697 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:41:08.179706 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:41:08.180597 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:41:08.181710 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:41:08.183594 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:41:08.186008 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:41:08.198080 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:41:08.200920 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:41:08.208237 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:41:08.212621 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:41:08.216925 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:41:08.219244 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:41:08.225904 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:41:08.235609 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:41:08.254303 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:41:08.282554 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:41:08.285473 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:41:08.300208 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:41:08.313247 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:41:08.389344 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:41:08.397123 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:41:08.407733 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:41:08.416420 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:41:08.419898 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:41:08.423504 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:41:08.426693 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:41:08.451037 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:41:08.472976 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:41:08.504636 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:41:08.517839 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:41:08.551765 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:41:08.554216 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:41:08.556125 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:41:08.559623 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:41:08.561687 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:41:08.563498 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:41:08.565471 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:41:08.567607 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:41:08.570096 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:41:08.571916 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:41:08.575295 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:41:08.579264 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:41:08.591886 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:41:08.593872 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:41:08.596192 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:41:08.599425 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:41:08.602685 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:41:08.604870 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:41:08.606651 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:41:08.610729 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:41:08.612611 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:41:08.614599 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:41:08.617247 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:41:08.619312 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:41:08.624364 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:41:08.627509 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:41:08.631926 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:41:08.634733 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:41:08.636451 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:41:08.637857 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:41:08.640921 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:41:08.643065 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:41:08.649480 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:41:08.674940 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:41:08.679947 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:41:08.683935 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:41:08.687884 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:41:08.701221 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:41:08.719658 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:41:08.727624 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:41:08.754336 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:41:08.765268 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:41:08.780404 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:41:08.792049 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:41:09.273565 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:41:09.298481 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:41:09.304253 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:41:09.309357 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_data.sql
[0m16:41:09.421676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a673f58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a673d57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a673d7580>]}
[0m16:41:09.422356 [debug] [MainThread]: Flushing usage events
[0m16:41:10.632870 [error] [MainThread]: Encountered an error:
Compilation Error in model vehicle_data (models/traffic_data/vehicle_data.sql)
  Model 'model.dbt_traffic_data.vehicle_data' (models/traffic_data/vehicle_data.sql) depends on a source named 'traffic_data.test' which was not found


============================== 2023-01-01 16:41:27.484283 | f9c38292-6354-4292-b5e1-2fa7232cd74e ==============================
[0m16:41:27.484317 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:41:27.485540 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:41:27.486065 [debug] [MainThread]: Tracking: tracking
[0m16:41:27.488659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863feb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863feb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863feb130>]}
[0m16:41:27.586341 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:41:27.587501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9c38292-6354-4292-b5e1-2fa7232cd74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863f0fbe0>]}
[0m16:41:27.632070 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:41:27.640151 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:41:27.644678 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:41:27.652599 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:41:27.717121 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:41:27.720328 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:41:27.722226 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:41:27.723146 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:41:27.724596 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:41:27.726909 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:41:27.729225 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:41:27.740822 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:41:27.743566 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:41:27.750274 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:41:27.754296 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:41:27.759160 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:41:27.762604 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:41:27.769340 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:41:27.779124 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:41:27.798178 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:41:27.825192 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:41:27.828033 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:41:27.841733 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:41:27.854253 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:41:27.931423 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:41:27.939116 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:41:27.950196 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:41:27.958952 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:41:27.962406 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:41:27.965950 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:41:27.969068 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:41:27.992937 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:41:28.013717 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:41:28.042528 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:41:28.054833 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:41:28.087346 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:41:28.089335 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:41:28.091294 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:41:28.093545 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:41:28.095556 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:41:28.097319 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:41:28.099261 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:41:28.101320 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:41:28.103613 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:41:28.105147 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:41:28.107322 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:41:28.111020 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:41:28.122556 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:41:28.124412 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:41:28.126594 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:41:28.128447 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:41:28.131042 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:41:28.132825 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:41:28.134346 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:41:28.137412 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:41:28.139104 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:41:28.140945 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:41:28.143157 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:41:28.144977 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:41:28.148806 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:41:28.151444 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:41:28.155738 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:41:28.158619 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:41:28.160242 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:41:28.161514 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:41:28.163972 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:41:28.165559 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:41:28.171580 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:41:28.195191 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:41:28.199657 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:41:28.203001 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:41:28.206615 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:41:28.219101 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:41:28.235417 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:41:28.243138 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:41:28.268088 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:41:28.277524 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:41:28.292159 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:41:28.302479 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:41:28.826414 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:41:28.866991 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:41:28.876695 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:41:28.885903 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_data.sql
[0m16:41:29.048251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863599900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8635799c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86357bd60>]}
[0m16:41:29.048824 [debug] [MainThread]: Flushing usage events
[0m16:41:44.062998 [error] [MainThread]: Encountered an error:
Compilation Error in model vehicle_data (models/traffic_data/vehicle_data.sql)
  Model 'model.dbt_traffic_data.vehicle_data' (models/traffic_data/vehicle_data.sql) depends on a source named 'traffic_data.test' which was not found


============================== 2023-01-01 16:42:11.012086 | 0a911c19-ea42-4e8d-a483-be05ec75e09b ==============================
[0m16:42:11.012109 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:42:11.012828 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:42:11.013119 [debug] [MainThread]: Tracking: tracking
[0m16:42:11.015429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3453db0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3453db190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3453db130>]}
[0m16:42:11.114878 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:42:11.115605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a911c19-ea42-4e8d-a483-be05ec75e09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3457d3f40>]}
[0m16:42:11.144024 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:42:11.149198 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:42:11.152092 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:42:11.158197 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:42:11.206401 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:42:11.209900 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:42:11.212036 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:42:11.213024 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:42:11.214259 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:42:11.216297 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:42:11.218800 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:42:11.232244 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:42:11.235297 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:42:11.242805 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:42:11.247324 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:42:11.252033 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:42:11.254578 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:42:11.261353 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:42:11.272463 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:42:11.294027 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:42:11.325870 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:42:11.329387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:42:11.346069 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:42:11.360173 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:42:11.437540 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:42:11.445151 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:42:11.455824 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:42:11.465515 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:42:11.469205 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:42:11.472832 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:42:11.476091 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:42:11.501452 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:42:11.524009 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:42:11.555241 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:42:11.571254 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:42:11.615065 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:42:11.618555 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:42:11.621492 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:42:11.625260 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:42:11.628585 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:42:11.631496 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:42:11.634788 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:42:11.638320 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:42:11.642219 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:42:11.644845 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:42:11.648619 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:42:11.654916 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:42:11.675264 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:42:11.678371 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:42:11.682069 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:42:11.685458 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:42:11.689189 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:42:11.691869 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:42:11.694233 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:42:11.697838 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:42:11.700643 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:42:11.703885 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:42:11.707969 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:42:11.711314 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:42:11.718408 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:42:11.722991 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:42:11.730573 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:42:11.735353 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:42:11.737422 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:42:11.739744 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:42:11.744812 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:42:11.746785 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:42:11.756214 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:42:11.801181 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:42:11.811036 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:42:11.818244 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:42:11.825759 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:42:11.850949 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:42:11.884822 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:42:11.900475 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:42:11.950037 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:42:11.970065 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:42:11.999130 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:42:12.020243 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:42:12.607748 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:42:12.635326 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:42:12.642211 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:42:12.648348 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_data.sql
[0m16:42:12.768648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34499d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34497dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34497e260>]}
[0m16:42:12.769285 [debug] [MainThread]: Flushing usage events
[0m16:42:19.097977 [error] [MainThread]: Encountered an error:
Compilation Error in model vehicle_data (models/traffic_data/vehicle_data.sql)
  Model 'model.dbt_traffic_data.vehicle_data' (models/traffic_data/vehicle_data.sql) depends on a source named 'traffic_data.test' which was not found


============================== 2023-01-01 16:42:42.459707 | 3044e06a-940f-46d1-9b8b-420486d48890 ==============================
[0m16:42:42.459733 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:42:42.460550 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:42:42.460867 [debug] [MainThread]: Tracking: tracking
[0m16:42:42.463263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bf4d30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bf4d3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bf4d3130>]}
[0m16:42:42.528962 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:42:42.530095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3044e06a-940f-46d1-9b8b-420486d48890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bf5f7d90>]}
[0m16:42:42.555706 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:42:42.561862 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:42:42.565705 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:42:42.570379 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:42:42.618116 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:42:42.621267 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:42:42.623218 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:42:42.624281 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:42:42.625841 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:42:42.628245 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:42:42.631349 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:42:42.643138 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:42:42.646636 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:42:42.653692 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:42:42.658273 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:42:42.663276 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:42:42.665652 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:42:42.671453 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:42:42.680968 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:42:42.699667 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:42:42.728777 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:42:42.731965 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:42:42.747617 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:42:42.761481 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:42:42.840954 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:42:42.848208 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:42:42.859082 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:42:42.868061 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:42:42.871630 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:42:42.875255 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:42:42.878490 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:42:42.903101 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:42:42.926137 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:42:42.955584 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:42:42.968508 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:42:43.006894 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:42:43.009505 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:42:43.012042 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:42:43.016035 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:42:43.019606 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:42:43.022393 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:42:43.025656 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:42:43.028183 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:42:43.031287 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:42:43.033688 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:42:43.037330 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:42:43.041358 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:42:43.053873 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:42:43.055762 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:42:43.057965 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:42:43.060060 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:42:43.062858 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:42:43.064847 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:42:43.066408 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:42:43.069693 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:42:43.071501 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:42:43.073366 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:42:43.075871 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:42:43.078057 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:42:43.083355 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:42:43.086145 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:42:43.090533 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:42:43.094104 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:42:43.095689 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:42:43.096984 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:42:43.099545 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:42:43.101104 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:42:43.107221 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:42:43.131710 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:42:43.136683 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:42:43.140327 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:42:43.145005 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:42:43.159125 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:42:43.178409 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:42:43.187194 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:42:43.214350 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:42:43.224828 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:42:43.240657 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:42:43.251734 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:42:43.750709 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:42:43.776973 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:42:43.783925 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:42:43.900371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bea0dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bea0dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bea0da50>]}
[0m16:42:43.901004 [debug] [MainThread]: Flushing usage events
[0m16:42:45.513641 [error] [MainThread]: Encountered an error:
Compilation Error in model max_speed (models/traffic_data/max_speed.sql)
  Model 'model.dbt_traffic_data.max_speed' (models/traffic_data/max_speed.sql) depends on a node named 'traffic_data' which was not found


============================== 2023-01-01 16:46:00.908135 | 56f26d0f-d524-4507-b729-a7127ebd35a0 ==============================
[0m16:46:00.908157 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:46:00.908913 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:46:00.909252 [debug] [MainThread]: Tracking: tracking
[0m16:46:00.911660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23dad30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23dad3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23dad3130>]}
[0m16:46:00.980829 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:46:00.981757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56f26d0f-d524-4507-b729-a7127ebd35a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23dbf7e80>]}
[0m16:46:01.017356 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:46:01.022714 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:46:01.026086 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:46:01.031927 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:46:01.082903 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:46:01.086857 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:46:01.088997 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:46:01.090020 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:46:01.091554 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:46:01.093920 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:46:01.097019 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:46:01.108815 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:46:01.111506 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:46:01.118309 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:46:01.122463 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:46:01.127271 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:46:01.130057 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:46:01.136492 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:46:01.146119 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:46:01.165019 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:46:01.192919 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:46:01.195976 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:46:01.210752 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:46:01.223447 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:46:01.299850 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:46:01.307514 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:46:01.318325 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:46:01.327037 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:46:01.331608 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:46:01.336903 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:46:01.341971 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:46:01.382238 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:46:01.415296 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:46:01.454537 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:46:01.467819 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:46:01.501702 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:46:01.503902 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:46:01.505711 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:46:01.507971 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:46:01.509970 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:46:01.511760 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:46:01.513817 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:46:01.515999 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:46:01.518329 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:46:01.519940 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:46:01.522204 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:46:01.525876 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:46:01.537947 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:46:01.540033 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:46:01.542410 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:46:01.544497 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:46:01.547458 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:46:01.549550 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:46:01.551339 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:46:01.555368 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:46:01.558237 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:46:01.560496 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:46:01.563585 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:46:01.566230 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:46:01.571309 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:46:01.574255 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:46:01.578946 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:46:01.581834 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:46:01.583608 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:46:01.584996 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:46:01.587542 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:46:01.589122 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:46:01.595518 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:46:01.622932 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:46:01.628570 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:46:01.633634 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:46:01.638143 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:46:01.652162 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:46:01.672223 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:46:01.681798 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:46:01.713737 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:46:01.724606 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:46:01.741496 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:46:01.752969 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:46:02.267102 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:46:02.295715 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:46:02.302497 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:46:02.434881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23d0e1cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23d0e2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23d0e0760>]}
[0m16:46:02.435504 [debug] [MainThread]: Flushing usage events
[0m16:46:15.257630 [error] [MainThread]: Encountered an error:
Compilation Error in model max_speed (models/traffic_data/max_speed.sql)
  Model 'model.dbt_traffic_data.max_speed' (models/traffic_data/max_speed.sql) depends on a node named 'traffic_data' which was not found


============================== 2023-01-01 16:46:30.576832 | 446b2573-30e8-4ebd-9730-100e2a999bcc ==============================
[0m16:46:30.576854 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:46:30.577559 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:46:30.577846 [debug] [MainThread]: Tracking: tracking
[0m16:46:30.580242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f34e30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f34e3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f34e3130>]}
[0m16:46:30.650999 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:46:30.651737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f3407e20>]}
[0m16:46:30.678577 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:46:30.685501 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:46:30.689859 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:46:30.696957 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:46:30.763282 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:46:30.767034 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:46:30.769117 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:46:30.770131 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:46:30.771598 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:46:30.774095 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:46:30.776967 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:46:30.789524 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:46:30.792501 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:46:30.799999 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:46:30.804223 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:46:30.808474 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:46:30.811031 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:46:30.817231 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:46:30.826934 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:46:30.846070 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:46:30.873635 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:46:30.876467 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:46:30.890878 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:46:30.903687 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:46:30.980395 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:46:30.988047 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:46:30.999739 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:46:31.009382 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:46:31.013623 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:46:31.017937 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:46:31.021651 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:46:31.049285 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:46:31.073374 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:46:31.104367 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:46:31.117186 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:46:31.150808 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:46:31.153045 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:46:31.154870 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:46:31.157105 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:46:31.159094 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:46:31.160833 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:46:31.162958 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:46:31.165159 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:46:31.167454 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:46:31.168952 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:46:31.171421 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:46:31.175231 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:46:31.186988 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:46:31.188760 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:46:31.190946 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:46:31.193009 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:46:31.195879 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:46:31.197850 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:46:31.199430 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:46:31.202686 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:46:31.204520 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:46:31.206489 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:46:31.208723 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:46:31.210711 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:46:31.215115 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:46:31.217880 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:46:31.222414 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:46:31.225276 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:46:31.226854 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:46:31.228147 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:46:31.230808 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:46:31.232468 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:46:31.238738 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:46:31.263127 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:46:31.268564 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:46:31.272394 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:46:31.276310 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:46:31.289194 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:46:31.306736 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:46:31.314706 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:46:31.340927 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:46:31.351026 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:46:31.366242 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:46:31.377295 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:46:31.889443 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:46:31.924385 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:46:32.093070 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_traffic_data.traffic_data

[0m16:46:32.104558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1ce67d0>]}
[0m16:46:32.118681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f34e3190>]}
[0m16:46:32.119335 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:46:32.119909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f2a2bca0>]}
[0m16:46:32.123043 [info ] [MainThread]: 
[0m16:46:32.124699 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:46:32.127160 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:46:32.151048 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:46:32.151518 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:46:32.151829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:32.169587 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:46:32.172732 [debug] [ThreadPool]: On list_test: Close
[0m16:46:32.176285 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:46:32.188898 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:46:32.189537 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:46:32.189993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:32.206399 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:46:32.206905 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:46:32.207218 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:46:32.215637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:46:32.218096 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:46:32.220237 [debug] [ThreadPool]: On list_test_public: Close
[0m16:46:32.233965 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:32.234649 [debug] [MainThread]: On master: BEGIN
[0m16:46:32.235131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:32.251480 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:46:32.251987 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:32.252318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:32.276998 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:46:32.280878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1d073d0>]}
[0m16:46:32.281744 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:32.286234 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:32.286896 [debug] [MainThread]: On master: BEGIN
[0m16:46:32.330778 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:46:32.331607 [debug] [MainThread]: On master: COMMIT
[0m16:46:32.332185 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:32.332696 [debug] [MainThread]: On master: COMMIT
[0m16:46:32.335448 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:32.336097 [debug] [MainThread]: On master: Close
[0m16:46:32.337923 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:46:32.338900 [info ] [MainThread]: 
[0m16:46:32.346182 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:46:32.346978 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:46:32.348513 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.348970 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:46:32.349327 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:46:32.355578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.356491 [debug] [Thread-1 (]: finished collecting timing info
[0m16:46:32.356922 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:46:32.455197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.456060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.456441 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:46:32.456732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:32.475109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:46:32.475625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.475942 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:46:32.481061 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:46:32.494736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.495288 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:46:32.499218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:32.511962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.512685 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:46:32.516180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:32.571913 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:46:32.572660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.573132 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:46:32.579549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:46:32.590518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:46:32.590988 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:46:32.634792 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:46:32.639449 [debug] [Thread-1 (]: finished collecting timing info
[0m16:46:32.640297 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:46:32.642646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1bc2d10>]}
[0m16:46:32.644040 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.29s]
[0m16:46:32.645773 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:46:32.647423 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:46:32.648605 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:46:32.650913 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.651663 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:46:32.652284 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:46:32.659604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.660533 [debug] [Thread-1 (]: finished collecting timing info
[0m16:46:32.661201 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:46:32.712784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.713711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.714114 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:46:32.714463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:32.732964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:46:32.733535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.733885 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:46:32.740555 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:46:32.746843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.747314 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:46:32.750194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:32.754316 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:46:32.754880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.755246 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:46:32.761213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:46:32.766472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:46:32.766941 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:46:32.770148 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:32.773075 [debug] [Thread-1 (]: finished collecting timing info
[0m16:46:32.773548 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:46:32.774829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446b2573-30e8-4ebd-9730-100e2a999bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1cdcb50>]}
[0m16:46:32.775629 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m16:46:32.776673 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:46:32.779124 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:46:32.779605 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:32.779936 [debug] [MainThread]: On master: BEGIN
[0m16:46:32.780240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:32.797181 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:46:32.797757 [debug] [MainThread]: On master: COMMIT
[0m16:46:32.798088 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:32.798459 [debug] [MainThread]: On master: COMMIT
[0m16:46:32.800506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:32.800973 [debug] [MainThread]: On master: Close
[0m16:46:32.802286 [info ] [MainThread]: 
[0m16:46:32.803006 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:46:32.803593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:32.803935 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:46:32.818326 [info ] [MainThread]: 
[0m16:46:32.819075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:32.819727 [info ] [MainThread]: 
[0m16:46:32.820471 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:46:32.821728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1cdd8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1c11ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1d2a230>]}
[0m16:46:32.822566 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:47:21.832517 | 9246806e-fa37-4cff-be95-663a5ad58ea2 ==============================
[0m16:47:21.832539 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:47:21.833210 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:47:21.833484 [debug] [MainThread]: Tracking: tracking
[0m16:47:21.835430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88693eb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88693e8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88693ebfa0>]}
[0m16:47:21.900165 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:47:21.900918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886930fd90>]}
[0m16:47:21.927161 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m16:47:21.932746 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:47:21.936227 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:47:21.940723 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:47:21.987733 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:47:21.990893 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m16:47:21.992791 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:47:21.993703 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:47:21.994858 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:47:21.997196 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:47:21.999572 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:47:22.011217 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:47:22.013915 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:47:22.022002 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:47:22.026436 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:47:22.030884 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:47:22.033440 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:47:22.039612 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:47:22.049385 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:47:22.068141 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:47:22.094860 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:47:22.097784 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:47:22.111428 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:47:22.171262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:47:22.205966 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:47:22.212962 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:47:22.223473 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:47:22.231940 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:47:22.235282 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:47:22.238626 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:47:22.241536 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:47:22.265394 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:47:22.286457 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:47:22.314554 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:47:22.326291 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:47:22.358182 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:47:22.360387 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:47:22.362247 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:47:22.364658 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:47:22.366617 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:47:22.368279 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:47:22.370135 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:47:22.372019 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:47:22.374186 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:47:22.375621 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:47:22.377731 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:47:22.381566 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:47:22.393511 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:47:22.395960 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:47:22.399314 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:47:22.402438 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:47:22.406646 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:47:22.409765 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:47:22.412235 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:47:22.417691 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:47:22.420613 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:47:22.423172 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:47:22.425524 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:47:22.427699 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:47:22.433149 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:47:22.435993 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:47:22.441147 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:47:22.444861 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:47:22.446439 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:47:22.447796 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:47:22.450360 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:47:22.451952 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:47:22.458411 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:47:22.483434 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:47:22.488882 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:47:22.492706 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:47:22.496662 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:47:22.515012 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:47:22.532841 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:47:22.540699 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:47:22.567479 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:47:22.577809 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:47:22.592872 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:47:22.604502 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:47:23.055223 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:47:23.078457 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:47:23.239245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8868963be0>]}
[0m16:47:23.252410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88693eb7c0>]}
[0m16:47:23.253029 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:47:23.253630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886894c040>]}
[0m16:47:23.255912 [info ] [MainThread]: 
[0m16:47:23.257281 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:47:23.259203 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:47:23.291294 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:47:23.292058 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:47:23.292553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:23.313501 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:47:23.316322 [debug] [ThreadPool]: On list_test: Close
[0m16:47:23.319088 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:47:23.332528 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:47:23.333024 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:47:23.333328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:23.347573 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:47:23.348100 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:47:23.348444 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:47:23.354426 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:47:23.356908 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:47:23.359358 [debug] [ThreadPool]: On list_test_public: Close
[0m16:47:23.368920 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:23.369355 [debug] [MainThread]: On master: BEGIN
[0m16:47:23.369631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:23.383087 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:47:23.383575 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:23.383869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:23.409119 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:47:23.411778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8868954820>]}
[0m16:47:23.412373 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:23.414408 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:23.414800 [debug] [MainThread]: On master: BEGIN
[0m16:47:23.418540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:23.418978 [debug] [MainThread]: On master: COMMIT
[0m16:47:23.419283 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:23.419563 [debug] [MainThread]: On master: COMMIT
[0m16:47:23.421003 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:47:23.421401 [debug] [MainThread]: On master: Close
[0m16:47:23.422545 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:47:23.423389 [info ] [MainThread]: 
[0m16:47:23.429510 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:47:23.430326 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:47:23.432411 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.432832 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:47:23.433146 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:47:23.438424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.439227 [debug] [Thread-1 (]: finished collecting timing info
[0m16:47:23.439637 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:47:23.522524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.523267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.523581 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:47:23.523828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:23.543423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:47:23.543901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.544204 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:47:23.548257 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:47:23.560843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.561217 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:47:23.565319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:23.572410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.572779 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:47:23.575659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:23.621216 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:47:23.621684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.621976 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:47:23.628126 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:47:23.638766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:47:23.639202 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:47:23.686734 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:47:23.688964 [debug] [Thread-1 (]: finished collecting timing info
[0m16:47:23.689351 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:47:23.690422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88639f7490>]}
[0m16:47:23.691113 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m16:47:23.691944 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:47:23.693159 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:47:23.693700 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:47:23.694984 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.695397 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:47:23.695855 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:47:23.702175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.702926 [debug] [Thread-1 (]: finished collecting timing info
[0m16:47:23.703310 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:47:23.761005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.762391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.763033 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:47:23.763568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:23.826759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:47:23.827240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.827524 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:47:23.833965 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:47:23.839441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.839835 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:47:23.843095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:23.846409 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:47:23.846812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.847168 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:47:23.852392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:47:23.856439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:47:23.856804 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:47:23.859551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:47:23.861642 [debug] [Thread-1 (]: finished collecting timing info
[0m16:47:23.862048 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:47:23.863225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9246806e-fa37-4cff-be95-663a5ad58ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88639b3610>]}
[0m16:47:23.863961 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.17s]
[0m16:47:23.864974 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:47:23.867314 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:47:23.867846 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:23.868204 [debug] [MainThread]: On master: BEGIN
[0m16:47:23.868603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:23.926775 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:47:23.927270 [debug] [MainThread]: On master: COMMIT
[0m16:47:23.927551 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:23.927810 [debug] [MainThread]: On master: COMMIT
[0m16:47:23.931301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:47:23.931810 [debug] [MainThread]: On master: Close
[0m16:47:23.932983 [info ] [MainThread]: 
[0m16:47:23.933752 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:47:23.934296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:23.934604 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:47:23.949733 [info ] [MainThread]: 
[0m16:47:23.950458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:23.951263 [info ] [MainThread]: 
[0m16:47:23.951862 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:47:23.952578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886182d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886182fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886182e4a0>]}
[0m16:47:23.953131 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:49:03.593678 | 2f15ff30-d916-4126-acf2-3a8272727f2e ==============================
[0m16:49:03.593703 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:49:03.594482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:49:03.594930 [debug] [MainThread]: Tracking: tracking
[0m16:49:03.597319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c1ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c1ef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c1eff70>]}
[0m16:49:03.685276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:49:03.686009 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/My_model.sql
[0m16:49:03.769840 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/My_model.sql
[0m16:49:03.837182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836b7134c0>]}
[0m16:49:03.850823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836b6dfee0>]}
[0m16:49:03.851449 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:49:03.851999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836b6dfc40>]}
[0m16:49:03.854846 [info ] [MainThread]: 
[0m16:49:03.856316 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:49:03.858860 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:49:03.882938 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:49:03.883527 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:49:03.883846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:03.902245 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:49:03.904582 [debug] [ThreadPool]: On list_test: Close
[0m16:49:03.907822 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:49:03.925080 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:49:03.925585 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:49:03.925874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:03.987867 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:49:03.988415 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:49:03.988736 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:49:03.996123 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:49:03.999094 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:49:04.008598 [debug] [ThreadPool]: On list_test_public: Close
[0m16:49:04.022440 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:04.023131 [debug] [MainThread]: On master: BEGIN
[0m16:49:04.023636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:04.086652 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:49:04.087366 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:04.087709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:04.141266 [debug] [MainThread]: SQL status: SELECT 3 in 0.05 seconds
[0m16:49:04.144945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a59b4c0>]}
[0m16:49:04.145670 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:04.147942 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:04.148529 [debug] [MainThread]: On master: BEGIN
[0m16:49:04.199251 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:49:04.199953 [debug] [MainThread]: On master: COMMIT
[0m16:49:04.200380 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:04.200748 [debug] [MainThread]: On master: COMMIT
[0m16:49:04.203655 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:04.204153 [debug] [MainThread]: On master: Close
[0m16:49:04.205273 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:49:04.205905 [info ] [MainThread]: 
[0m16:49:04.211561 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:49:04.212415 [info ] [Thread-1 (]: 1 of 3 START sql view model public.My_model .................................... [RUN]
[0m16:49:04.213838 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:04.214333 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:49:04.214798 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:49:04.221427 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:49:04.222322 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:04.222763 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:49:04.321737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:49:04.322627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:04.322974 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:49:04.323304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:04.434683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.11 seconds
[0m16:49:04.435174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:04.435459 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        vehicle_type,
        cast(traveled_d as float) as traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        loan_acc,
        lat_acc,
        record_time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:49:04.482732 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vehicle_type" does not exist
LINE 11:         vehicle_type,
                 ^

[0m16:49:04.483450 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: ROLLBACK
[0m16:49:04.486459 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:04.486898 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:49:04.488267 [debug] [Thread-1 (]: Database Error in model My_model (models/traffic_data/My_model.sql)
  column "vehicle_type" does not exist
  LINE 11:         vehicle_type,
                   ^
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/My_model.sql
[0m16:49:04.489102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a5b8670>]}
[0m16:49:04.490140 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.My_model ........................... [[31mERROR[0m in 0.28s]
[0m16:49:04.491342 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:49:04.491844 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:04.492704 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:49:04.494282 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.494672 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:04.495142 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:49:04.503497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.504526 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:04.505136 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:04.570205 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.571105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.571513 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:49:04.571915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:04.636896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:49:04.637674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.638228 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:49:04.642736 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:49:04.662288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.662808 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:49:04.665554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:04.671362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.671757 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:49:04.675870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:04.730042 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:49:04.730526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.730831 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:49:04.735804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:49:04.747053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:04.747481 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:49:04.790800 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:49:04.793195 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:04.793641 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:49:04.794933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a662f80>]}
[0m16:49:04.795704 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.30s]
[0m16:49:04.796593 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:04.798078 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:04.798856 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:49:04.800433 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:04.800872 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:04.801262 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:49:04.808721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:04.809499 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:04.809971 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:04.821017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:04.821899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:04.822344 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:49:04.822627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:05.018747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.2 seconds
[0m16:49:05.019236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:05.019519 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:49:05.024730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:49:05.030212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:05.030608 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:49:05.034174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:05.040220 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:49:05.040830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:05.041336 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:49:05.055815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:49:05.059980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:05.060354 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:49:05.063090 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:05.065946 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:05.066460 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:49:05.067921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f15ff30-d916-4126-acf2-3a8272727f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a5cd420>]}
[0m16:49:05.068898 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:49:05.069855 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:05.073955 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:49:05.074739 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:05.075283 [debug] [MainThread]: On master: BEGIN
[0m16:49:05.075777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:05.096918 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:49:05.097517 [debug] [MainThread]: On master: COMMIT
[0m16:49:05.097855 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:05.098238 [debug] [MainThread]: On master: COMMIT
[0m16:49:05.101049 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:05.101628 [debug] [MainThread]: On master: Close
[0m16:49:05.103112 [info ] [MainThread]: 
[0m16:49:05.103870 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m16:49:05.104447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:05.104731 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:49:05.122105 [info ] [MainThread]: 
[0m16:49:05.122776 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:49:05.123310 [info ] [MainThread]: 
[0m16:49:05.123805 [error] [MainThread]: [33mDatabase Error in model My_model (models/traffic_data/My_model.sql)[0m
[0m16:49:05.124336 [error] [MainThread]:   column "vehicle_type" does not exist
[0m16:49:05.124799 [error] [MainThread]:   LINE 11:         vehicle_type,
[0m16:49:05.125590 [error] [MainThread]:                    ^
[0m16:49:05.126165 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/My_model.sql
[0m16:49:05.126873 [info ] [MainThread]: 
[0m16:49:05.127460 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:49:05.128329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836b712f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836847f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836847e0e0>]}
[0m16:49:05.129019 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:49:38.894743 | 8ac04ece-7c6a-453c-a9cd-becc36525936 ==============================
[0m16:49:38.894766 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:49:38.895456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:49:38.895756 [debug] [MainThread]: Tracking: tracking
[0m16:49:38.897828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8aed3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8aed3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8aed3fd0>]}
[0m16:49:38.990466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:49:38.991297 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/My_model.sql
[0m16:49:39.062619 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/My_model.sql
[0m16:49:39.123312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8a5000d0>]}
[0m16:49:39.136428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8a46b910>]}
[0m16:49:39.137066 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:49:39.137608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8aff5330>]}
[0m16:49:39.140310 [info ] [MainThread]: 
[0m16:49:39.142203 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:49:39.144616 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:49:39.168395 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:49:39.168871 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:49:39.169160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:39.187982 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:49:39.192044 [debug] [ThreadPool]: On list_test: Close
[0m16:49:39.196020 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:49:39.211559 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:49:39.212024 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:49:39.212313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:39.226120 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:49:39.226616 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:49:39.226940 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:49:39.233686 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:49:39.236450 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:49:39.238450 [debug] [ThreadPool]: On list_test_public: Close
[0m16:49:39.248379 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:39.248824 [debug] [MainThread]: On master: BEGIN
[0m16:49:39.249200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:39.262835 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:49:39.263297 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:39.263603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:39.291664 [debug] [MainThread]: SQL status: SELECT 3 in 0.03 seconds
[0m16:49:39.295439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8952b040>]}
[0m16:49:39.296251 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:39.298188 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:39.298784 [debug] [MainThread]: On master: BEGIN
[0m16:49:39.303232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:39.303809 [debug] [MainThread]: On master: COMMIT
[0m16:49:39.304239 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:39.304644 [debug] [MainThread]: On master: COMMIT
[0m16:49:39.306244 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:39.306792 [debug] [MainThread]: On master: Close
[0m16:49:39.308331 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:49:39.309150 [info ] [MainThread]: 
[0m16:49:39.316094 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:49:39.316949 [info ] [Thread-1 (]: 1 of 3 START sql view model public.My_model .................................... [RUN]
[0m16:49:39.318736 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:39.319323 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:49:39.319812 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:49:39.327799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:49:39.328797 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:39.329362 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:49:39.422709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:49:39.423536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:39.423875 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:49:39.424135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:39.482665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:49:39.483211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:39.483672 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        cast(traveled_d as float) as traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        loan_acc,
        lat_acc,
        record_time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:49:39.487330 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "loan_acc" does not exist
LINE 17:         loan_acc,
                 ^
HINT:  Perhaps you meant to reference the column "source_data_cast.lon_acc".

[0m16:49:39.487757 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: ROLLBACK
[0m16:49:39.492222 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:39.492633 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:49:39.493726 [debug] [Thread-1 (]: Database Error in model My_model (models/traffic_data/My_model.sql)
  column "loan_acc" does not exist
  LINE 17:         loan_acc,
                   ^
  HINT:  Perhaps you meant to reference the column "source_data_cast.lon_acc".
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/My_model.sql
[0m16:49:39.494314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a895446d0>]}
[0m16:49:39.494966 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.My_model ........................... [[31mERROR[0m in 0.18s]
[0m16:49:39.495771 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:49:39.496165 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:39.496816 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:49:39.497979 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.498579 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:39.499056 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:49:39.505486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.506174 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:39.506640 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:39.559737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.560859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.561237 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:49:39.561505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:39.622876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:49:39.623905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.624555 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:49:39.630812 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:49:39.657966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.658867 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:49:39.663019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:39.676793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.677560 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:49:39.682805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:39.730689 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:49:39.731142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.731462 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:49:39.737457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:49:39.747754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:39.748145 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:49:39.794640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:49:39.797062 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:39.797514 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:49:39.798796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a895f6fe0>]}
[0m16:49:39.799679 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.30s]
[0m16:49:39.800875 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:39.802421 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:39.802945 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:49:39.804425 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.804924 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:39.805351 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:49:39.811575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.812251 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:39.812601 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:39.820630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.821378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.821722 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:49:39.822039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:39.891134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:49:39.892359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.892754 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:49:39.898468 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:49:39.904331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.904746 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:49:39.909404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:39.913107 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:49:39.913541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.913840 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:49:39.920400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:49:39.924562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:49:39.924985 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:49:39.927494 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:39.929758 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:39.930171 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:49:39.931281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac04ece-7c6a-453c-a9cd-becc36525936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a895565c0>]}
[0m16:49:39.932011 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:49:39.933242 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:49:39.936015 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:49:39.936482 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:39.936935 [debug] [MainThread]: On master: BEGIN
[0m16:49:39.937283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:39.994649 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:49:39.995153 [debug] [MainThread]: On master: COMMIT
[0m16:49:39.995460 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:39.995734 [debug] [MainThread]: On master: COMMIT
[0m16:49:39.998027 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:39.998463 [debug] [MainThread]: On master: Close
[0m16:49:39.999670 [info ] [MainThread]: 
[0m16:49:40.000367 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:49:40.001043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:40.001606 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:49:40.020931 [info ] [MainThread]: 
[0m16:49:40.021953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:49:40.022887 [info ] [MainThread]: 
[0m16:49:40.023653 [error] [MainThread]: [33mDatabase Error in model My_model (models/traffic_data/My_model.sql)[0m
[0m16:49:40.024409 [error] [MainThread]:   column "loan_acc" does not exist
[0m16:49:40.025061 [error] [MainThread]:   LINE 17:         loan_acc,
[0m16:49:40.025776 [error] [MainThread]:                    ^
[0m16:49:40.026565 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "source_data_cast.lon_acc".
[0m16:49:40.027326 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/My_model.sql
[0m16:49:40.028119 [info ] [MainThread]: 
[0m16:49:40.028886 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:49:40.029889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a89611600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a89610910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a89610160>]}
[0m16:49:40.030658 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:49:59.058995 | 3372f62b-3ecc-4bac-a39f-86fd63eaeaa1 ==============================
[0m16:49:59.059017 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:49:59.059739 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:49:59.060039 [debug] [MainThread]: Tracking: tracking
[0m16:49:59.062389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26532d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26532d4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26532d4bb0>]}
[0m16:49:59.182028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:49:59.182905 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/My_model.sql
[0m16:49:59.254402 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/My_model.sql
[0m16:49:59.315099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26528dc0d0>]}
[0m16:49:59.328564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26547e1f30>]}
[0m16:49:59.329199 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:49:59.329744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26533f9e10>]}
[0m16:49:59.332149 [info ] [MainThread]: 
[0m16:49:59.333547 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:49:59.335446 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:49:59.360915 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:49:59.361794 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:49:59.362331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:59.385252 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:49:59.387675 [debug] [ThreadPool]: On list_test: Close
[0m16:49:59.391843 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:49:59.406385 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:49:59.406979 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:49:59.407283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:59.427102 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:49:59.427846 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:49:59.428399 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:49:59.437373 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:49:59.441470 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:49:59.444217 [debug] [ThreadPool]: On list_test_public: Close
[0m16:49:59.453314 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:59.453737 [debug] [MainThread]: On master: BEGIN
[0m16:49:59.454031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:59.510643 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:49:59.511092 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:59.511353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:59.535055 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m16:49:59.537891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265170b040>]}
[0m16:49:59.538594 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:59.541320 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:59.541728 [debug] [MainThread]: On master: BEGIN
[0m16:49:59.586678 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:49:59.587178 [debug] [MainThread]: On master: COMMIT
[0m16:49:59.587455 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:59.587709 [debug] [MainThread]: On master: COMMIT
[0m16:49:59.642633 [debug] [MainThread]: SQL status: COMMIT in 0.05 seconds
[0m16:49:59.643152 [debug] [MainThread]: On master: Close
[0m16:49:59.644194 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:49:59.644796 [info ] [MainThread]: 
[0m16:49:59.649790 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:49:59.650743 [info ] [Thread-1 (]: 1 of 3 START sql view model public.My_model .................................... [RUN]
[0m16:49:59.652471 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:59.652944 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:49:59.653265 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:49:59.659144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:49:59.659851 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:59.660208 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:49:59.746489 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:49:59.747289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:59.747623 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:49:59.747888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:59.765903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:49:59.766567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:49:59.766902 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        cast(traveled_d as float) as traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        record_time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:49:59.770570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "record_time" does not exist
LINE 19:         record_time
                 ^

[0m16:49:59.771002 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: ROLLBACK
[0m16:49:59.773181 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:59.773594 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:49:59.774709 [debug] [Thread-1 (]: Database Error in model My_model (models/traffic_data/My_model.sql)
  column "record_time" does not exist
  LINE 19:         record_time
                   ^
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/My_model.sql
[0m16:49:59.775294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2651724700>]}
[0m16:49:59.776006 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.My_model ........................... [[31mERROR[0m in 0.12s]
[0m16:49:59.776954 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:49:59.777429 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:59.778198 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:49:59.779455 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.779877 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:59.780261 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:49:59.787145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.787981 [debug] [Thread-1 (]: finished collecting timing info
[0m16:49:59.788441 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:49:59.859415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.860799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.861476 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:49:59.862031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:59.930757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:49:59.931259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.931554 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:49:59.938737 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:49:59.954141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.954600 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:49:59.957960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:59.963029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:49:59.963417 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:49:59.966704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:00.012221 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:50:00.012704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:00.012978 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:50:00.019143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:00.029453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:00.029892 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:50:00.074712 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:50:00.077067 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:00.077486 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:50:00.078651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26517db010>]}
[0m16:50:00.079332 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.30s]
[0m16:50:00.080169 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:00.081414 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:00.081894 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:50:00.083292 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.083791 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:00.084252 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:50:00.091044 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.091795 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:00.092213 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:00.100953 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.101822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.102313 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:50:00.102753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:00.174704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:50:00.175378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.175888 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:50:00.182335 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:50:00.188484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.189082 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:50:00.193374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:00.197020 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:50:00.197442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.197734 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:50:00.205320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:00.209886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:00.210334 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:50:00.214993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:00.218212 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:00.218719 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:50:00.220220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3372f62b-3ecc-4bac-a39f-86fd63eaeaa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2651736590>]}
[0m16:50:00.221091 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.14s]
[0m16:50:00.222131 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:00.225168 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:50:00.225938 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:00.226617 [debug] [MainThread]: On master: BEGIN
[0m16:50:00.227172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:00.298685 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m16:50:00.299282 [debug] [MainThread]: On master: COMMIT
[0m16:50:00.299642 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:00.299969 [debug] [MainThread]: On master: COMMIT
[0m16:50:00.302900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:00.303416 [debug] [MainThread]: On master: Close
[0m16:50:00.304874 [info ] [MainThread]: 
[0m16:50:00.305658 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:50:00.306565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:00.307062 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:50:00.323902 [info ] [MainThread]: 
[0m16:50:00.324629 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:00.325439 [info ] [MainThread]: 
[0m16:50:00.326201 [error] [MainThread]: [33mDatabase Error in model My_model (models/traffic_data/My_model.sql)[0m
[0m16:50:00.327041 [error] [MainThread]:   column "record_time" does not exist
[0m16:50:00.327881 [error] [MainThread]:   LINE 19:         record_time
[0m16:50:00.328383 [error] [MainThread]:                    ^
[0m16:50:00.328851 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/My_model.sql
[0m16:50:00.329393 [info ] [MainThread]: 
[0m16:50:00.329984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:50:00.330762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26517f5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26517f6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26517f7ee0>]}
[0m16:50:00.331317 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:50:19.264602 | 8d23a8a1-5b6c-43db-881e-264e64bae030 ==============================
[0m16:50:19.264631 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:50:19.265516 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:50:19.265814 [debug] [MainThread]: Tracking: tracking
[0m16:50:19.267843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f2d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f2d7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f2d7f70>]}
[0m16:50:19.355853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:50:19.356743 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/My_model.sql
[0m16:50:19.427762 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/My_model.sql
[0m16:50:19.487426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e85c040>]}
[0m16:50:19.500659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e7cb880>]}
[0m16:50:19.501278 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:50:19.501845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f3f9d80>]}
[0m16:50:19.504350 [info ] [MainThread]: 
[0m16:50:19.505855 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:50:19.507875 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:50:19.530652 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:50:19.531120 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:50:19.531409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:19.549580 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:50:19.552078 [debug] [ThreadPool]: On list_test: Close
[0m16:50:19.555478 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:50:19.570261 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:50:19.570706 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:50:19.571112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:19.630675 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m16:50:19.631162 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:50:19.631454 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:50:19.638473 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m16:50:19.640930 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:50:19.643337 [debug] [ThreadPool]: On list_test_public: Close
[0m16:50:19.655325 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.655825 [debug] [MainThread]: On master: BEGIN
[0m16:50:19.656137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:19.671714 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:50:19.672217 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.672515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:19.698933 [debug] [MainThread]: SQL status: SELECT 3 in 0.03 seconds
[0m16:50:19.703510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7da8ef80>]}
[0m16:50:19.704509 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:19.707751 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.708328 [debug] [MainThread]: On master: BEGIN
[0m16:50:19.754711 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:50:19.755364 [debug] [MainThread]: On master: COMMIT
[0m16:50:19.755745 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.756083 [debug] [MainThread]: On master: COMMIT
[0m16:50:19.759247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:19.759859 [debug] [MainThread]: On master: Close
[0m16:50:19.761293 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:50:19.762362 [info ] [MainThread]: 
[0m16:50:19.769484 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:50:19.770315 [info ] [Thread-1 (]: 1 of 3 START sql view model public.My_model .................................... [RUN]
[0m16:50:19.772134 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:19.772680 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:50:19.773075 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:50:19.779577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:50:19.780483 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:19.780948 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:50:19.900494 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:50:19.901355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:19.901705 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:50:19.901984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:19.962620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:50:19.963104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:19.963398 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        cast(traveled_d as float) as traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:50:19.974856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:50:19.985987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:19.986380 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:50:19.990624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:20.020426 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:50:20.020791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:20.021083 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:50:20.025768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:50:20.034787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:20.035148 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:50:20.037845 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:20.040064 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:20.040439 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:50:20.041506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7db305b0>]}
[0m16:50:20.042191 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:50:20.043076 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:50:20.043522 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:20.044255 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:50:20.045667 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.046030 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:20.046371 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:50:20.054251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.054989 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:20.055347 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:20.106667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.107853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.108399 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:50:20.108746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:20.166746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:50:20.167204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.167462 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:50:20.172331 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:50:20.177462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.177814 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:50:20.180666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:20.185315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.185672 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:50:20.188434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:20.204967 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:50:20.205377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.205678 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:50:20.212251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:20.218940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:20.219556 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:50:20.266768 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:50:20.270335 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:20.270975 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:50:20.272577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7daa84c0>]}
[0m16:50:20.273659 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m16:50:20.275055 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:20.276453 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:20.276990 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:50:20.278270 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.278760 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:20.279169 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:50:20.285089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.285807 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:20.286185 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:20.295162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.296111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.296475 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:50:20.296739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:20.314016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:50:20.314574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.314893 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:50:20.320401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:50:20.326804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.327263 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:50:20.330871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:20.335305 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:50:20.335705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.336002 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:50:20.342810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:20.347162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:20.347591 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:50:20.350345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:20.352518 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:20.352940 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:50:20.354206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d23a8a1-5b6c-43db-881e-264e64bae030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f2d3460>]}
[0m16:50:20.355185 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:50:20.356421 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:20.359515 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:50:20.360252 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:20.360769 [debug] [MainThread]: On master: BEGIN
[0m16:50:20.361235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:20.430693 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m16:50:20.431211 [debug] [MainThread]: On master: COMMIT
[0m16:50:20.431510 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:20.431770 [debug] [MainThread]: On master: COMMIT
[0m16:50:20.434127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:20.434565 [debug] [MainThread]: On master: Close
[0m16:50:20.435644 [info ] [MainThread]: 
[0m16:50:20.436223 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m16:50:20.436938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:20.437370 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:50:20.451525 [info ] [MainThread]: 
[0m16:50:20.452186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:20.452963 [info ] [MainThread]: 
[0m16:50:20.453625 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:50:20.454450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7c186350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7c1869b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7c187610>]}
[0m16:50:20.455014 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:50:33.856688 | 814c0404-6d52-461a-9401-49f3039fad2d ==============================
[0m16:50:33.856713 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:50:33.857608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:50:33.858331 [debug] [MainThread]: Tracking: tracking
[0m16:50:33.860761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8d1eb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8d1ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8d1ebfd0>]}
[0m16:50:33.953670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:50:33.954582 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/My_model.sql
[0m16:50:34.039864 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/My_model.sql
[0m16:50:34.109822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8c8080d0>]}
[0m16:50:34.123778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8c77b910>]}
[0m16:50:34.124459 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:50:34.125024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8d10d330>]}
[0m16:50:34.127701 [info ] [MainThread]: 
[0m16:50:34.129077 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:50:34.131066 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:50:34.154751 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:50:34.155276 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:50:34.155588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:34.174394 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:50:34.177122 [debug] [ThreadPool]: On list_test: Close
[0m16:50:34.180943 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:50:34.193737 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:50:34.194222 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:50:34.194525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:34.210747 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:50:34.211212 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:50:34.211503 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:50:34.217810 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m16:50:34.220116 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:50:34.222761 [debug] [ThreadPool]: On list_test_public: Close
[0m16:50:34.231877 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:34.232291 [debug] [MainThread]: On master: BEGIN
[0m16:50:34.232602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:34.247028 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:50:34.247498 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:34.247780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:34.272824 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
[0m16:50:34.275311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8c047040>]}
[0m16:50:34.275872 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:34.277850 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:34.278267 [debug] [MainThread]: On master: BEGIN
[0m16:50:34.281169 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:34.281671 [debug] [MainThread]: On master: COMMIT
[0m16:50:34.282081 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:34.282356 [debug] [MainThread]: On master: COMMIT
[0m16:50:34.283898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:34.284244 [debug] [MainThread]: On master: Close
[0m16:50:34.285355 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:50:34.285952 [info ] [MainThread]: 
[0m16:50:34.291806 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:50:34.292507 [info ] [Thread-1 (]: 1 of 3 START sql view model public.My_model .................................... [RUN]
[0m16:50:34.294031 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.294552 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:50:34.294880 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:50:34.300605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:50:34.301585 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:34.302207 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:50:34.386755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:50:34.387588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.388001 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:50:34.388336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:34.404475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:50:34.404960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.405243 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:50:34.411147 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:50:34.423380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.423847 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m16:50:34.426882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:34.431983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.432323 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:50:34.434975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:34.470848 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:50:34.471362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.471635 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:50:34.477609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:34.489266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:50:34.489698 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:50:34.496078 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m16:50:34.498211 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:34.498579 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:50:34.499631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8c07baf0>]}
[0m16:50:34.500303 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.21s]
[0m16:50:34.501187 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:50:34.501642 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:34.502256 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:50:34.503463 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.503823 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:34.504109 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:50:34.510073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.510796 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:34.511153 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:34.561158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.562020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.562401 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:50:34.562671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:34.618776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:50:34.619271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.619562 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:50:34.624742 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:50:34.632167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.632846 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:50:34.636668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:34.641679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.642067 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:50:34.645679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:34.658897 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:50:34.659386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.659702 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:50:34.666398 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:34.670542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:50:34.670928 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:50:34.714746 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:50:34.717187 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:34.717637 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:50:34.718865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8c0dd240>]}
[0m16:50:34.719742 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:50:34.720662 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:50:34.721919 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:34.722449 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:50:34.723723 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.724105 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:34.724514 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:50:34.730084 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.730741 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:34.731109 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:34.739276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.739940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.740252 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:50:34.740501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:34.802691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:50:34.803292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.803635 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:50:34.810104 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:50:34.815755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.816302 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:50:34.820372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:34.824212 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:50:34.824610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.824907 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:50:34.831058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:50:34.841230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:50:34.841983 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:50:34.845341 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:34.848890 [debug] [Thread-1 (]: finished collecting timing info
[0m16:50:34.849592 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:50:34.851355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814c0404-6d52-461a-9401-49f3039fad2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7d524df0>]}
[0m16:50:34.852533 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:50:34.853950 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:50:34.857537 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:50:34.858272 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:34.858766 [debug] [MainThread]: On master: BEGIN
[0m16:50:34.859193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:34.881158 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:50:34.881687 [debug] [MainThread]: On master: COMMIT
[0m16:50:34.882041 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:34.882365 [debug] [MainThread]: On master: COMMIT
[0m16:50:34.884146 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:34.884620 [debug] [MainThread]: On master: Close
[0m16:50:34.885762 [info ] [MainThread]: 
[0m16:50:34.886483 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m16:50:34.887253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:34.887553 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:50:34.902413 [info ] [MainThread]: 
[0m16:50:34.903059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:34.903754 [info ] [MainThread]: 
[0m16:50:34.904466 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:50:34.905257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7d5259c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7d525990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7d5140a0>]}
[0m16:50:34.905785 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:51:47.386150 | 0cb45f98-67f5-4153-86c7-68c08c05aa95 ==============================
[0m16:51:47.386185 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:51:47.386858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:51:47.387142 [debug] [MainThread]: Tracking: tracking
[0m16:51:47.389022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81dfdb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81dfdbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81dfdbfd0>]}
[0m16:51:47.467087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:51:47.467768 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:51:47.543077 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:51:47.604655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81d5a4100>]}
[0m16:51:47.617272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81d51be50>]}
[0m16:51:47.617875 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:51:47.618446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81e3d1330>]}
[0m16:51:47.620866 [info ] [MainThread]: 
[0m16:51:47.622247 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:51:47.624382 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:51:47.646813 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:51:47.647334 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:51:47.647655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:47.669632 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:51:47.672448 [debug] [ThreadPool]: On list_test: Close
[0m16:51:47.675799 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:51:47.689270 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:51:47.689717 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:51:47.689999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:47.704015 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:51:47.704487 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:51:47.704816 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:51:47.711379 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m16:51:47.713816 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:51:47.715679 [debug] [ThreadPool]: On list_test_public: Close
[0m16:51:47.725237 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.725676 [debug] [MainThread]: On master: BEGIN
[0m16:51:47.725977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:47.739731 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:51:47.740160 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.740431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:47.763975 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
[0m16:51:47.766226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c7d7b20>]}
[0m16:51:47.766764 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:47.768715 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.769056 [debug] [MainThread]: On master: BEGIN
[0m16:51:47.775011 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:51:47.775371 [debug] [MainThread]: On master: COMMIT
[0m16:51:47.775634 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.775875 [debug] [MainThread]: On master: COMMIT
[0m16:51:47.777510 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:51:47.777896 [debug] [MainThread]: On master: Close
[0m16:51:47.778837 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:51:47.779400 [info ] [MainThread]: 
[0m16:51:47.784510 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:51:47.785146 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m16:51:47.786582 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.786973 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:51:47.787291 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:51:47.792604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:51:47.793272 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:47.793624 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:51:47.875920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:51:47.876786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.877129 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:51:47.877376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:47.892547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:51:47.892981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.893238 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:51:47.900240 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:51:47.911867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.912268 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m16:51:47.915481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:47.920367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.920743 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:51:47.923702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:47.958109 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:51:47.958522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.958827 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:51:47.965100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:51:47.975293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:51:47.975644 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:51:47.982071 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m16:51:47.984061 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:47.984436 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:51:47.985596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c81bdc0>]}
[0m16:51:47.986357 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m16:51:47.987164 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:51:47.987617 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:51:47.988520 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:51:47.989772 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:47.990084 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:51:47.990374 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:51:47.996208 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:47.996942 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:47.997307 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:51:48.045399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.046312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.046685 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:51:48.046994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:48.106859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:51:48.107459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.107916 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:51:48.154940 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.05 seconds
[0m16:51:48.160470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.160819 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:51:48.165377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:48.170079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.170450 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:51:48.173474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:48.185220 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:51:48.185583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.185859 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:51:48.192392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:51:48.196148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:51:48.196462 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:51:48.242922 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:51:48.245336 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:48.245750 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:51:48.246958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81d5280d0>]}
[0m16:51:48.247688 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m16:51:48.248549 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:51:48.248967 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.max_speed
[0m16:51:48.249925 [info ] [Thread-1 (]: 3 of 4 START sql view model public.max_speed ................................... [RUN]
[0m16:51:48.251235 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.max_speed"
[0m16:51:48.251609 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.max_speed
[0m16:51:48.251929 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.max_speed
[0m16:51:48.258064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.max_speed"
[0m16:51:48.258825 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:48.259217 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.max_speed
[0m16:51:48.267800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.max_speed"
[0m16:51:48.268611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:51:48.268972 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: BEGIN
[0m16:51:48.269259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:48.287384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:51:48.287957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:51:48.288293 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */

  create view "test"."public"."max_speed__dbt_tmp" as (
    with source_data as (
    select *
    from "test"."public"."My_model"
),
final as (
    select type,
        AVG(avg_speed)
    from source_data
    group by type
)
SELECT *
FROM final
  );
[0m16:51:48.293136 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function avg(character varying) does not exist
LINE 10:         AVG(avg_speed)
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m16:51:48.293685 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: ROLLBACK
[0m16:51:48.296329 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:48.296840 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: Close
[0m16:51:48.298224 [debug] [Thread-1 (]: Database Error in model max_speed (models/traffic_data/max_speed.sql)
  function avg(character varying) does not exist
  LINE 10:         AVG(avg_speed)
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:51:48.298914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c8bf730>]}
[0m16:51:48.299766 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.max_speed .......................... [[31mERROR[0m in 0.05s]
[0m16:51:48.300736 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.max_speed
[0m16:51:48.301245 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:51:48.301878 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:51:48.303343 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.303761 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:51:48.304079 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:51:48.310610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.311428 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:48.311863 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:51:48.323686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.324552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.324948 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:51:48.325234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:48.340409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:51:48.341042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.341389 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:51:48.346809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:51:48.352180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.352548 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:51:48.355538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:48.359400 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:51:48.359840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.360135 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:51:48.365581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:51:48.369643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:51:48.369994 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:51:48.372543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:48.375478 [debug] [Thread-1 (]: finished collecting timing info
[0m16:51:48.375917 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:51:48.377172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb45f98-67f5-4153-86c7-68c08c05aa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c6f3580>]}
[0m16:51:48.378234 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:51:48.379483 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:51:48.382093 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:51:48.382732 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:48.383193 [debug] [MainThread]: On master: BEGIN
[0m16:51:48.383647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:48.399772 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:51:48.400336 [debug] [MainThread]: On master: COMMIT
[0m16:51:48.400704 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:48.401006 [debug] [MainThread]: On master: COMMIT
[0m16:51:48.402866 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:51:48.403356 [debug] [MainThread]: On master: Close
[0m16:51:48.404637 [info ] [MainThread]: 
[0m16:51:48.405295 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m16:51:48.406121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:48.406562 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:51:48.423205 [info ] [MainThread]: 
[0m16:51:48.424304 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:51:48.425337 [info ] [MainThread]: 
[0m16:51:48.426211 [error] [MainThread]: [33mDatabase Error in model max_speed (models/traffic_data/max_speed.sql)[0m
[0m16:51:48.427057 [error] [MainThread]:   function avg(character varying) does not exist
[0m16:51:48.427653 [error] [MainThread]:   LINE 10:         AVG(avg_speed)
[0m16:51:48.428220 [error] [MainThread]:                    ^
[0m16:51:48.429030 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m16:51:48.429835 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:51:48.430704 [info ] [MainThread]: 
[0m16:51:48.431375 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:51:48.432319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c6f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c6f1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81c7e4b50>]}
[0m16:51:48.433095 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:53:15.204463 | b73b7aad-a6e5-4498-99f7-f2cc2f63db8c ==============================
[0m16:53:15.204484 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:53:15.205119 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:15.205387 [debug] [MainThread]: Tracking: tracking
[0m16:53:15.207474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dadfdb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dadfdbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dadfdbfd0>]}
[0m16:53:15.294753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:15.295584 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:53:15.367507 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:53:15.426606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dad5bc3d0>]}
[0m16:53:15.438648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dad52e800>]}
[0m16:53:15.439182 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:53:15.439668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dad51bd00>]}
[0m16:53:15.441929 [info ] [MainThread]: 
[0m16:53:15.443122 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:53:15.444923 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:53:15.467096 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:53:15.467522 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:53:15.467812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:15.485018 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:53:15.488179 [debug] [ThreadPool]: On list_test: Close
[0m16:53:15.492265 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:53:15.506406 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:53:15.506898 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:53:15.507196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:15.522349 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:53:15.522874 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:53:15.523200 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:53:15.529560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m16:53:15.531951 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:53:15.533758 [debug] [ThreadPool]: On list_test_public: Close
[0m16:53:15.546640 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:15.547305 [debug] [MainThread]: On master: BEGIN
[0m16:53:15.547778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:15.562990 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:53:15.563480 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:15.563771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:15.588507 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
[0m16:53:15.591127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dac3e3a90>]}
[0m16:53:15.591734 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:15.593379 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:15.593726 [debug] [MainThread]: On master: BEGIN
[0m16:53:15.601216 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:53:15.601747 [debug] [MainThread]: On master: COMMIT
[0m16:53:15.602093 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:15.602390 [debug] [MainThread]: On master: COMMIT
[0m16:53:15.604090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:53:15.604505 [debug] [MainThread]: On master: Close
[0m16:53:15.605559 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:53:15.606411 [info ] [MainThread]: 
[0m16:53:15.613153 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:53:15.614075 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m16:53:15.615989 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.616568 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:53:15.617055 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:53:15.625416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:53:15.626466 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:15.627059 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:53:15.713236 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:53:15.714035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.714416 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:53:15.714678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:15.728302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m16:53:15.728776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.729094 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:53:15.734688 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:53:15.746719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.747248 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m16:53:15.750629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:53:15.756194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.756579 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:53:15.798666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:53:15.833109 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:53:15.833503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.833769 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:53:15.839502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:53:15.850191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:53:15.850563 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:53:15.856848 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m16:53:15.858868 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:15.859250 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:53:15.860382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dac41bdf0>]}
[0m16:53:15.861190 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:53:15.862012 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:53:15.862392 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:53:15.862984 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:53:15.864584 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.864945 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:53:15.865356 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:53:15.871106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.871788 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:15.872133 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:53:15.916627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.917414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.917728 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:53:15.917979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:15.933599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:53:15.934124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.934444 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:53:15.938899 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:53:15.944447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.944830 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:53:15.947343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:53:15.952062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.952479 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:53:15.955208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:53:15.967160 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:53:15.967548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.967816 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:53:15.973742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:53:15.977550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:53:15.977873 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:53:16.022699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:53:16.024969 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:16.025378 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:53:16.026671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dad4d8040>]}
[0m16:53:16.027626 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.16s]
[0m16:53:16.028972 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:53:16.029593 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.max_speed
[0m16:53:16.030600 [info ] [Thread-1 (]: 3 of 4 START sql view model public.max_speed ................................... [RUN]
[0m16:53:16.032376 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.max_speed"
[0m16:53:16.032932 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.max_speed
[0m16:53:16.033350 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.max_speed
[0m16:53:16.038767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.max_speed"
[0m16:53:16.039525 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:16.039889 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.max_speed
[0m16:53:16.048274 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.max_speed"
[0m16:53:16.049143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:53:16.049488 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: BEGIN
[0m16:53:16.049757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:16.114805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:53:16.115556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:53:16.116074 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */

  create view "test"."public"."max_speed__dbt_tmp" as (
    with source_data as (
    select *
    from "test"."public"."My_model"
),
final as (
    select type,
    from source_data
    group by type
)
SELECT *
FROM final
  );
[0m16:53:16.119505 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 10:     from source_data
             ^

[0m16:53:16.120051 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: ROLLBACK
[0m16:53:16.122733 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:16.123450 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: Close
[0m16:53:16.125065 [debug] [Thread-1 (]: Database Error in model max_speed (models/traffic_data/max_speed.sql)
  syntax error at or near "from"
  LINE 10:     from source_data
               ^
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:53:16.125877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dad55cc10>]}
[0m16:53:16.126959 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.max_speed .......................... [[31mERROR[0m in 0.09s]
[0m16:53:16.128276 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.max_speed
[0m16:53:16.128939 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:53:16.129907 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:53:16.131496 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.131879 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:53:16.132211 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:53:16.137736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.138444 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:16.138805 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:53:16.150135 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.150964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.151348 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:53:16.151614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:16.214717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:53:16.215461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.215972 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:53:16.221846 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:53:16.230412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.231049 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:53:16.234213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:53:16.239686 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:53:16.240279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.240738 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:53:16.246674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:53:16.253112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:53:16.253702 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:53:16.256635 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:53:16.259827 [debug] [Thread-1 (]: finished collecting timing info
[0m16:53:16.260428 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:53:16.262016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b73b7aad-a6e5-4498-99f7-f2cc2f63db8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dac2ee3b0>]}
[0m16:53:16.263062 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:53:16.264407 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:53:16.267008 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:53:16.267592 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:16.267914 [debug] [MainThread]: On master: BEGIN
[0m16:53:16.268214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:16.283783 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:53:16.284401 [debug] [MainThread]: On master: COMMIT
[0m16:53:16.284814 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:16.285205 [debug] [MainThread]: On master: COMMIT
[0m16:53:16.287944 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:53:16.288540 [debug] [MainThread]: On master: Close
[0m16:53:16.289726 [info ] [MainThread]: 
[0m16:53:16.290389 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m16:53:16.290926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:16.291351 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:53:16.307944 [info ] [MainThread]: 
[0m16:53:16.308608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:16.309404 [info ] [MainThread]: 
[0m16:53:16.309987 [error] [MainThread]: [33mDatabase Error in model max_speed (models/traffic_data/max_speed.sql)[0m
[0m16:53:16.310572 [error] [MainThread]:   syntax error at or near "from"
[0m16:53:16.311105 [error] [MainThread]:   LINE 10:     from source_data
[0m16:53:16.311547 [error] [MainThread]:                ^
[0m16:53:16.311988 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:53:16.312461 [info ] [MainThread]: 
[0m16:53:16.313105 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:53:16.313898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dac2ee0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dac2ee8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dac3ecb50>]}
[0m16:53:16.314533 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:55:14.012963 | cfce2c09-3827-4ffd-8f9f-53b9f644e89d ==============================
[0m16:55:14.012983 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:55:14.013686 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:55:14.013975 [debug] [MainThread]: Tracking: tracking
[0m16:55:14.015921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3440d3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3440d0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3440d0bb0>]}
[0m16:55:14.101917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:14.102710 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:55:14.176012 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:55:14.234227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3436ac400>]}
[0m16:55:14.246246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34363a830>]}
[0m16:55:14.246776 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:55:14.247274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa343627d30>]}
[0m16:55:14.249676 [info ] [MainThread]: 
[0m16:55:14.251169 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:55:14.253813 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:55:14.276243 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:55:14.276922 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:55:14.277408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:14.297079 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:55:14.299610 [debug] [ThreadPool]: On list_test: Close
[0m16:55:14.302562 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:55:14.316473 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:55:14.316902 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:55:14.317196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:14.332007 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:55:14.332494 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:55:14.332782 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:55:14.339339 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m16:55:14.342078 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:55:14.344128 [debug] [ThreadPool]: On list_test_public: Close
[0m16:55:14.354049 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:14.354504 [debug] [MainThread]: On master: BEGIN
[0m16:55:14.354814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:14.410776 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:55:14.411491 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:14.412017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:14.458657 [debug] [MainThread]: SQL status: SELECT 4 in 0.05 seconds
[0m16:55:14.460928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3426ebb80>]}
[0m16:55:14.461522 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:14.464512 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:14.464885 [debug] [MainThread]: On master: BEGIN
[0m16:55:14.510655 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:55:14.511101 [debug] [MainThread]: On master: COMMIT
[0m16:55:14.511390 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:14.511700 [debug] [MainThread]: On master: COMMIT
[0m16:55:14.513801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:55:14.514227 [debug] [MainThread]: On master: Close
[0m16:55:14.515244 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:55:14.515800 [info ] [MainThread]: 
[0m16:55:14.520948 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:55:14.521539 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m16:55:14.522804 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.523172 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:55:14.523465 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:55:14.528507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:55:14.529192 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:14.529561 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:55:14.611211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:55:14.612122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.612483 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:55:14.612764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:14.666611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:55:14.667106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.667387 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:55:14.676408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:55:14.687877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.688264 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m16:55:14.692185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:55:14.697516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.697887 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:55:14.701147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:55:14.735653 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:55:14.736045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.736314 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:55:14.742183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:55:14.752935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:55:14.753289 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:55:14.760312 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m16:55:14.762426 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:14.762799 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:55:14.763818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa342727df0>]}
[0m16:55:14.764448 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.24s]
[0m16:55:14.765315 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:55:14.765771 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:55:14.766624 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:55:14.767936 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.768289 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:55:14.768589 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:55:14.774221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.774933 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:14.775298 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:55:14.823800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.824793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.825298 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:55:14.825616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:14.890724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:55:14.891253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.891575 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:55:14.896445 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:55:14.901661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.902039 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:55:14.905153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:55:14.909958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.910326 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:55:14.912988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:55:14.924150 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:55:14.924504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.924790 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:55:14.930664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:55:14.934598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:55:14.934996 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:55:14.978973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:55:14.981436 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:14.981862 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:55:14.983041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa343668760>]}
[0m16:55:14.983745 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:55:14.984853 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:55:14.985278 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.max_speed
[0m16:55:14.985993 [info ] [Thread-1 (]: 3 of 4 START sql view model public.max_speed ................................... [RUN]
[0m16:55:14.987539 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.max_speed"
[0m16:55:14.987904 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.max_speed
[0m16:55:14.988201 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.max_speed
[0m16:55:14.994118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.max_speed"
[0m16:55:14.994899 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:14.995285 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.max_speed
[0m16:55:15.005939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.max_speed"
[0m16:55:15.006839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:55:15.007222 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: BEGIN
[0m16:55:15.007509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.023923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:55:15.024524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:55:15.024850 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */

  create view "test"."public"."max_speed__dbt_tmp" as (
    with source_data as (
    select * from "test"."public"."My_model"
),
final as (
    select type,
    from source_data
    group by type
)
SELECT *
FROM final
  );
[0m16:55:15.027839 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 9:     from source_data
            ^

[0m16:55:15.028421 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: ROLLBACK
[0m16:55:15.031017 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:15.031515 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: Close
[0m16:55:15.032666 [debug] [Thread-1 (]: Database Error in model max_speed (models/traffic_data/max_speed.sql)
  syntax error at or near "from"
  LINE 9:     from source_data
              ^
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:55:15.033275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3437e4040>]}
[0m16:55:15.034049 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.max_speed .......................... [[31mERROR[0m in 0.05s]
[0m16:55:15.034963 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.max_speed
[0m16:55:15.035344 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:55:15.036046 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:55:15.037524 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.038068 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:55:15.038531 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:55:15.044884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.045781 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:15.046252 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:55:15.057508 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.058601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.059076 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:55:15.059496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.077472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:55:15.078040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.078450 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:55:15.122764 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.04 seconds
[0m16:55:15.128275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.128664 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:55:15.132140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:55:15.135523 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:55:15.135867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.136134 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:55:15.141836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:55:15.145799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:55:15.146175 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:55:15.148866 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:55:15.150845 [debug] [Thread-1 (]: finished collecting timing info
[0m16:55:15.151228 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:55:15.152246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfce2c09-3827-4ffd-8f9f-53b9f644e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3405f6920>]}
[0m16:55:15.152914 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m16:55:15.153720 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:55:15.155788 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:55:15.156245 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:15.156541 [debug] [MainThread]: On master: BEGIN
[0m16:55:15.156807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:15.219009 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:55:15.219536 [debug] [MainThread]: On master: COMMIT
[0m16:55:15.219814 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:15.220072 [debug] [MainThread]: On master: COMMIT
[0m16:55:15.221715 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:55:15.222145 [debug] [MainThread]: On master: Close
[0m16:55:15.223218 [info ] [MainThread]: 
[0m16:55:15.223784 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:55:15.224394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:15.224693 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:55:15.237341 [info ] [MainThread]: 
[0m16:55:15.237963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:15.238752 [info ] [MainThread]: 
[0m16:55:15.239476 [error] [MainThread]: [33mDatabase Error in model max_speed (models/traffic_data/max_speed.sql)[0m
[0m16:55:15.239928 [error] [MainThread]:   syntax error at or near "from"
[0m16:55:15.240349 [error] [MainThread]:   LINE 9:     from source_data
[0m16:55:15.240781 [error] [MainThread]:               ^
[0m16:55:15.241209 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:55:15.241673 [info ] [MainThread]: 
[0m16:55:15.242125 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:55:15.242741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3405f7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3405f62c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3426f4d00>]}
[0m16:55:15.243202 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:56:11.923291 | 91d3a139-4bc3-40a3-8d38-f80b3628bd35 ==============================
[0m16:56:11.923330 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:56:11.924681 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:56:11.925235 [debug] [MainThread]: Tracking: tracking
[0m16:56:11.938849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc42e3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc42e0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc42e0bb0>]}
[0m16:56:12.060082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:12.060875 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/My_model.sql
[0m16:56:12.139627 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/My_model.sql
[0m16:56:12.211695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc3864460>]}
[0m16:56:12.227120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc37e6830>]}
[0m16:56:12.227838 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:56:12.228426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc37d3d30>]}
[0m16:56:12.231074 [info ] [MainThread]: 
[0m16:56:12.232727 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:56:12.235061 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:56:12.260298 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:56:12.260783 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:56:12.261066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:12.281680 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:56:12.284197 [debug] [ThreadPool]: On list_test: Close
[0m16:56:12.287871 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:56:12.303070 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:56:12.303644 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:56:12.303959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:12.321626 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:56:12.322135 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:56:12.322465 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:56:12.329479 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m16:56:12.332230 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:56:12.335103 [debug] [ThreadPool]: On list_test_public: Close
[0m16:56:12.345235 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:12.345674 [debug] [MainThread]: On master: BEGIN
[0m16:56:12.345950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:12.367509 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:56:12.368038 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:12.368396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:56:12.397434 [debug] [MainThread]: SQL status: SELECT 4 in 0.03 seconds
[0m16:56:12.400685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc289bbb0>]}
[0m16:56:12.401451 [debug] [MainThread]: On master: ROLLBACK
[0m16:56:12.405238 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:12.405645 [debug] [MainThread]: On master: BEGIN
[0m16:56:12.409057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:56:12.409446 [debug] [MainThread]: On master: COMMIT
[0m16:56:12.409803 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:12.410079 [debug] [MainThread]: On master: COMMIT
[0m16:56:12.411837 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:56:12.412199 [debug] [MainThread]: On master: Close
[0m16:56:12.413195 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:56:12.413790 [info ] [MainThread]: 
[0m16:56:12.419847 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:56:12.420574 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m16:56:12.421792 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.422201 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:56:12.422502 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:56:12.427745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:56:12.428467 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:12.428919 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:56:12.509787 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:56:12.510740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.511103 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:56:12.511356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:12.546777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:56:12.547278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.547702 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type as vehicle_type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time as vtime
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:56:12.594631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.05 seconds
[0m16:56:12.610034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.610568 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m16:56:12.613795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:56:12.621519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.622519 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:56:12.625301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:56:12.667198 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:56:12.667748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.668206 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:56:12.675131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:56:12.688728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:56:12.689201 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:56:12.695323 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m16:56:12.697631 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:12.698230 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:56:12.699624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc28d3df0>]}
[0m16:56:12.700482 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:56:12.701715 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:56:12.702258 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:56:12.703116 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:56:12.704390 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.704832 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:56:12.705248 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:56:12.710855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.711529 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:12.711934 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:56:12.759912 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.760846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.761201 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:56:12.761469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:12.779213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:56:12.779715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.780038 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:56:12.786287 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:56:12.791772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.792172 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:56:12.795090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:56:12.800286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.800727 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:56:12.804044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:56:12.817210 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:56:12.817678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.817988 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:56:12.825030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:56:12.829499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:56:12.829900 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:56:12.874680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:56:12.877002 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:12.877441 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:56:12.878605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc37904c0>]}
[0m16:56:12.879284 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.17s]
[0m16:56:12.880127 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:56:12.880538 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.max_speed
[0m16:56:12.881410 [info ] [Thread-1 (]: 3 of 4 START sql view model public.max_speed ................................... [RUN]
[0m16:56:12.883075 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.max_speed"
[0m16:56:12.883592 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.max_speed
[0m16:56:12.884047 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.max_speed
[0m16:56:12.891722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.max_speed"
[0m16:56:12.892534 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:12.892929 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.max_speed
[0m16:56:12.903517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.max_speed"
[0m16:56:12.904317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:56:12.904647 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: BEGIN
[0m16:56:12.904897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:13.010655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.11 seconds
[0m16:56:13.011123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:56:13.011395 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */

  create view "test"."public"."max_speed__dbt_tmp" as (
    with source_data as (
    select * from "test"."public"."My_model"
),
final as (
    select type,
    from source_data
    group by type
)
SELECT *
FROM final
  );
[0m16:56:13.014464 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 9:     from source_data
            ^

[0m16:56:13.014866 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: ROLLBACK
[0m16:56:13.016897 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:13.017269 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: Close
[0m16:56:13.018398 [debug] [Thread-1 (]: Database Error in model max_speed (models/traffic_data/max_speed.sql)
  syntax error at or near "from"
  LINE 9:     from source_data
              ^
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:56:13.018923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc2973730>]}
[0m16:56:13.019584 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.max_speed .......................... [[31mERROR[0m in 0.14s]
[0m16:56:13.020398 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.max_speed
[0m16:56:13.020769 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:56:13.021507 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:56:13.023036 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.023427 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:56:13.023785 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:56:13.029293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.029909 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:13.030264 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:56:13.040252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.041163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.041703 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:56:13.042126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:13.102788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:56:13.103324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.103605 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:56:13.108974 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:56:13.114152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.114560 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:56:13.117957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:56:13.121740 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:56:13.122141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.122465 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:56:13.128570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:56:13.134055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:56:13.134479 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:56:13.178754 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m16:56:13.181023 [debug] [Thread-1 (]: finished collecting timing info
[0m16:56:13.181448 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:56:13.182664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d3a139-4bc3-40a3-8d38-f80b3628bd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc079d9c0>]}
[0m16:56:13.183360 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:56:13.184154 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:56:13.186346 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:56:13.186884 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:13.187171 [debug] [MainThread]: On master: BEGIN
[0m16:56:13.187418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:13.201795 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:56:13.202319 [debug] [MainThread]: On master: COMMIT
[0m16:56:13.202615 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:13.202894 [debug] [MainThread]: On master: COMMIT
[0m16:56:13.204586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:56:13.205033 [debug] [MainThread]: On master: Close
[0m16:56:13.206340 [info ] [MainThread]: 
[0m16:56:13.207007 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:56:13.207529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:13.207926 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:56:13.222544 [info ] [MainThread]: 
[0m16:56:13.223189 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:56:13.223733 [info ] [MainThread]: 
[0m16:56:13.224351 [error] [MainThread]: [33mDatabase Error in model max_speed (models/traffic_data/max_speed.sql)[0m
[0m16:56:13.224878 [error] [MainThread]:   syntax error at or near "from"
[0m16:56:13.225428 [error] [MainThread]:   LINE 9:     from source_data
[0m16:56:13.225949 [error] [MainThread]:               ^
[0m16:56:13.226479 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:56:13.227203 [info ] [MainThread]: 
[0m16:56:13.228031 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:56:13.229089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc079f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc079dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc296f9d0>]}
[0m16:56:13.229854 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:57:43.206629 | 6f5a1af7-e51f-4097-9883-efdfcb6fb6ba ==============================
[0m16:57:43.206653 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:57:43.207454 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:57:43.207935 [debug] [MainThread]: Tracking: tracking
[0m16:57:43.210182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0174d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0174d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0174d7fd0>]}
[0m16:57:43.298906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:43.299774 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:57:43.369155 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:57:43.443670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb016af43d0>]}
[0m16:57:43.456022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb016a66800>]}
[0m16:57:43.456798 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:57:43.457459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb016a53d00>]}
[0m16:57:43.459949 [info ] [MainThread]: 
[0m16:57:43.461336 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:57:43.463595 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m16:57:43.484048 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m16:57:43.484441 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m16:57:43.484733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:43.505979 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m16:57:43.508557 [debug] [ThreadPool]: On list_test: Close
[0m16:57:43.511763 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m16:57:43.527217 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:57:43.527813 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m16:57:43.528265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:43.545869 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m16:57:43.546668 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m16:57:43.547146 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:57:43.559527 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m16:57:43.563614 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m16:57:43.569991 [debug] [ThreadPool]: On list_test_public: Close
[0m16:57:43.585175 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.585664 [debug] [MainThread]: On master: BEGIN
[0m16:57:43.585974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:43.625627 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:57:43.626252 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.626579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:57:43.675658 [debug] [MainThread]: SQL status: SELECT 4 in 0.05 seconds
[0m16:57:43.678181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb015b1fb50>]}
[0m16:57:43.678775 [debug] [MainThread]: On master: ROLLBACK
[0m16:57:43.681322 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.681752 [debug] [MainThread]: On master: BEGIN
[0m16:57:43.685949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:57:43.686429 [debug] [MainThread]: On master: COMMIT
[0m16:57:43.686708 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.686967 [debug] [MainThread]: On master: COMMIT
[0m16:57:43.688962 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:57:43.689391 [debug] [MainThread]: On master: Close
[0m16:57:43.690470 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m16:57:43.691334 [info ] [MainThread]: 
[0m16:57:43.698144 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m16:57:43.699127 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m16:57:43.701091 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:43.701665 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m16:57:43.702542 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m16:57:43.711492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m16:57:43.712545 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:43.713219 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m16:57:43.807598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m16:57:43.808399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:43.808727 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m16:57:43.808984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:43.922593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.11 seconds
[0m16:57:43.923079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:43.923398 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type as vehicle_type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time as vtime
    from source_data_cast
)
SELECT *
FROM final
  );
[0m16:57:43.930439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:57:43.942492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:43.942890 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m16:57:43.946040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:57:43.951246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:43.951608 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m16:57:43.954267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:57:43.989476 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:57:43.989893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:43.990212 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m16:57:43.995686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:57:44.006742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m16:57:44.007113 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m16:57:44.013819 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m16:57:44.016234 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.016681 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m16:57:44.017918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb015b57dc0>]}
[0m16:57:44.018767 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.32s]
[0m16:57:44.019723 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m16:57:44.020167 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m16:57:44.020868 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:57:44.022390 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.022848 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m16:57:44.023248 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m16:57:44.029594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.030586 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.030986 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m16:57:44.078991 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.080066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.080426 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m16:57:44.080696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:44.095944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:57:44.096488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.096793 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:57:44.101467 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:57:44.106763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.107203 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:57:44.110943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:57:44.117115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.117487 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:57:44.120192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:57:44.133154 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:57:44.133580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.133863 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m16:57:44.139432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:57:44.143600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m16:57:44.143978 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:57:44.194637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:57:44.197494 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.197979 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m16:57:44.199236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb016a10700>]}
[0m16:57:44.199925 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m16:57:44.200769 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m16:57:44.201338 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.max_speed
[0m16:57:44.202083 [info ] [Thread-1 (]: 3 of 4 START sql view model public.max_speed ................................... [RUN]
[0m16:57:44.203656 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.max_speed"
[0m16:57:44.204006 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.max_speed
[0m16:57:44.204298 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.max_speed
[0m16:57:44.210537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.max_speed"
[0m16:57:44.211304 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.211738 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.max_speed
[0m16:57:44.221995 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.max_speed"
[0m16:57:44.222884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:57:44.223236 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: BEGIN
[0m16:57:44.223521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:44.248849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m16:57:44.249370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m16:57:44.249685 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */

  create view "test"."public"."max_speed__dbt_tmp" as (
    with source_data as (
    select * from "test"."public"."My_model"
),
final as (
    select vehicle_type,
    from source_data
    group by vtype
)
SELECT *
FROM final
  );
[0m16:57:44.298735 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 9:     from source_data
            ^

[0m16:57:44.299241 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: ROLLBACK
[0m16:57:44.302061 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.302472 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: Close
[0m16:57:44.303646 [debug] [Thread-1 (]: Database Error in model max_speed (models/traffic_data/max_speed.sql)
  syntax error at or near "from"
  LINE 9:     from source_data
              ^
  compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:57:44.304312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb015bf7700>]}
[0m16:57:44.304995 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.max_speed .......................... [[31mERROR[0m in 0.10s]
[0m16:57:44.305777 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.max_speed
[0m16:57:44.306199 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m16:57:44.306882 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m16:57:44.308287 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.308778 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m16:57:44.309087 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m16:57:44.314594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.315273 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.315613 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m16:57:44.326954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.327993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.328512 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m16:57:44.328951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:44.345454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:57:44.346193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.346689 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m16:57:44.352345 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:57:44.357557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.358028 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:57:44.361637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:57:44.367394 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:57:44.368025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.368483 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m16:57:44.375530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:57:44.379873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m16:57:44.380258 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:57:44.430693 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m16:57:44.433031 [debug] [Thread-1 (]: finished collecting timing info
[0m16:57:44.433444 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m16:57:44.434632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5a1af7-e51f-4097-9883-efdfcb6fb6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb014227190>]}
[0m16:57:44.435561 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:57:44.436751 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m16:57:44.438913 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:57:44.439351 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:44.439657 [debug] [MainThread]: On master: BEGIN
[0m16:57:44.440004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:44.459023 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m16:57:44.459540 [debug] [MainThread]: On master: COMMIT
[0m16:57:44.459895 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:44.460190 [debug] [MainThread]: On master: COMMIT
[0m16:57:44.462793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:57:44.463489 [debug] [MainThread]: On master: Close
[0m16:57:44.464810 [info ] [MainThread]: 
[0m16:57:44.465475 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m16:57:44.466153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:44.466671 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m16:57:44.481153 [info ] [MainThread]: 
[0m16:57:44.481885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:57:44.482674 [info ] [MainThread]: 
[0m16:57:44.483370 [error] [MainThread]: [33mDatabase Error in model max_speed (models/traffic_data/max_speed.sql)[0m
[0m16:57:44.483937 [error] [MainThread]:   syntax error at or near "from"
[0m16:57:44.484456 [error] [MainThread]:   LINE 9:     from source_data
[0m16:57:44.484940 [error] [MainThread]:               ^
[0m16:57:44.485434 [error] [MainThread]:   compiled Code at target/run/dbt_traffic_data/models/traffic_data/max_speed.sql
[0m16:57:44.485964 [info ] [MainThread]: 
[0m16:57:44.486496 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:57:44.487241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb014227160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb014226920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb015b28c40>]}
[0m16:57:44.487817 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 16:59:58.102021 | a229e370-6232-4abe-90a1-2d224a94f321 ==============================
[0m16:59:58.102043 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:59:58.102734 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:59:58.103001 [debug] [MainThread]: Tracking: tracking
[0m16:59:58.104965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75631db670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75631dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75631dbfd0>]}
[0m16:59:58.192880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:58.193584 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m16:59:58.264407 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m16:59:58.288548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75627acca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75628f1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75627bb760>]}
[0m16:59:58.289146 [debug] [MainThread]: Flushing usage events
[0m16:59:59.773263 [error] [MainThread]: Encountered an error:
Compilation Error in model max_speed (models/traffic_data/max_speed.sql)
  Model 'model.dbt_traffic_data.max_speed' (models/traffic_data/max_speed.sql) depends on a node named 'vehicles_cast_feature' which was not found


============================== 2023-01-01 17:00:14.605908 | affb5f69-ed14-4e04-a99a-0780102d9720 ==============================
[0m17:00:14.605934 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:00:14.606669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:00:14.606942 [debug] [MainThread]: Tracking: tracking
[0m17:00:14.608899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef64ed7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef64ed4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef64ed4bb0>]}
[0m17:00:14.699800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:14.700610 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m17:00:14.770413 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m17:00:14.794415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef644c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6460d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef644d7730>]}
[0m17:00:14.794976 [debug] [MainThread]: Flushing usage events
[0m17:00:16.052461 [error] [MainThread]: Encountered an error:
Compilation Error in model max_speed (models/traffic_data/max_speed.sql)
  Model 'model.dbt_traffic_data.max_speed' (models/traffic_data/max_speed.sql) depends on a node named 'vehicles_cast_feature' which was not found


============================== 2023-01-01 17:00:27.096300 | 9583394a-4024-42ad-bfaa-e0d5166505b8 ==============================
[0m17:00:27.096322 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:00:27.097020 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:00:27.097307 [debug] [MainThread]: Tracking: tracking
[0m17:00:27.099226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3c8e7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3c8e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3c8e7fa0>]}
[0m17:00:27.195560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:27.196331 [debug] [MainThread]: Partial parsing: updated file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m17:00:27.268302 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/max_speed.sql
[0m17:00:27.326767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3bf203a0>]}
[0m17:00:27.338816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3bec27d0>]}
[0m17:00:27.339352 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m17:00:27.339861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3beb3cd0>]}
[0m17:00:27.342283 [info ] [MainThread]: 
[0m17:00:27.343712 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:00:27.346126 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m17:00:27.368280 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m17:00:27.368722 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m17:00:27.368991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:27.388966 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m17:00:27.393029 [debug] [ThreadPool]: On list_test: Close
[0m17:00:27.396467 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m17:00:27.410097 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m17:00:27.410559 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m17:00:27.410841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:27.470703 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m17:00:27.471173 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m17:00:27.471490 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:00:27.478674 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m17:00:27.481045 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m17:00:27.483109 [debug] [ThreadPool]: On list_test_public: Close
[0m17:00:27.494216 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:27.494625 [debug] [MainThread]: On master: BEGIN
[0m17:00:27.494920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:27.554743 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m17:00:27.555209 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:27.555488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:27.579888 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
[0m17:00:27.582145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3ad7bb20>]}
[0m17:00:27.582730 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:27.584533 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:27.584882 [debug] [MainThread]: On master: BEGIN
[0m17:00:27.588361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:00:27.588705 [debug] [MainThread]: On master: COMMIT
[0m17:00:27.588960 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:27.589207 [debug] [MainThread]: On master: COMMIT
[0m17:00:27.590720 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:00:27.591048 [debug] [MainThread]: On master: Close
[0m17:00:27.591957 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m17:00:27.592469 [info ] [MainThread]: 
[0m17:00:27.597996 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m17:00:27.598896 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m17:00:27.600538 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.601050 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m17:00:27.601441 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m17:00:27.607960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m17:00:27.608798 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:27.609316 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m17:00:27.698530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m17:00:27.699286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.699600 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m17:00:27.699848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:27.715800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:00:27.716297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.716590 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type as vehicle_type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time as vtime
    from source_data_cast
)
SELECT *
FROM final
  );
[0m17:00:27.722410 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:00:27.733984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.734382 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m17:00:27.737109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:27.741737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.742067 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m17:00:27.744818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:27.779864 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m17:00:27.780274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.780541 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m17:00:27.786049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:00:27.796500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:00:27.796868 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m17:00:27.803416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m17:00:27.805407 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:27.805765 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m17:00:27.806903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3adb3d90>]}
[0m17:00:27.807791 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.21s]
[0m17:00:27.808900 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m17:00:27.809451 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m17:00:27.810518 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:00:27.812139 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.812603 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m17:00:27.813071 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m17:00:27.818594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.819228 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:27.819576 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m17:00:27.866302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.867124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.867467 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m17:00:27.867731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:27.884562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:00:27.885069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.885361 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:00:27.890817 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m17:00:27.896549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.896937 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:00:27.899470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:27.904447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.904858 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:00:27.907666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:27.919685 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m17:00:27.920217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.920601 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m17:00:27.925029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:27.929061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:00:27.929387 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:00:27.974570 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m17:00:27.976606 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:27.976982 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m17:00:27.978103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3bef3580>]}
[0m17:00:27.978895 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.17s]
[0m17:00:27.979658 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m17:00:27.980120 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.max_speed
[0m17:00:27.980994 [info ] [Thread-1 (]: 3 of 4 START sql view model public.max_speed ................................... [RUN]
[0m17:00:27.982232 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.max_speed"
[0m17:00:27.982562 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.max_speed
[0m17:00:27.982960 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.max_speed
[0m17:00:27.988313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.max_speed"
[0m17:00:27.988955 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:27.989311 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.max_speed
[0m17:00:27.996964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.max_speed"
[0m17:00:27.997623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m17:00:27.997907 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: BEGIN
[0m17:00:27.998182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:28.016587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:00:28.017085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m17:00:28.017391 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */

  create view "test"."public"."max_speed__dbt_tmp" as (
    with source_data as (
    select *
    from "test"."public"."My_model"
),
final as (
    select vehicle_type,
        COUNT(*)
    from source_data
    group by vehicle_type
)
SELECT *
FROM final
  );
[0m17:00:28.026507 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:00:28.031876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m17:00:28.032286 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */
alter table "test"."public"."max_speed__dbt_tmp" rename to "max_speed"
[0m17:00:28.035031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:28.038925 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: COMMIT
[0m17:00:28.039531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m17:00:28.039850 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: COMMIT
[0m17:00:28.044851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:28.051236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.max_speed"
[0m17:00:28.051630 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.max_speed"} */
drop view if exists "test"."public"."max_speed__dbt_backup" cascade
[0m17:00:28.094877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m17:00:28.097651 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:28.098120 [debug] [Thread-1 (]: On model.dbt_traffic_data.max_speed: Close
[0m17:00:28.099564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f38c81150>]}
[0m17:00:28.100321 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.max_speed .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:00:28.101254 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.max_speed
[0m17:00:28.101792 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m17:00:28.102734 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:00:28.104242 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.104795 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m17:00:28.105285 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m17:00:28.113831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.114847 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:28.115408 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m17:00:28.128872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.130048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.130626 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m17:00:28.131105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:28.148408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:00:28.148907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.149221 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:00:28.153606 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:00:28.159750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.160211 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:00:28.163174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:28.166818 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m17:00:28.167176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.167466 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m17:00:28.172477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:28.176828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:00:28.177220 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:00:28.180393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:00:28.182516 [debug] [Thread-1 (]: finished collecting timing info
[0m17:00:28.182905 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m17:00:28.184033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9583394a-4024-42ad-bfaa-e0d5166505b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f38c71720>]}
[0m17:00:28.184780 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:00:28.185576 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m17:00:28.188013 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:00:28.188763 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:28.189277 [debug] [MainThread]: On master: BEGIN
[0m17:00:28.189735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:28.204074 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:00:28.204730 [debug] [MainThread]: On master: COMMIT
[0m17:00:28.205204 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:28.205648 [debug] [MainThread]: On master: COMMIT
[0m17:00:28.207758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:00:28.208329 [debug] [MainThread]: On master: Close
[0m17:00:28.209919 [info ] [MainThread]: 
[0m17:00:28.210800 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m17:00:28.211504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:28.211889 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m17:00:28.224617 [info ] [MainThread]: 
[0m17:00:28.225311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:28.225883 [info ] [MainThread]: 
[0m17:00:28.226358 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:00:28.226953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3bec2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3bf20340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3ad84130>]}
[0m17:00:28.227405 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 17:01:37.486022 | a5470bd7-9305-4d37-a307-3cc98b34755f ==============================
[0m17:01:37.486045 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:01:37.486791 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/tibarek/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:01:37.487080 [debug] [MainThread]: Tracking: tracking
[0m17:01:37.489235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a389db670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a389db7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a389dbdf0>]}
[0m17:01:37.584025 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:01:37.584735 [debug] [MainThread]: Partial parsing: added file: dbt_traffic_data://models/traffic_data/vehicle_type.sql
[0m17:01:37.585041 [debug] [MainThread]: Partial parsing: deleted file: dbt_traffic_data://models/traffic_data/max_speed.sql
[0m17:01:37.653845 [debug] [MainThread]: 1699: static parser successfully parsed traffic_data/vehicle_type.sql
[0m17:01:37.710742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a37fec490>]}
[0m17:01:37.722809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a37f62860>]}
[0m17:01:37.723406 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m17:01:37.723934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a37f4fd60>]}
[0m17:01:37.726362 [info ] [MainThread]: 
[0m17:01:37.727683 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:01:37.729768 [debug] [ThreadPool]: Acquiring new postgres connection "list_test"
[0m17:01:37.753133 [debug] [ThreadPool]: Using postgres connection "list_test"
[0m17:01:37.753701 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test"} */

    select distinct nspname from pg_namespace
  
[0m17:01:37.754145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:37.777610 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m17:01:37.780134 [debug] [ThreadPool]: On list_test: Close
[0m17:01:37.783780 [debug] [ThreadPool]: Acquiring new postgres connection "list_test_public"
[0m17:01:37.798829 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m17:01:37.799312 [debug] [ThreadPool]: On list_test_public: BEGIN
[0m17:01:37.799618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:37.858758 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m17:01:37.859330 [debug] [ThreadPool]: Using postgres connection "list_test_public"
[0m17:01:37.859652 [debug] [ThreadPool]: On list_test_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "list_test_public"} */
select
      'test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:01:37.866442 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m17:01:37.868835 [debug] [ThreadPool]: On list_test_public: ROLLBACK
[0m17:01:37.870645 [debug] [ThreadPool]: On list_test_public: Close
[0m17:01:37.884305 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:37.884929 [debug] [MainThread]: On master: BEGIN
[0m17:01:37.885382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:37.898689 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:01:37.899369 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:37.899869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:01:37.926094 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
[0m17:01:37.929937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a36e17c10>]}
[0m17:01:37.930850 [debug] [MainThread]: On master: ROLLBACK
[0m17:01:37.933656 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:37.934273 [debug] [MainThread]: On master: BEGIN
[0m17:01:37.938329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:01:37.938922 [debug] [MainThread]: On master: COMMIT
[0m17:01:37.939397 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:37.939828 [debug] [MainThread]: On master: COMMIT
[0m17:01:37.941513 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:01:37.941896 [debug] [MainThread]: On master: Close
[0m17:01:37.942956 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m17:01:37.943538 [info ] [MainThread]: 
[0m17:01:37.949165 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.My_model
[0m17:01:37.949825 [info ] [Thread-1 (]: 1 of 4 START sql view model public.My_model .................................... [RUN]
[0m17:01:37.951104 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:37.951466 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.My_model
[0m17:01:37.951755 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.My_model
[0m17:01:37.957186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.My_model"
[0m17:01:37.958214 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:37.958756 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.My_model
[0m17:01:38.039389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.My_model"
[0m17:01:38.040205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:38.040561 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: BEGIN
[0m17:01:38.040834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:38.057169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:01:38.057657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:38.057951 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */

  create view "test"."public"."My_model__dbt_tmp" as (
    with source_data_cast as (
    select *
    from "test"."public"."traffic_data"
),
final as (
    select id,
        track_id,
        type as vehicle_type,
        traveled_d,
        avg_speed,
        lat,
        lon,
        speed,
        lon_acc,
        lat_acc,
        time as vtime
    from source_data_cast
)
SELECT *
FROM final
  );
[0m17:01:38.065465 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:01:38.077518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:38.077946 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model" rename to "My_model__dbt_backup"
[0m17:01:38.081645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:01:38.086510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:38.086835 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
alter table "test"."public"."My_model__dbt_tmp" rename to "My_model"
[0m17:01:38.090011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:01:38.125588 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m17:01:38.126015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:38.126301 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: COMMIT
[0m17:01:38.135962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:01:38.147187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.My_model"
[0m17:01:38.147585 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.My_model"} */
drop view if exists "test"."public"."My_model__dbt_backup" cascade
[0m17:01:38.194719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m17:01:38.196860 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.197258 [debug] [Thread-1 (]: On model.dbt_traffic_data.My_model: Close
[0m17:01:38.198391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a36e4ffd0>]}
[0m17:01:38.199049 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.My_model ............................... [[32mCREATE VIEW[0m in 0.25s]
[0m17:01:38.199818 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.My_model
[0m17:01:38.200167 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_first_dbt_model
[0m17:01:38.200943 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:01:38.202061 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.202585 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_first_dbt_model
[0m17:01:38.203037 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_first_dbt_model
[0m17:01:38.211161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.212122 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.212654 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_first_dbt_model
[0m17:01:38.267593 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.268386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.268705 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: BEGIN
[0m17:01:38.268949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:38.285232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:01:38.285724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.286029 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */

  
    

  create  table "test"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:01:38.291572 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m17:01:38.296947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.297358 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:01:38.299945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:01:38.308022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.308633 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
alter table "test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:01:38.311627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:01:38.330619 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m17:01:38.331205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.331659 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: COMMIT
[0m17:01:38.337158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:01:38.343517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_first_dbt_model"
[0m17:01:38.344059 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_first_dbt_model"} */
drop table if exists "test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:01:38.390777 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m17:01:38.394302 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.394946 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_first_dbt_model: Close
[0m17:01:38.396542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a37f0c580>]}
[0m17:01:38.397554 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m17:01:38.398887 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_first_dbt_model
[0m17:01:38.399489 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.vehicle_type
[0m17:01:38.400374 [info ] [Thread-1 (]: 3 of 4 START sql view model public.vehicle_type ................................ [RUN]
[0m17:01:38.402433 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.403025 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.vehicle_type
[0m17:01:38.403518 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.vehicle_type
[0m17:01:38.411830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.412790 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.413360 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.vehicle_type
[0m17:01:38.427812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.428986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.429552 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: BEGIN
[0m17:01:38.430013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:38.446029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:01:38.446575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.446866 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.vehicle_type"} */

  create view "test"."public"."vehicle_type__dbt_tmp" as (
    with source_data as (
    select *
    from "test"."public"."My_model"
),
final as (
    select vehicle_type,
        COUNT(*)
    from source_data
    group by vehicle_type
)
SELECT *
FROM final
  );
[0m17:01:38.452917 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:01:38.459767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.460189 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.vehicle_type"} */
alter table "test"."public"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m17:01:38.463040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:01:38.466361 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: COMMIT
[0m17:01:38.466716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.466984 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: COMMIT
[0m17:01:38.474402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:01:38.480849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.vehicle_type"
[0m17:01:38.481240 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.vehicle_type"} */
drop view if exists "test"."public"."vehicle_type__dbt_backup" cascade
[0m17:01:38.526869 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.05 seconds
[0m17:01:38.529010 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.529398 [debug] [Thread-1 (]: On model.dbt_traffic_data.vehicle_type: Close
[0m17:01:38.530457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a34d21240>]}
[0m17:01:38.531117 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.vehicle_type ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m17:01:38.531922 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.vehicle_type
[0m17:01:38.532375 [debug] [Thread-1 (]: Began running node model.dbt_traffic_data.my_second_dbt_model
[0m17:01:38.532984 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:01:38.534252 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.534604 [debug] [Thread-1 (]: Began compiling node model.dbt_traffic_data.my_second_dbt_model
[0m17:01:38.534920 [debug] [Thread-1 (]: Compiling model.dbt_traffic_data.my_second_dbt_model
[0m17:01:38.540455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.541149 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.541503 [debug] [Thread-1 (]: Began executing node model.dbt_traffic_data.my_second_dbt_model
[0m17:01:38.549909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.550826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.551158 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: BEGIN
[0m17:01:38.551418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:38.571589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:01:38.572227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.572731 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */

  create view "test"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:01:38.577823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:01:38.583021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.583404 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
alter table "test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:01:38.585946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:01:38.590166 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m17:01:38.590721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.591021 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: COMMIT
[0m17:01:38.596725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:01:38.601669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_traffic_data.my_second_dbt_model"
[0m17:01:38.602115 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "dbt_traffic_data", "target_name": "public", "node_id": "model.dbt_traffic_data.my_second_dbt_model"} */
drop view if exists "test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:01:38.646890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.04 seconds
[0m17:01:38.650469 [debug] [Thread-1 (]: finished collecting timing info
[0m17:01:38.651118 [debug] [Thread-1 (]: On model.dbt_traffic_data.my_second_dbt_model: Close
[0m17:01:38.652781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5470bd7-9305-4d37-a307-3cc98b34755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a34d09720>]}
[0m17:01:38.653840 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m17:01:38.655205 [debug] [Thread-1 (]: Finished running node model.dbt_traffic_data.my_second_dbt_model
[0m17:01:38.657903 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:01:38.658538 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:38.659029 [debug] [MainThread]: On master: BEGIN
[0m17:01:38.659505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:38.726749 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m17:01:38.727350 [debug] [MainThread]: On master: COMMIT
[0m17:01:38.727653 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:38.727930 [debug] [MainThread]: On master: COMMIT
[0m17:01:38.730502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:01:38.730958 [debug] [MainThread]: On master: Close
[0m17:01:38.732073 [info ] [MainThread]: 
[0m17:01:38.732676 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m17:01:38.733194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:38.733455 [debug] [MainThread]: Connection 'model.dbt_traffic_data.my_second_dbt_model' was properly closed.
[0m17:01:38.752134 [info ] [MainThread]: 
[0m17:01:38.753186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:38.754186 [info ] [MainThread]: 
[0m17:01:38.754970 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:01:38.755983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a37f624a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a38034e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a36e24400>]}
[0m17:01:38.756756 [debug] [MainThread]: Flushing usage events
